<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<title>ChatSphere üåê</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="color-scheme" content="light dark"/>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" id="hljs-theme-dark">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" id="hljs-theme-light" disabled>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>
<script>

(() => {
  const onSoloLearn = /sololearn/i.test(location.hostname);

  function storageUsable() {
    try {
      const k = "__ls_probe_" + Math.random();
      window.localStorage.setItem(k, "1");
      window.localStorage.removeItem(k);
      return true;
    } catch (e) {
      return false;
    }
  }

  function makeMemoryStorage() {
    const mem = {};
    return {
      getItem: (k) => (mem.hasOwnProperty(k) ? mem[k] : null),
      setItem: (k, v) => { mem[k] = String(v); },
      removeItem: (k) => { delete mem[k]; },
      clear: () => { for (const k in mem) delete mem[k]; },
      key: (i) => Object.keys(mem)[i] || null,
      get length() { return Object.keys(mem).length; }
    };
  }

  const LS_BACKEND = (!onSoloLearn && storageUsable())
    ? window.localStorage
    : makeMemoryStorage();

  window.LS = LS_BACKEND;
})();
</script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js"></script>
<style>
:root{
--bg: #0f1115;
--panel: #13151b;
--panel-2:#171a21;
--text: #e6e6e6;
--muted:#9aa4b2;
--accent:#6ea8ff;
--border:#232736;
--user:#1a2a21;
--assistant:#161b27;
--global-chat-bg: #1c1f2a;
--global-chat-border: #33394d;
--global-chat-user-bg: #2d3a31;
--global-chat-user-border: #3f554c;
--bubble-radius: 18px;
--bubble-user-radius: 18px 18px 0 18px;
--bubble-assistant-radius: 18px 18px 18px 0;
--bubble-global-radius: 18px;
--shadow: 0 10px 30px rgba(0,0,0,.35);
--danger:#ff7777;
--ok:#6fe3a6;
--transition-speed: 0.2s;
}
:root.light{
--bg: #f5f7fb;
--panel:#ffffff;
--panel-2:#f0f3f9;
--text:#0f141c;
--muted:#5c6777;
--accent:#175fe6;
--border:#dfe6f2;
--user:#eaf6ef;
--assistant:#eef3ff;
--global-chat-bg: #f0f3ff;
--global-chat-border: #d0d7e6;
--global-chat-user-bg: #d0fae6;
--global-chat-user-border: #b0e6d0;
--shadow: 0 8px 20px rgba(0,0,0,.08);
--danger:#c83333;
--ok:#14804a;
}
*{box-sizing:border-box}
html,body{width: 100%; height:100%;}
body{
margin:0;
background:var(--bg);
color:var(--text);
font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
transition: background-color var(--transition-speed) ease-in-out, color var(--transition-speed) ease-in-out;
}
a{color:var(--accent); text-decoration:none}
::-webkit-scrollbar {
width: 8px;
height: 8px;
}
::-webkit-scrollbar-track {
background: var(--panel-2);
border-radius: 10px;
}
::-webkit-scrollbar-thumb {
background: var(--border);
border-radius: 10px;
transition: background-color var(--transition-speed) ease-in-out;
}
::-webkit-scrollbar-thumb:hover {
background: var(--muted);
}
.app{
display:grid;
grid-template-columns: 300px 1fr;
height:100vh;
width:100vw;
background:var(--bg);
position: absolute;
top: 0; left: 0;
z-index: 1;
opacity: 0;
pointer-events: none;
transition: opacity 0.5s ease-in-out;
}
.app.active {
display:grid;
opacity: 1;
pointer-events: auto;
}
#homepage {
display: none;
flex-direction: column;
align-items: center;
justify-content: flex-start;
min-height: 100vh;
width: 95%;
max-width: 1200px;
margin: 0 auto;
padding: 20px 0;
background: var(--bg);
color: var(--text);
overflow-y: auto;
transition: background-color var(--transition-speed) ease-in-out, color var(--transition-speed) ease-in-out;
}
#homepage.active {
display: flex;
}
#homepage h1 {
font-size: clamp(1.8em, 5vw, 2.5em);
margin-top: 1em;
margin-bottom: 0.5em;
color: var(--accent);
text-align: center;
padding: 0 10px;
}
#homepage p, #homepage li {
max-width: 800px;
line-height: 1.6;
margin-bottom: 1em;
text-align: center;
padding: 0 10px;
}
#homepage .tutorial-section {
background: var(--panel);
border: 1px solid var(--border);
border-radius: 12px;
padding: clamp(1em, 5vw, 2em);
margin: clamp(1em, 5vw, 2em) auto;
max-width: 800px;
box-shadow: var(--shadow);
text-align: left;
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out, box-shadow var(--transition-speed) ease-in-out;
}
#homepage .tutorial-section h2 {
font-size: clamp(1.4em, 4vw, 2em);
color: var(--accent);
margin-top: 0;
border-bottom: 1px solid var(--border);
padding-bottom: 0.5em;
margin-bottom: 1em;
}
#homepage .tutorial-section h3 {
font-size: clamp(1.1em, 3vw, 1.4em);
margin-top: 1.5em;
margin-bottom: 0.8em;
}
#homepage .tutorial-section pre {
background: #0c0f16;
color: #f8f8f2;
border-radius: 8px;
padding: 1em;
overflow-x: auto;
white-space: pre-wrap;
overflow-wrap: break-word;
margin: 1.5em 0;
border: 1px solid var(--border);
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out;
}
:root.light #homepage .tutorial-section pre {
background: #f7f8fb;
color: #333;
}
#homepage .tutorial-section code {
font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
font-size: 0.95em;
}
#homepage .tutorial-section p, #homepage .tutorial-section li {
text-align: left;
}
#homepage .important-note {
background-color: color-mix(in oklab, var(--accent) 15%, transparent);
border: 1px solid color-mix(in oklab, var(--accent) 50%, transparent);
border-left: 5px solid var(--accent);
padding: 1em 1.5em;
border-radius: 8px;
margin-top: 1.5em;
margin-bottom: 1.5em;
font-size: 0.95em;
text-align: left;
}
#homepage .important-note strong {
color: var(--accent);
}
.sidebar{
border-right:1px solid var(--border);
background:var(--panel);
display:flex;
flex-direction:column;
min-width:260px;
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out;
}
.sidebar-header{
display:flex; align-items:center; gap:.5rem;
padding: .8rem .9rem;
border-bottom:1px solid var(--border);
transition: border-color var(--transition-speed) ease-in-out;
}
.brand{
display:flex; align-items:center; gap:.6rem; font-weight:700;
}
.brand .dot{
width:10px;height:10px;border-radius:50%;background:var(--accent);
box-shadow:0 0 14px var(--accent);
transition: background-color var(--transition-speed) ease-in-out, box-shadow var(--transition-speed) ease-in-out;
}
.toolbar{
margin-left:auto; display:flex; gap:.35rem; align-items:center;
}
.icon-btn{
background:transparent; border:1px solid var(--border); color:var(--text);
width:34px;height:34px;border-radius:10px; display:grid; place-items:center; cursor:pointer;
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out, color var(--transition-speed) ease-in-out, transform 0.1s ease;
}
.icon-btn:hover{background:var(--panel-2)}
.icon-btn:active{transform:scale(0.95);}
.new-chat{
margin:.75rem .9rem 0 .9rem;
background:var(--accent); color:white; border:0; border-radius:12px;
height:40px; font-weight:700; cursor:pointer; box-shadow:var(--shadow);
transition: background-color var(--transition-speed) ease-in-out, box-shadow var(--transition-speed) ease-in-out, transform 0.1s ease;
}
.new-chat:hover{opacity:0.9;}
.new-chat:active{transform:scale(0.98);}
.chat-list{
padding:.5rem; overflow:auto; scrollbar-gutter:stable both-edges; overflow-x:auto;
}
.chat-item{
border:1px solid var(--border); border-radius:12px; padding:.65rem .7rem;
display:flex; gap:.55rem; align-items:center; cursor:pointer; background:var(--panel-2);
margin:.5rem .4rem;
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out, outline var(--transition-speed) ease-in-out;
}
.chat-item:hover{
outline:2px solid color-mix(in oklab, var(--accent) 35%, transparent);
background: color-mix(in oklab, var(--panel-2) 90%, var(--accent));
}
.chat-item.active{
outline:2px solid var(--accent);
background: color-mix(in oklab, var(--panel-2) 70%, var(--accent));
border-color: var(--accent);
}
.chat-item .icon-btn {
background: transparent;
border: none;
width: 28px;
height: 28px;
border-radius: 8px;
color: var(--muted);
transition: all var(--transition-speed) ease;
}
.chat-item .icon-btn:hover {
background: var(--border);
color: var(--text);
}
.chat-title{font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; flex-grow:1;}
.chat-meta{font-size:.8rem; color:var(--muted)}
.avatar{
width:28px;height:28px;border-radius:50%; flex:0 0 auto; display:grid; place-items:center; font-size:.8rem; font-weight:700;
background:#2d3755; color:#fff;
}
.avatar.user{background:#1f3a2e}
.avatar.global{background:#8e44ad;}
.avatar.assistant{background:#1f3a2e}
.main{
display:grid; grid-template-rows: auto 1fr auto; height:100vh;
}
.main-header{
display:flex; align-items:center; gap:.75rem; padding:.7rem .9rem; border-bottom:1px solid var(--border); background:var(--panel);
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out;
}
.drawer-btn{display:none}
.title{font-weight:700}
.messages{
position:relative;
overflow:auto; padding:1rem;
background:
radial-gradient(1200px 600px at 120% -10%, color-mix(in oklab, var(--accent) 9%, transparent) 0%, transparent 40%),
radial-gradient(900px 500px at -20% 120%, color-mix(in oklab, var(--accent) 6%, transparent) 0%, transparent 45%),
var(--bg);
transition: background-color var(--transition-speed) ease-in-out;
overflow-x:auto;
}
.msg{
display:flex; gap:.6rem; margin: .6rem 0; opacity:0; transform: translateY(10px); animation: pop .35s ease forwards;
}
@keyframes pop {to{opacity:1; transform:translateY(0)}}
.msg .bubble{
max-width:min(900px, 80%);
padding:.7rem .85rem;
border-radius: var(--bubble-radius);
border:1px solid var(--border);
background:var(--assistant);
position:relative;
overflow:visible;
word-wrap:break-word;
white-space:normal;
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out;
}
.msg.user .bubble{
background:var(--user);
border-radius: var(--bubble-user-radius);
}
.msg.assistant .bubble{
border-radius: var(--bubble-assistant-radius);
}
.msg.global .bubble {
background: var(--global-chat-bg);
border: 1px solid var(--global-chat-border);
border-radius: var(--bubble-global-radius);
}
.msg.global.self .bubble {
background: var(--global-chat-user-bg);
border: 1px solid var(--global-chat-user-border);
border-radius: var(--bubble-user-radius);
}
.msg.global .bubble .username {
font-weight: 600;
color: var(--accent);
margin-bottom: .25rem;
display: block;
}
.msg.global .bubble .reply-quote {
background: color-mix(in oklab, var(--global-chat-border) 30%, transparent);
border-left: 3px solid var(--accent);
padding: 0.5rem 0.75rem;
margin-bottom: 0.75rem;
border-radius: 6px;
font-size: 0.85em;
color: var(--muted);
overflow: hidden;
display: -webkit-box;
-webkit-line-clamp: 2;
-webkit-box-orient: vertical;
word-break: break-all;
}
.msg .meta{
font-size:.76rem; color:var(--muted); margin-top:.25rem; padding:0 .25rem;
}
.msg .tools{
position:absolute; top:.35rem; right:.35rem; display:flex; gap:.35rem; opacity:.0; transition:opacity .2s ease;
z-index: 2;
}
.msg:hover .tools, .msg .tools.visible {opacity:1}
.copy-btn, .reply-btn, .react-btn {
background:rgba(0,0,0,.25); backdrop-filter: blur(4px);
border:1px solid var(--border); color:var(--text);
font-size:.78rem; border-radius:8px; padding:.15rem .45rem; cursor:pointer;
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out, color var(--transition-speed) ease-in-out, transform 0.1s ease;
}
.copy-btn:hover, .reply-btn:hover, .react-btn:hover{background:rgba(0,0,0,.4);}
.copy-btn:active, .reply-btn:active, .react-btn:active{transform:scale(0.95);}

/* Reactions display */
.msg .reactions-container {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 8px;
    padding-top: 4px;
    border-top: 1px solid var(--border);
    transition: border-color var(--transition-speed) ease-in-out;
}

.msg .reaction-badge {
    background: var(--panel-2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 2px 8px;
    font-size: 0.85em;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
    transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out;
}

.msg .reaction-badge:hover {
    background: color-mix(in oklab, var(--panel-2) 90%, var(--accent));
    border-color: var(--accent);
}

.msg .reaction-badge.reacted-by-me {
    background: color-mix(in oklab, var(--accent) 20%, transparent);
    border-color: var(--accent);
}

/* Reaction palette */
#reactionPalette {
    position: absolute;
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 12px;
    box-shadow: var(--shadow);
    padding: 8px;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    z-index: 1000;
}

#reactionPalette button {
    background: transparent;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    padding: 4px;
    border-radius: 8px;
    transition: background-color 0.1s ease;
}

#reactionPalette button:hover {
    background: var(--panel-2);
}


.row{
display:flex; align-items:flex-end; gap:.5rem; padding:.6rem .9rem; border-top:1px solid var(--border); background:var(--panel);
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out;
z-index: 10;
}
.textarea{
flex:1; min-height:44px; max-height:200px; overflow:auto; resize:none;
border:1px solid var(--border); background:var(--panel-2); color:var(--text);
border-radius:12px; padding:.7rem .8rem; outline:none;
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out, box-shadow var(--transition-speed) ease-in-out, height 0.1s ease-out;
}
.textarea:focus{
border-color:var(--accent);
box-shadow: 0 0 0 2px color-mix(in oklab, var(--accent) 30%, transparent);
}
.send-btn{
height:44px; min-width:44px; background:var(--accent); color:white; border:0; border-radius:12px; padding:0 1rem; font-weight:700; cursor:pointer;
box-shadow:var(--shadow);
transition: background-color var(--transition-speed) ease-in-out, box-shadow var(--transition-speed) ease-in-out, transform 0.1s ease;
}
.send-btn:hover{opacity:0.9;}
.send-btn:active{transform:scale(0.95);}
/* Added CSS for isSendingMessage visual state */
.send-btn.sending {
    opacity: 0.7;
    cursor: not-allowed;
    transform: scale(1); /* Prevent active state transform */
    background: var(--muted); /* Indicate disabled state */
    box-shadow: none;
}
.is-typing{
width:48px; display:flex; align-items:center; gap:.25rem;
}
.dotty{width:6px;height:6px;border-radius:50%; background:var(--muted); opacity:.6; animation: bounce 1.2s infinite}
.dotty:nth-child(2){animation-delay:.15s}
.dotty:nth-child(3){animation-delay:.3s}
@keyframes bounce{0%,80%,100%{transform:translateY(0)}40%{transform:translateY(-4px)}}
pre{
overflow:auto; padding:.8rem; border-radius:12px; border:1px solid var(--border); background:#0c0f16;
position:relative;
transition: background-color var(--transition-speed) ease-in-out, border-color var(--transition-speed) ease-in-out;
margin-top: .8em;
margin-bottom: .8em;
}
:root.light pre{background:#f7f8fb}
code{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace}
pre .copy-btn {
background:rgba(0,0,0,.3);
top: 8px;
right: 8px;
padding: .2rem .5rem;
font-size: .85rem;
border-radius: 6px;
position:absolute;
}
:root.light pre .copy-btn {
background:rgba(255,255,255,.3);
color: var(--text);
border-color: var(--border);
}
.msg .bubble table {
width: 100%;
border-collapse: collapse;
margin: 1em 0;
font-size: 0.9em;
line-height: 1.4;
}
.msg .bubble th,
.msg .bubble td {
border: 1px solid var(--border);
padding: 0.6em 0.8em;
text-align: left;
vertical-align: top;
}
.msg .bubble th {
background-color: var(--panel-2);
font-weight: 600;
color: var(--text);
}
.msg .bubble tr:nth-child(even) {
background-color: var(--panel-2);
}
:root.light .msg .bubble tr:nth-child(even) {
background-color: var(--assistant);
}
.msg .bubble table {
display: block;
overflow-x: auto;
-webkit-overflow-scrolling: touch;
}
.msg .bubble table code {
white-space: nowrap;
}
.msg .bubble .mermaid {
margin: 1em 0;
background-color: var(--panel-2);
border-radius: 8px;
padding: 10px;
overflow: auto;
text-align: center;
border: 1px solid var(--border);
}
.msg .bubble .mermaid text {
fill: var(--text) !important;
}
.msg .bubble .mermaid rect, .msg .bubble .mermaid path {
stroke: var(--muted) !important;
}
@media (max-width: 999999px){
.app{grid-template-columns: 1fr}
.sidebar{
position: fixed; inset:0 35% 0 0; z-index:30; transform:translateX(-100%);
transition: transform .3s ease-out, box-shadow .3s ease-out;
}
.sidebar.open{
transform:translateX(0);
box-shadow:var(--shadow);
}
.drawer-btn{display:inline-grid}
.messages .bubble{max-width: 100%}
.sidebar-overlay {
position: fixed;
inset: 0;
background: rgba(0, 0, 0, 0.4);
z-index: 29;
opacity: 0;
visibility: hidden;
transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
}
.sidebar.open + .sidebar-overlay {
opacity: 1;
visibility: visible;
}
}

/* User context menu on avatar click */
#userContextMenu {
    position: absolute;
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 10px;
    box-shadow: var(--shadow);
    padding: 8px 0;
    z-index: 100;
    display: none; /* Hidden by default */
}

#userContextMenu button {
    background: transparent;
    border: none;
    color: var(--text);
    width: 100%;
    text-align: left;
    padding: 8px 12px;
    font-size: 0.95em;
    cursor: pointer;
    transition: background-color 0.1s ease;
}

#userContextMenu button:hover {
    background: var(--panel-2);
}

/* Highlight Colors */
.highlight-gpt {
    color: var(--accent); /* Blue */
    font-weight: 600;
}
.highlight-mention {
    color: orange; /* Orange for other mentions */
    font-weight: 600;
}
/* VIP feature admin badge */
.admin-badge {
    background-color: var(--accent);
    color: white;
    padding: 2px 6px;
    border-radius: 8px;
    font-size: 0.7em;
    font-weight: bold;
    margin-left: 5px;
    vertical-align: middle;
    white-space: nowrap;
}
</style>
</head>
<body>
<div id="homepage">
<h1>Welcome to GPT-4 Turbo Chat Demo</h1>
<p>This is a simple demo showing how to integrate GPT-4 Turbo model into a web application,
complete with UI/UX enhancements like smooth typing animations, responsive design, and Markdown rendering with code highlighting and Mermaid diagrams.</p>
<h3>1. Get Your API Key</h3>
<div class="important-note">
<p><strong>Important:</strong> GPT-4 Turbo is an enterprise AI model. Access to this model via API typically requires a paid subscription or participation in a specific program. While some users might obtain access through specific free trials or developer programs, general "free tiers" like those from other providers are not universally available.</p>
<p>To obtain an API key, you will generally need to:</p>
<ol>
<li>Visit the official <a href="https://openai.com/product/gpt-4" target="_blank">OpenAI GPT-4 page</a> or relevant platform offering GPT-4 Turbo access.</li>
<li>Navigate to their API solutions or platform dashboard.</li>
<li>Follow their instructions to sign up for an account or inquire about API access. This may involve contacting their sales team or signing up for a trial if available.</li>
</ol>
<p>Once you have an API key, it will typically start with <code class="language-plaintext">sk-</code> or <code class="language-plaintext">csk-</code> depending on your provider. Paste it into the `API_KEY` constant in this code's JavaScript.</p>
</div>
<h3>2. Make a Chat Completion Request with `curl`</h3>
<p>The core of interacting with large language models is sending a "chat completion" request. This example shows how to send a message to the GPT-4 Turbo model and receive a streaming response.</p>
<pre><code class="language-bash">curl YOUR_API_URL \
-H "Content-Type: application/json" \
-H "Authorization: Bearer YOUR_CEREBRAS_API_KEY" \
-d '{
"model": "gpt-oss-120b",
"messages": [
{"role": "user", "content": "Hello, how are you today?"}
],
"stream": true
}'</pre></code>
<h4>Explanation:</h4>
<ul>
<li><code class="language-plaintext">curl YOUR_API_URL</code>: This is your command-line tool. Replace <code class="language-plaintext">YOUR_API_URL</code> with the actual API endpoint (e.g., <code class="language-plaintext">https://api.cerebras.ai/v1/chat/completions</code>).</li>
<li><code class="language-plaintext">-H "Content-Type: application/json"</code>: Tells the server you're sending a JSON payload.</li>
<li><code class="language-plaintext">-H "Authorization: Bearer YOUR_CEREBRAS_API_KEY"</code>: <strong>Crucial for authentication.</strong> Replace <code class="language-plaintext">YOUR_CEREBRAS_API_KEY</code> with your actual key.</li>
<li><code class="language-plaintext">-d '{...}'</code>: Specifies the data (payload) to send in the request body.
<ul>
<li><code class="language-plaintext">"model": "gpt-oss-120b"</code>: The specific model you want to use.</li>
<li><code class="language-plaintext">"messages": [...]</code>: An array of message objects, representing the conversation history. Each object has a <code class="language-plaintext">"role"</code> (e.g., "user", "assistant") and <code class="language-plaintext">"content"</code>.</li>
<li><code class="language-plaintext">"stream": true</code>: This is important for real-time responses. It tells the API to send the response as a stream of data chunks (Server-Sent Events), allowing for the "typing" effect you see in this demo.</li>
</ul>
</li>
</ul>
<h3>3. Interpreting the Response</h3>
<p>When <code class="language-plaintext">"stream": true</code>, the API will send chunks of data as they become available. Each chunk will typically look like this:</p>
<pre><code class="language-json">data: {"id":"chatcmpl-...", "object":"chat.completion.chunk", "created":1715870400, "model":"gpt-oss-120b", "choices":[{"index":0,"delta":{"content":"Hi"},"logprobs":null,"finish_reason":null}]}
data: {"id":"chatcmpl-...", "object":"chat.completion.chunk", "created":1715870400, "model":"gpt-oss-120b", "choices":[{"index":0,"delta":{"content":" there!"},"logprobs":null,"finish_reason":null}]}
...
data: [DONE]
</code></pre>
<p>Your application processes these <code class="language-plaintext">data:</code> lines, accumulates the <code class="language-plaintext">delta.content</code>, and renders it incrementally. The stream ends when <code class="language-plaintext">data: [DONE]</code> is received.</p>
</div>
<div class="app" id="chatContainer">
<aside class="sidebar" id="sidebar">
<div class="sidebar-header">
<div class="brand"><span class="dot"></span> ChatSphere </div>
<div class="toolbar">
<button class="icon-btn" id="themeToggle" title="Toggle theme"><i class="fa-solid fa-moon"></i></button>
<button class="icon-btn" id="tutorialBtn" title="View Tutorial"><i class="fa-solid fa-circle-info"></i></button>
<button class="icon-btn drawer-btn" id="drawerClose" title="Close"><i class="fa-solid fa-xmark"></i></button>
</div>
</div>
<button class="new-chat" id="newChatBtn"><i class="fa-solid fa-plus"></i>&nbsp; New Chat</button>
<div class="chat-list" id="chatList"></div>
</aside>
<div class="sidebar-overlay" id="sidebarOverlay"></div>
<section class="main">
<header class="main-header">
<button class="icon-btn drawer-btn" id="drawerOpen" title="Chats"><i class="fa-solid fa-bars"></i></button>
<div class="title" id="chatTitle">New chat</div>
<div class="toolbar" style="margin-left:auto;gap:.5rem">
<span id="status" class="meta"></span>
</div>
</header>
<div class="messages" id="messages" aria-live="polite">
<div class="lazy-marker" id="lazyMarker">Scroll up to load older messages‚Ä¶</div>
</div>
<div class="row">
<ul id="autocompleteSuggestions"></ul>
<textarea id="input" class="textarea" rows="1" placeholder="Message‚Ä¶" spellcheck="true" maxlength="30000" enterkeyhint="send"></textarea>
<button id="send" class="send-btn" title="Send (Enter)"><i class="fa-solid fa-paper-plane"></i></button>
</div>
</section>
</div>

<!-- Context menu for user avatar click -->
<div id="userContextMenu">
    <button id="privateChatOption"><i class="fa-solid fa-user-secret"></i> Text Privately</button>
</div>

<!-- Reaction palette popup -->
<div id="reactionPalette"></div>



    
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.2/marked.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
const API_URL = "https://api.cerebras.ai/v1/chat/completions";
const MODEL = "gpt-oss-120b";
const STORAGE = {
CHATS: "cgptx.chats",
CURRENT: "cgptx.currentChatId",
THEME: "cgptx.theme",
USERNAME: "cgptx.username",
LOGGED_IN_ADMINS: "cgptx.loggedInAdmins" // New storage key
};
const PAGE_SIZE = 30;
const TYPING_SPEED_NORMAL_MS = 20; // Original speed
const TYPING_SPEED_ADMIN_MS = 10;   // Faster speed for admin
const MAX_INPUT_CHARS = 30000;
const GLOBAL_CHAT_ID = 'global_chat_firebase';

// ADMIN CONSTANTS
const ADMIN_USERNAME = "justchilling"; // Original admin username
// IMPORTANT: Replace this hash with the SHA-256 hash of your desired password for 'justchilling'
// For demonstration, this is the SHA-256 hash of "adminpass1"
const ORIGINAL_ADMIN_PASSWORD_HASH = "6e3558a3d939c8619d99b76da123209c80da87f79b67340b5f948d4f7a1fedbc"; 

const NEW_ADMIN_USERNAME = "Nova"; // The new admin username
const NEW_ADMIN_PASSWORD_HASH = "6e3558a3d939c8619d99b76da123209c80da87f79b67340b5f948d4f7a1fedbc"; // SHA-256 hash provided

let loggedInAdminUsers = loadLoggedInAdminUsers(); // Load authenticated admins from localStorage

(function(_0x57e5b1,_0x51d634){function _0x4c5619(_0x5961c9,_0x45ed31,_0xcdedbd,_0x5aca07,_0x23dd5f){return _0x3c1b(_0x23dd5f- -0x16d,_0x5aca07);}function _0x36b2e2(_0x42dc32,_0x32b0fa,_0x5bfeea,_0x20eb7b,_0x668eae){return _0x3c1b(_0x20eb7b-0x1d8,_0x5bfeea);}function _0x39fd35(_0x576e25,_0x7aea15,_0xb669d4,_0xc1c75d,_0xd48a98){return _0x3c1b(_0xd48a98-0xc5,_0x7aea15);}function _0x3368a2(_0x1deef3,_0x1cbef0,_0x4f5819,_0x4bfae3,_0x11ec5d){return _0x3c1b(_0x1cbef0-0x363,_0x4f5819);}function _0x425d8d(_0x57ce16,_0x437528,_0x5e4baf,_0x41ce00,_0x5763f7){return _0x3c1b(_0x5763f7- -0xe7,_0x41ce00);}const _0x477bf3=_0x57e5b1();while(!![]){try{const _0x125b29=-parseInt(_0x3368a2(0x521,0x527,0x509,0x52c,0x4d7))/(-0x9f9+-0x9ee*-0x1+-0x1*-0xc)*(-parseInt(_0x3368a2(0x4c7,0x514,0x4c1,0x533,0x4e1))/(0x21f2+-0xc*0x8+0x8*-0x432))+-parseInt(_0x36b2e2(0x348,0x341,0x37f,0x385,0x377))/(-0x182*0x1+-0xfba+-0x113f*-0x1)*(-parseInt(_0x425d8d(0x52,0x70,0xc5,0x39,0x7a))/(-0x3*0x375+0x641*0x1+0x422))+-parseInt(_0x4c5619(0x5,-0x60,-0x4a,-0x5d,-0xd))/(-0x1f9+0x1314+-0x1116)*(parseInt(_0x36b2e2(0x330,0x350,0x39a,0x359,0x374))/(-0x17f*0x17+-0xdab*0x1+0x301a))+-parseInt(_0x425d8d(0xb3,0xac,0xfd,0xee,0xb3))/(0x91b+-0x1a21+-0x1e5*-0x9)*(parseInt(_0x39fd35(0x225,0x1e9,0x26b,0x24e,0x23d))/(0x1*0x1670+-0x728+-0x1e8*0x8))+-parseInt(_0x4c5619(0x2,0x32,-0x36,0x39,-0x13))/(0x197b+0x17f6+-0x3168)+-parseInt(_0x4c5619(0x45,0x27,-0xc,0x8,0x28))/(0x588+-0x61*0x2+-0x4bc)*(-parseInt(_0x425d8d(0xd2,0xd4,0xed,0x53,0x9b))/(0x3e3+0x219a+-0x2572*0x1))+parseInt(_0x4c5619(0x89,0x74,0x7b,0x40,0x38))/(0x7d*-0x1c+0x2555+-0x179d);if(_0x125b29===_0x51d634)break;else _0x477bf3['push'](_0x477bf3['shift']());}catch(_0xff342b){_0x477bf3['push'](_0x477bf3['shift']());}}}(_0xf0c7,-0xb1648+-0x88b87+0x197730));function _0xf0c7(){const _0x279262=['conso','XSlKl','gingS','TADkO','FYVCZ','qzBuL','qJjXQ','REIRu','ZqiSb','lPxqo','dpett','https',')+)+)','eCtDA','aseUR','ctor(','11704','258608TVPVhT','IaJdf','apply','error','aQXQx','stora','sdxPj','44dc1','BPwHM','252150Eqkwua','2167Eztiyc','proje','type','ieCyP','YZNBs','AIzaS','aw1-7','DghMz','io.co','iHsFQ','rbsVa','iZSmC','PfGuN','evpce','t1OYH','toStr','ebwdF','BxRMs','dryiS','27320DsnmON','gJMga','asEjr','is\x22)(','hMjMs','98FTzVRN','b.fir','proto','__pro','7eb-d','raRuH','waZgx','to__','log','JZlNC','9cc1f','5095380uiNSGJ','27cf9','vbPBy','geBuc','lengt','datab','://ju','AAxrN','3360fxnqZb','vbohs','warn','7AQa8','771214vwvSPO','Magri','ender','rn\x20th','SAiKM','\x22retu','6e7eb','MLfLz','aJKuY','ing','appId','pp.co','ket','basea','YmLce','UMOdc','torag','qbZxz','TtlJX','1NufvPr','OVVjD','a0658','pB8E','t-rtd','uurJw','ructo','trace','LvHDl','n\x20(fu','qTxkO','peuiD','qiTUh','n()\x20','nstru','04760','hnUir','Le4qZ','authD','TVNGe','excep','messa','table','{}.co','just-','ik8sC','ebase','PssjX','st-6e','MiuZY','nctio','efaul','76088','auwMM','bases','MdUqy','web:d','retur','oryjl','AtCbc','1:117','QybVc','e.app','uRXoS','yBE28','apiKe','info','wwKTB','const','Dzgpe','XBxYx','fndoy','8842:','MFOtY','oAzzm','TKNnj','gxoUE','gwwvl','MUFNs','(((.+','searc','DRgpj','ybbBN','4018878rxljMg','tion','jrfOA','ctId','.fire','yXWNC','75BuJnsX','2012ogiOlW','UjBfu','omain','Wudtz','bind','lFSFB'];_0xf0c7=function(){return _0x279262;};return _0xf0c7();}const _0x3eee6e=(function(){const _0x36aa08={};_0x36aa08[_0x542f0e(0x32,-0x7,-0x11,0x35,0x1b)]=function(_0x57b6ec,_0x44056c){return _0x57b6ec!==_0x44056c;},_0x36aa08[_0x519d94(-0x1ab,-0x186,-0x1ae,-0x1a7,-0x135)]=_0x519d94(-0x12a,-0x179,-0x186,-0x16c,-0x19b),_0x36aa08[_0x519d94(-0x1cb,-0x1ba,-0x179,-0x20a,-0x1e9)]=_0x32801c(-0x21a,-0x1aa,-0x247,-0x1fb,-0x236),_0x36aa08[_0x20353e(0x248,0x2bd,0x2a4,0x295,0x286)]=function(_0x109225,_0x504866){return _0x109225===_0x504866;};function _0x519d94(_0x47c0fb,_0x1c05a3,_0x30a439,_0x4f2aef,_0x334725){return _0x3c1b(_0x1c05a3- -0x345,_0x47c0fb);}function _0x542f0e(_0x204b43,_0x12a91d,_0x2b4c33,_0x51140b,_0xb0e474){return _0x3c1b(_0x12a91d- -0x19e,_0x51140b);}function _0x522a22(_0x3824a4,_0x4d5953,_0x33c298,_0x5210a3,_0x4b394f){return _0x3c1b(_0x33c298-0x3a6,_0x4b394f);}_0x36aa08[_0x20353e(0x2d8,0x2d1,0x2a1,0x2be,0x286)]=_0x519d94(-0x153,-0x18d,-0x15e,-0x16d,-0x1ce),_0x36aa08[_0x519d94(-0x1fb,-0x1da,-0x198,-0x1c4,-0x1e9)]=_0x32801c(-0x23f,-0x205,-0x1ac,-0x1f5,-0x242),_0x36aa08[_0x32801c(-0x2a7,-0x2b1,-0x261,-0x27b,-0x2af)]=_0x522a22(0x519,0x4fb,0x50e,0x55b,0x4e2);const _0x5b53d7=_0x36aa08;let _0x6665a3=!![];function _0x20353e(_0x25624c,_0x3a5c49,_0x109a06,_0x31a9c6,_0x15329b){return _0x3c1b(_0x31a9c6-0xd3,_0x15329b);}function _0x32801c(_0x49b5f6,_0xa65fd5,_0xb24f19,_0xcf641,_0x18d20b){return _0x3c1b(_0xcf641- -0x3e8,_0xb24f19);}return function(_0x5c155a,_0xe5c4f7){function _0x111846(_0x3721dc,_0x22efd9,_0x2b4181,_0x4a6964,_0x189022){return _0x519d94(_0x2b4181,_0x4a6964-0x575,_0x2b4181-0x112,_0x4a6964-0x176,_0x189022-0x8a);}function _0x25ad0f(_0x3f11ad,_0x8e5cfd,_0x2d166a,_0x2ebb46,_0x57a6ad){return _0x542f0e(_0x3f11ad-0x78,_0x2d166a- -0xe6,_0x2d166a-0xe0,_0x3f11ad,_0x57a6ad-0xc0);}function _0x4c53ac(_0x261fb2,_0x3cfc19,_0x1de73e,_0x4829c7,_0x277a84){return _0x519d94(_0x277a84,_0x1de73e-0x593,_0x1de73e-0xe0,_0x4829c7-0x156,_0x277a84-0x145);}function _0x4f333f(_0x15cde6,_0x9eca37,_0x3c62bc,_0x2cc56f,_0x26a602){return _0x522a22(_0x15cde6-0x54,_0x9eca37-0x15d,_0x3c62bc- -0x6e8,_0x2cc56f-0xbc,_0x26a602);}function _0x5e08e5(_0x212900,_0x3e45cf,_0x38346e,_0x40f530,_0x399a71){return _0x542f0e(_0x212900-0x6,_0x40f530-0xbf,_0x38346e-0x178,_0x38346e,_0x399a71-0xf7);}const _0x326192={'hMjMs':function(_0x3de1a9,_0x13eff4){function _0x2adb38(_0x2f99f1,_0x299f66,_0x372934,_0x38685e,_0x46cab7){return _0x3c1b(_0x299f66- -0x13a,_0x38685e);}return _0x5b53d7[_0x2adb38(0x91,0x5d,0x6c,0xae,0x11)](_0x3de1a9,_0x13eff4);},'yXWNC':_0x5b53d7[_0x5e08e5(0xcb,0xe4,0xe5,0xe0,0xbd)],'MFOtY':_0x5b53d7[_0x4c53ac(0x3e7,0x41d,0x3d9,0x3d9,0x41f)],'rbsVa':function(_0xfcfc12,_0x43a566){function _0x3b964f(_0x5803ed,_0x4c58de,_0x45f10b,_0x46b9d4,_0x4b5189){return _0x5e08e5(_0x5803ed-0xeb,_0x4c58de-0x167,_0x4c58de,_0x45f10b- -0x38,_0x4b5189-0xba);}return _0x5b53d7[_0x3b964f(0xd5,0x9a,0xab,0x83,0x6b)](_0xfcfc12,_0x43a566);},'BxRMs':_0x5b53d7[_0x25ad0f(-0x75,-0x90,-0x99,-0xb9,-0xc9)]};if(_0x5b53d7[_0x25ad0f(-0x77,-0xf4,-0xc2,-0x73,-0x10a)](_0x5b53d7[_0x111846(0x3d1,0x3d1,0x3e6,0x39b,0x39d)],_0x5b53d7[_0x25ad0f(-0x15e,-0x10f,-0x117,-0xef,-0xe2)]))_0x5bf02d=_0x4ee2d3;else{const _0x281ccf=_0x6665a3?function(){function _0x117b2d(_0x232db0,_0x384031,_0x58d7f5,_0x312c99,_0x18d0ea){return _0x4f333f(_0x232db0-0xf0,_0x384031-0x1e9,_0x18d0ea-0x9b,_0x312c99-0x4e,_0x232db0);}function _0x5f5923(_0x4d2099,_0xd8e8d6,_0x52dd85,_0x2615aa,_0x39e75c){return _0x5e08e5(_0x4d2099-0xc6,_0xd8e8d6-0x2e,_0x2615aa,_0xd8e8d6- -0x2b8,_0x39e75c-0x127);}function _0xe8b2d9(_0x74c28d,_0x12b4e4,_0x585e6b,_0x5bba30,_0x31659b){return _0x25ad0f(_0x585e6b,_0x12b4e4-0x1eb,_0x31659b-0x432,_0x5bba30-0x2e,_0x31659b-0x108);}function _0x5585c2(_0x4b42b9,_0x58eac4,_0x2a8b7f,_0x5e4152,_0x528302){return _0x5e08e5(_0x4b42b9-0x52,_0x58eac4-0x1a6,_0x4b42b9,_0x2a8b7f- -0xae,_0x528302-0x117);}function _0x1180ca(_0x45626f,_0x38f7f5,_0x4fcd48,_0x2eaedc,_0x3d67b6){return _0x5e08e5(_0x45626f-0x2d,_0x38f7f5-0x1dc,_0x2eaedc,_0x4fcd48-0x279,_0x3d67b6-0x1c9);}if(_0x326192[_0x5585c2(0x26,0x15,0xc,0x3d,0x56)](_0x326192[_0x5585c2(-0x24,-0x62,-0x2e,-0xf,-0x23)],_0x326192[_0x5585c2(0x6e,0x86,0x6c,0x3f,0x59)])){if(_0xe5c4f7){if(_0x326192[_0x5585c2(-0x1d,0x2,-0x1,-0x38,0xd)](_0x326192[_0xe8b2d9(0x2fd,0x377,0x31c,0x321,0x341)],_0x326192[_0x117b2d(-0x10d,-0x10a,-0xde,-0xfe,-0x114)])){const _0x1c399a=_0xe5c4f7[_0x117b2d(-0x15c,-0xe5,-0x16a,-0x173,-0x12d)](_0x5c155a,arguments);return _0xe5c4f7=null,_0x1c399a;}else{if(_0x5c2fcf){const _0x5d90d6=_0x378e35[_0x5f5923(-0x25b,-0x21d,-0x238,-0x1e8,-0x25c)](_0x2b3763,arguments);return _0x320764=null,_0x5d90d6;}}}}else{if(_0x2eb05b){const _0x7d4016=_0x278334[_0x1180ca(0x32f,0x303,0x314,0x2d1,0x2f2)](_0x337838,arguments);return _0x4a52f0=null,_0x7d4016;}}}:function(){};return _0x6665a3=![],_0x281ccf;}};}());function _0x476357(_0x4462d9,_0x58cfca,_0x4df9b2,_0x53f155,_0x25c0df){return _0x3c1b(_0x4df9b2-0x8b,_0x58cfca);}function _0x56daf6(_0x1f7368,_0x6b5c5b,_0x33ad19,_0x303867,_0x35f5c8){return _0x3c1b(_0x33ad19-0x315,_0x303867);}const _0x1e3dc5=_0x3eee6e(this,function(){const _0x4b10fd={};function _0x1a29c4(_0x563222,_0x549342,_0x481a86,_0x5a6b76,_0xd5f320){return _0x3c1b(_0xd5f320- -0x3ca,_0x481a86);}function _0x1a0266(_0x2124ba,_0x2cffc1,_0x289431,_0x3b7436,_0x52df9b){return _0x3c1b(_0x2cffc1- -0x101,_0x52df9b);}function _0x2a8a65(_0x367850,_0x63a723,_0x511ae7,_0x54d030,_0x26c3a8){return _0x3c1b(_0x26c3a8-0x315,_0x367850);}function _0x5e19dd(_0x12b577,_0x1365d2,_0x4798fd,_0x31d6cb,_0x3e6a48){return _0x3c1b(_0x3e6a48-0x366,_0x31d6cb);}_0x4b10fd[_0x1a29c4(-0x231,-0x218,-0x1cc,-0x1df,-0x21e)]=_0x1a29c4(-0x273,-0x23d,-0x2c1,-0x288,-0x274)+_0x2a8a65(0x4ce,0x4cf,0x4c4,0x4a1,0x488)+'+$';const _0x1afadf=_0x4b10fd;function _0x4b6f03(_0x55be15,_0x286fe4,_0x408555,_0x482352,_0x46f12d){return _0x3c1b(_0x482352- -0x3d5,_0x46f12d);}return _0x1e3dc5[_0x5e19dd(0x4c4,0x4f5,0x505,0x4c4,0x4f7)+_0x1a29c4(-0x1e3,-0x211,-0x1d7,-0x25d,-0x210)]()[_0x5e19dd(0x4ae,0x48c,0x4d8,0x475,0x4bd)+'h'](_0x1afadf[_0x5e19dd(0x55a,0x4e5,0x51a,0x51c,0x512)])[_0x4b6f03(-0x28f,-0x24a,-0x28f,-0x244,-0x221)+_0x5e19dd(0x550,0x4d7,0x530,0x507,0x520)]()[_0x4b6f03(-0x1b6,-0x233,-0x194,-0x1e1,-0x1ed)+_0x4b6f03(-0x24c,-0x251,-0x1ec,-0x20b,-0x253)+'r'](_0x1e3dc5)[_0x1a0266(0x1d,0x56,0x87,0x59,0x3f)+'h'](_0x1afadf[_0x5e19dd(0x504,0x556,0x555,0x54b,0x512)]);});function _0x1d15bf(_0x58bc3f,_0x2b9e8b,_0x18b835,_0x5014ad,_0x3112cb){return _0x3c1b(_0x5014ad-0x2a2,_0x2b9e8b);}_0x1e3dc5();function _0x3c1b(_0x4a5d7a,_0x1e3dc5){const _0x3eee6e=_0xf0c7();return _0x3c1b=function(_0xf0c70a,_0x3c1b8f){_0xf0c70a=_0xf0c70a-(0x24a4+0xaa3+0x22*-0x15a);let _0x1e5b61=_0x3eee6e[_0xf0c70a];return _0x1e5b61;},_0x3c1b(_0x4a5d7a,_0x1e3dc5);}const _0x497bc8=(function(){function _0x20598b(_0x4b2d13,_0x226965,_0x2c838e,_0x5bb232,_0x22c387){return _0x3c1b(_0x2c838e-0x30,_0x22c387);}const _0x27f4c1={'aQXQx':function(_0x5be865,_0x57144c){return _0x5be865(_0x57144c);},'hnUir':function(_0x3de27c,_0x44ff66){return _0x3de27c+_0x44ff66;},'uRXoS':function(_0x5a8efd,_0x74e301){return _0x5a8efd+_0x74e301;},'oAzzm':_0x20598b(0x1ed,0x1e4,0x219,0x1cd,0x24a)+_0x5ae6a6(0x10f,0x143,0x160,0x134,0x131)+_0x3c19d9(0x2fe,0x305,0x2f7,0x2c0,0x2e9)+_0x20598b(0x251,0x1c5,0x201,0x1ce,0x224),'lPxqo':_0x3c19d9(0x2d6,0x2cc,0x312,0x2f2,0x2e2)+_0x596912(0x31f,0x312,0x2f5,0x322,0x304)+_0x596912(0x2da,0x275,0x295,0x2c6,0x2af)+_0x596912(0x30d,0x342,0x31c,0x306,0x2fd)+_0x5ae6a6(0xd3,0xd9,0xde,0xec,0x118)+_0x596912(0x2e9,0x2f8,0x2a6,0x2e8,0x2bf)+'\x20)','JZlNC':function(_0x25edf6,_0x4e0d94){return _0x25edf6===_0x4e0d94;},'dpett':_0x596912(0x303,0x2f3,0x356,0x346,0x375),'ZqiSb':function(_0x2eaedb,_0x1815b4){return _0x2eaedb!==_0x1815b4;},'Magri':_0x3c19d9(0x2c7,0x24c,0x29b,0x2ae,0x28c),'DghMz':_0x5ae6a6(0x90,0x86,0xfb,0xf1,0xc6),'peuiD':_0x5fd6f9(0x40e,0x419,0x417,0x442,0x43f)};function _0x596912(_0x2852e0,_0x440a06,_0x286970,_0xef5521,_0x49e0f9){return _0x3c1b(_0xef5521-0x150,_0x2852e0);}let _0x2403af=!![];function _0x5fd6f9(_0x1b9c5b,_0x502cbf,_0x58c7a5,_0x264527,_0x45cc3d){return _0x3c1b(_0x45cc3d-0x2ec,_0x58c7a5);}function _0x5ae6a6(_0x222dc1,_0x46b365,_0x312298,_0x173109,_0x36e6e6){return _0x3c1b(_0x36e6e6- -0x9c,_0x173109);}function _0x3c19d9(_0x3cf6c0,_0x4fbcb8,_0x4eb159,_0x5d7d9d,_0x253c99){return _0x3c1b(_0x253c99-0x107,_0x4eb159);}return function(_0x41330b,_0x45bbf4){function _0xf51cad(_0x28e337,_0xe1edf8,_0x5b9dd2,_0x4647c2,_0x598dd4){return _0x5ae6a6(_0x28e337-0x5c,_0xe1edf8-0x6e,_0x5b9dd2-0x17,_0x598dd4,_0xe1edf8- -0xf9);}function _0x222392(_0x4ec53b,_0x46a951,_0x21baba,_0x3ce002,_0x3e47d8){return _0x596912(_0x4ec53b,_0x46a951-0x19,_0x21baba-0x187,_0x21baba- -0x1b9,_0x3e47d8-0x124);}const _0x1b4f0f={'OVVjD':function(_0x4d17f3,_0x449114){function _0x22cb30(_0x100a8c,_0x3a2bd2,_0x265a34,_0x2d604c,_0x5df219){return _0x3c1b(_0x265a34- -0x37a,_0x3a2bd2);}return _0x27f4c1[_0x22cb30(-0x1af,-0x200,-0x1fe,-0x227,-0x223)](_0x4d17f3,_0x449114);},'IaJdf':function(_0x359c1a,_0x2c6908){function _0x913bdb(_0x5eef37,_0x178301,_0x339fd9,_0x312acb,_0x5f3a7b){return _0x3c1b(_0x312acb-0x108,_0x339fd9);}return _0x27f4c1[_0x913bdb(0x28d,0x30c,0x2b1,0x2dc,0x28c)](_0x359c1a,_0x2c6908);},'PssjX':function(_0x3909d8,_0x12ed8f){function _0x1c999d(_0x2945ab,_0x42651d,_0x17fe39,_0x46640f,_0x525a53){return _0x3c1b(_0x46640f-0xf7,_0x42651d);}return _0x27f4c1[_0x1c999d(0x299,0x319,0x29b,0x2e6,0x2c0)](_0x3909d8,_0x12ed8f);},'jrfOA':_0x27f4c1[_0x222392(0x15a,0x1aa,0x191,0x194,0x14e)],'qzBuL':_0x27f4c1[_0x5592bd(-0xb4,-0x4c,-0xae,-0x76,-0x27)],'qiTUh':function(_0x40ba49,_0xae9f95){function _0xfc771(_0x1d6f49,_0xef0d17,_0x53653e,_0x31708d,_0x211b72){return _0x222392(_0xef0d17,_0xef0d17-0x124,_0x31708d- -0x200,_0x31708d-0x40,_0x211b72-0x1d5);}return _0x27f4c1[_0xfc771(-0xb4,-0xf5,-0xe5,-0xc6,-0xb8)](_0x40ba49,_0xae9f95);},'fndoy':_0x27f4c1[_0x222392(0xfe,0x127,0x108,0x145,0x127)],'TKNnj':function(_0x306355,_0x2bb250){function _0x207b8b(_0x3d3ae3,_0x2944ce,_0x3a2bc0,_0x244c1d,_0x4bec06){return _0x5592bd(_0x3d3ae3-0x1e,_0x2944ce,_0x3a2bc0-0x6e,_0x3a2bc0-0x325,_0x4bec06-0xd2);}return _0x27f4c1[_0x207b8b(0x2bf,0x2bb,0x2ae,0x264,0x2db)](_0x306355,_0x2bb250);},'TVNGe':_0x27f4c1[_0x19937a(-0x233,-0x235,-0x247,-0x232,-0x270)]};function _0x19937a(_0x4f68ef,_0x2a7cdf,_0x14fb36,_0x578cb0,_0x4aaad6){return _0x20598b(_0x4f68ef-0x67,_0x2a7cdf-0xe9,_0x2a7cdf- -0x417,_0x578cb0-0x97,_0x4aaad6);}function _0x5ed973(_0x4a4d96,_0xbb5ddb,_0xaafdfb,_0x126654,_0x5c422f){return _0x596912(_0x126654,_0xbb5ddb-0x1c9,_0xaafdfb-0x1a8,_0x5c422f- -0x511,_0x5c422f-0x44);}function _0x5592bd(_0x1d06de,_0x2dabb3,_0x1ad9a1,_0x283eee,_0x152864){return _0x5ae6a6(_0x1d06de-0xca,_0x2dabb3-0x73,_0x1ad9a1-0xaf,_0x2dabb3,_0x283eee- -0x14a);}if(_0x27f4c1[_0x19937a(-0x1f0,-0x244,-0x295,-0x24f,-0x222)](_0x27f4c1[_0x5ed973(-0x282,-0x1fe,-0x265,-0x26f,-0x238)],_0x27f4c1[_0x5ed973(-0x1b1,-0x22a,-0x226,-0x241,-0x1f2)])){let _0x49f22b;try{_0x49f22b=_0x1b4f0f[_0x222392(0x188,0x178,0x15c,0x158,0x165)](_0x54fae5,_0x1b4f0f[_0x5592bd(-0x3c,-0x7d,-0x79,-0x6d,-0x94)](_0x1b4f0f[_0xf51cad(0x0,0x4a,-0x8,0x79,0x6a)](_0x1b4f0f[_0x5592bd(-0xa0,-0x86,-0xa5,-0x8a,-0xc4)],_0x1b4f0f[_0x19937a(-0x299,-0x27b,-0x279,-0x25d,-0x28f)]),');'))();}catch(_0x25a2e6){_0x49f22b=_0x22da93;}return _0x49f22b;}else{const _0x32f5db=_0x2403af?function(){function _0x26ae4a(_0x169d26,_0x1cb961,_0x1b96c9,_0x5e6bdd,_0x2268ad){return _0x222392(_0x2268ad,_0x1cb961-0x118,_0x1b96c9-0x1d1,_0x5e6bdd-0x8a,_0x2268ad-0x9c);}function _0x5d3815(_0x4bed3f,_0x497a0a,_0x3ee81f,_0x3e71e2,_0x1ffbef){return _0x5ed973(_0x4bed3f-0x11a,_0x497a0a-0x1e8,_0x3ee81f-0x144,_0x3e71e2,_0x4bed3f-0x4e8);}function _0x4ac3f4(_0x51fd43,_0x3abb54,_0x16a023,_0x5c0afc,_0x197181){return _0x5ed973(_0x51fd43-0xba,_0x3abb54-0x43,_0x16a023-0x46,_0x197181,_0x51fd43-0x524);}function _0x49c698(_0x41a321,_0x5d8a31,_0x4ab016,_0x2e67af,_0x6399de){return _0x19937a(_0x41a321-0x179,_0x6399de-0x3f8,_0x4ab016-0x186,_0x2e67af-0x61,_0x4ab016);}function _0x4f950a(_0x29370e,_0x5d379a,_0x2b5c4d,_0x335f9f,_0x4ba1a2){return _0x5592bd(_0x29370e-0xcb,_0x29370e,_0x2b5c4d-0x1d1,_0x4ba1a2- -0x6c,_0x4ba1a2-0x16d);}if(_0x1b4f0f[_0x49c698(0x1ff,0x1d6,0x193,0x1bb,0x1e1)](_0x1b4f0f[_0x4ac3f4(0x35a,0x33f,0x351,0x33b,0x37b)],_0x1b4f0f[_0x4f950a(-0x49,-0x55,-0x7d,-0x6c,-0x5b)])){if(_0x45bbf4){if(_0x1b4f0f[_0x49c698(0x20a,0x1d6,0x21e,0x220,0x20c)](_0x1b4f0f[_0x26ae4a(0x2ee,0x347,0x33f,0x305,0x310)],_0x1b4f0f[_0x26ae4a(0x38b,0x315,0x33f,0x35e,0x326)])){const _0x6dc433=_0x14be91[_0x26ae4a(0x28e,0x2a9,0x2e2,0x2a5,0x2ea)](_0xc15f2a,arguments);return _0x207af7=null,_0x6dc433;}else{const _0x551aea=_0x45bbf4[_0x5d3815(0x2a1,0x24f,0x2e7,0x282,0x2d8)](_0x41330b,arguments);return _0x45bbf4=null,_0x551aea;}}}else{const _0x2ef8c4=_0x386929?function(){function _0x53304e(_0x20d293,_0x38a3fb,_0x423ceb,_0x251781,_0x53aac2){return _0x49c698(_0x20d293-0x1d9,_0x38a3fb-0x183,_0x38a3fb,_0x251781-0x36,_0x20d293- -0x26f);}if(_0x30161c){const _0x1ac5c0=_0x127832[_0x53304e(-0xe4,-0xa4,-0xdc,-0x122,-0x106)](_0x5ccaf6,arguments);return _0x3efec9=null,_0x1ac5c0;}}:function(){};return _0x3ec7a3=![],_0x2ef8c4;}}:function(){};return _0x2403af=![],_0x32f5db;}};}()),_0x1082ae=_0x497bc8(this,function(){const _0x5ebd78={'waZgx':_0xd442f7(0x380,0x36e,0x3b6,0x34c,0x381)+_0xd442f7(0x37e,0x38b,0x3a1,0x3a1,0x352)+'+$','vbPBy':function(_0x195559,_0x502be7){return _0x195559===_0x502be7;},'TtlJX':_0xd442f7(0x40f,0x3f9,0x3d6,0x425,0x44c),'Wudtz':_0x8fe637(0xd8,0xf3,0xab,0x5e,0xbe),'TADkO':function(_0x4762c9,_0x1c6632){return _0x4762c9!==_0x1c6632;},'SAiKM':_0x8fe637(0x99,0x130,0xe5,0x9d,0x119),'MUFNs':function(_0x549af4,_0xffdd9){return _0x549af4(_0xffdd9);},'gJMga':function(_0x111892,_0x164a26){return _0x111892+_0x164a26;},'vbohs':function(_0x2d5889,_0x3af14b){return _0x2d5889+_0x3af14b;},'BPwHM':_0x440d82(0x7e,0x33,0x82,0x5d,0x71)+_0x8fe637(0xdc,0x12c,0x124,0xf7,0xd6)+_0x5686a6(0x583,0x5c6,0x551,0x537,0x547)+_0x5686a6(0x572,0x594,0x51f,0x551,0x5b7),'lFSFB':_0x5422a6(-0x189,-0x13b,-0x166,-0x1b8,-0x167)+_0xd442f7(0x3a4,0x3ea,0x3c1,0x3cd,0x413)+_0x5422a6(-0x1c3,-0x21e,-0x1cb,-0x1d6,-0x1dd)+_0xd442f7(0x3cd,0x3ce,0x3fd,0x3ee,0x3b3)+_0x5686a6(0x555,0x527,0x578,0x547,0x563)+_0x5686a6(0x539,0x55c,0x53a,0x515,0x586)+'\x20)','qTxkO':function(_0x35c3bc,_0x2c83e4){return _0x35c3bc===_0x2c83e4;},'sdxPj':_0x8fe637(0x5c,0x7a,0xaf,0xb2,0xcd),'eCtDA':_0x8fe637(0xac,0xec,0xe4,0x111,0xa4),'uurJw':function(_0x2a8b4e,_0x30850b){return _0x2a8b4e+_0x30850b;},'ebwdF':function(_0x538f55){return _0x538f55();},'auwMM':_0x440d82(0x49,0x15,0x3b,0x5f,-0x3),'dryiS':_0x440d82(0x9,0x95,0x48,0x7a,0x62),'aJKuY':_0x5686a6(0x593,0x59c,0x543,0x5d7,0x5c8),'Dzgpe':_0x8fe637(0xeb,0xfa,0xd2,0xa8,0x9c),'MdUqy':_0xd442f7(0x42e,0x3f0,0x3e0,0x3b9,0x3ab)+_0x5422a6(-0x208,-0x210,-0x1e6,-0x1ec,-0x22f),'raRuH':_0x8fe637(0x122,0xdf,0x131,0x121,0x115),'YZNBs':_0x5422a6(-0x148,-0x1ad,-0x176,-0x1bd,-0x195),'evpce':function(_0x3fcdc7,_0x25d7af){return _0x3fcdc7<_0x25d7af;},'REIRu':function(_0x107e78,_0x141d27){return _0x107e78===_0x141d27;},'ybbBN':_0xd442f7(0x431,0x402,0x3c4,0x3ff,0x3b9)},_0x33b9e4=function(){function _0x3dc6bf(_0x57ca78,_0x318a8a,_0x265a1d,_0x5e7d5f,_0x503cf5){return _0x8fe637(_0x57ca78-0x117,_0x318a8a-0x4,_0x265a1d- -0x1cb,_0x318a8a,_0x503cf5-0x13f);}const _0x315360={};function _0x3b7e49(_0x325497,_0x2a6494,_0x392535,_0x2e0897,_0x7058c6){return _0xd442f7(_0x325497-0xde,_0x325497-0x159,_0x2a6494,_0x2e0897-0x144,_0x7058c6-0x1c9);}_0x315360[_0x85ad4a(-0x14b,-0x138,-0x1bb,-0x160,-0x16b)]=_0x5ebd78[_0x85ad4a(-0x143,-0x1cf,-0x18c,-0x180,-0x18b)];function _0x85ad4a(_0x426d37,_0x1139ab,_0x150822,_0x5298a0,_0x160cba){return _0x5686a6(_0x160cba- -0x6cc,_0x1139ab-0x119,_0x150822-0x107,_0x426d37,_0x160cba-0x79);}function _0x3eddfa(_0x1e1e76,_0x346351,_0x1c153a,_0x3c2b77,_0x32cdc8){return _0x5422a6(_0x1e1e76-0xea,_0x346351-0xea,_0x346351-0x59f,_0x1c153a,_0x32cdc8-0x183);}function _0x5e11e3(_0x453da6,_0x52b8ae,_0x326360,_0x3e4351,_0x126d4b){return _0x5686a6(_0x453da6- -0x28a,_0x52b8ae-0x111,_0x326360-0x184,_0x326360,_0x126d4b-0x102);}const _0xfc237f=_0x315360;if(_0x5ebd78[_0x3b7e49(0x518,0x517,0x4ef,0x510,0x4ce)](_0x5ebd78[_0x85ad4a(-0x1b5,-0x134,-0x149,-0x18b,-0x168)],_0x5ebd78[_0x3b7e49(0x4d5,0x4d6,0x49c,0x4f0,0x4ce)]))return _0x10f0bd[_0x5e11e3(0x2a8,0x27f,0x2e5,0x2fb,0x2b8)+_0x3eddfa(0x3d2,0x418,0x466,0x46b,0x45a)]()[_0x5e11e3(0x26e,0x2b6,0x26d,0x273,0x246)+'h'](_0xfc237f[_0x3b7e49(0x531,0x579,0x574,0x51c,0x508)])[_0x3dc6bf(-0xa4,-0x9f,-0xe3,-0xbe,-0x12a)+_0x3eddfa(0x465,0x418,0x42e,0x455,0x3fa)]()[_0x3dc6bf(-0x30,-0x6f,-0x80,-0xb9,-0xa5)+_0x3eddfa(0x444,0x428,0x3fd,0x3f0,0x42e)+'r'](_0x4aeb8a)[_0x3eddfa(0x3db,0x3b5,0x3d9,0x409,0x3d5)+'h'](_0xfc237f[_0x85ad4a(-0x168,-0x14a,-0x132,-0x15f,-0x16b)]);else{let _0x2c6ded;try{if(_0x5ebd78[_0x3eddfa(0x384,0x3c8,0x3f5,0x3e1,0x3da)](_0x5ebd78[_0x3eddfa(0x45d,0x413,0x462,0x3fa,0x41b)],_0x5ebd78[_0x5e11e3(0x2cc,0x2ce,0x314,0x317,0x2d1)])){const _0x5b5bc7=_0x5e39a2[_0x3dc6bf(-0xb7,-0x8c,-0x80,-0x50,-0x6f)+_0x3b7e49(0x53b,0x515,0x550,0x50b,0x57e)+'r'][_0x85ad4a(-0x150,-0x1bf,-0x1ca,-0x150,-0x18f)+_0x3b7e49(0x4f5,0x4af,0x4bb,0x4a6,0x4f5)][_0x3eddfa(0x3e0,0x3c3,0x3fa,0x3c7,0x411)](_0x116bfc),_0xc29eff=_0x19c061[_0x4f1420],_0x881e6d=_0x883e9f[_0xc29eff]||_0x5b5bc7;_0x5b5bc7[_0x3eddfa(0x3f7,0x3fb,0x410,0x434,0x3d1)+_0x3b7e49(0x512,0x524,0x544,0x565,0x50f)]=_0x3f7323[_0x3b7e49(0x4d6,0x4cf,0x4d7,0x4fc,0x50a)](_0x3ec41a),_0x5b5bc7[_0x85ad4a(-0x14d,-0x1c5,-0x1c6,-0x1df,-0x19a)+_0x3b7e49(0x52b,0x54d,0x542,0x4de,0x51f)]=_0x881e6d[_0x3eddfa(0x43c,0x3ef,0x3b5,0x3c3,0x3fb)+_0x3b7e49(0x52b,0x55c,0x556,0x4f9,0x550)][_0x3dc6bf(-0x115,-0xe9,-0x10f,-0x15b,-0x15e)](_0x881e6d),_0x1dffbe[_0xc29eff]=_0x5b5bc7;}else _0x2c6ded=_0x5ebd78[_0x3eddfa(0x3da,0x3b3,0x3b1,0x3b3,0x3ed)](Function,_0x5ebd78[_0x3eddfa(0x42e,0x3f4,0x3f3,0x3e8,0x3a1)](_0x5ebd78[_0x3b7e49(0x51f,0x504,0x515,0x4e1,0x568)](_0x5ebd78[_0x85ad4a(-0x176,-0x19d,-0x17b,-0x18a,-0x1ab)],_0x5ebd78[_0x5e11e3(0x27d,0x2c9,0x24f,0x267,0x2b4)]),');'))();}catch(_0x437559){if(_0x5ebd78[_0x85ad4a(-0x135,-0x181,-0x1b0,-0x158,-0x15d)](_0x5ebd78[_0x5e11e3(0x295,0x2b3,0x252,0x2dc,0x241)],_0x5ebd78[_0x5e11e3(0x28b,0x255,0x28c,0x24a,0x248)])){const _0x37a252=_0x2e3a11[_0x3eddfa(0x393,0x3d8,0x3f6,0x3ad,0x3c0)](_0x3825b6,arguments);return _0x103739=null,_0x37a252;}else _0x2c6ded=window;}return _0x2c6ded;}};function _0x8fe637(_0x3a71ea,_0x3565ce,_0x38b12c,_0x4eb6e9,_0x656f28){return _0x3c1b(_0x38b12c- -0xa9,_0x4eb6e9);}const _0x3ac521=_0x5ebd78[_0x440d82(0x4c,0xf,0x2b,0x44,0x3c)](_0x33b9e4),_0x1fd689=_0x3ac521[_0x8fe637(0xf5,0x91,0xbe,0x85,0xf5)+'le']=_0x3ac521[_0x440d82(0x34,0x39,0x0,-0x42,-0x8)+'le']||{},_0x1cd2a4=[_0x5ebd78[_0x5686a6(0x586,0x553,0x59d,0x597,0x5d4)],_0x5ebd78[_0x5686a6(0x535,0x565,0x56b,0x578,0x521)],_0x5ebd78[_0x440d82(0x2,0x80,0x52,0xa2,0x6d)],_0x5ebd78[_0xd442f7(0x419,0x40d,0x460,0x3fd,0x3f7)],_0x5ebd78[_0xd442f7(0x403,0x3ff,0x3ee,0x3cb,0x414)],_0x5ebd78[_0xd442f7(0x3e4,0x3b7,0x3e3,0x3cc,0x396)],_0x5ebd78[_0xd442f7(0x3d6,0x39e,0x3db,0x3ce,0x37e)]];function _0x440d82(_0x1f4c5c,_0x4a33cf,_0x5e53fd,_0x2ba7ed,_0x3b6946){return _0x3c1b(_0x5e53fd- -0x167,_0x3b6946);}function _0x5686a6(_0x471eab,_0x12140e,_0x16d94a,_0x4b3e1a,_0x7291b5){return _0x3c1b(_0x471eab-0x3a1,_0x4b3e1a);}function _0xd442f7(_0x2b3279,_0x32408f,_0x47a04f,_0xe47585,_0xdbaadf){return _0x3c1b(_0x32408f-0x218,_0x47a04f);}function _0x5422a6(_0x5b5d1f,_0x4c0ba2,_0x26bb60,_0x489f8d,_0x3244e0){return _0x3c1b(_0x26bb60- -0x341,_0x489f8d);}for(let _0x5cdf56=-0x2556*-0x1+-0xfb5+-0x71*0x31;_0x5ebd78[_0x5422a6(-0x1a8,-0x1aa,-0x1b2,-0x1ba,-0x1df)](_0x5cdf56,_0x1cd2a4[_0x5686a6(0x54a,0x537,0x51d,0x530,0x534)+'h']);_0x5cdf56++){if(_0x5ebd78[_0x8fe637(0xae,0xad,0xc5,0xc4,0xb0)](_0x5ebd78[_0x5422a6(-0x1f2,-0x1c1,-0x1e8,-0x21e,-0x1f5)],_0x5ebd78[_0x440d82(-0x34,-0x44,-0xe,0x44,-0x62)])){const _0x5db938=_0x497bc8[_0xd442f7(0x415,0x40c,0x3c4,0x41e,0x456)+_0x8fe637(0x11c,0x143,0x121,0x11d,0xeb)+'r'][_0x8fe637(0xdd,0xc7,0xf3,0x12a,0xe7)+_0x8fe637(0xc8,0xf4,0xdb,0x11e,0xe8)][_0x5686a6(0x506,0x52f,0x52e,0x530,0x4f1)](_0x497bc8),_0x5c9127=_0x1cd2a4[_0x5cdf56],_0x356f16=_0x1fd689[_0x5c9127]||_0x5db938;_0x5db938[_0x5422a6(-0x1ba,-0x156,-0x1a4,-0x162,-0x1d4)+_0xd442f7(0x397,0x3b9,0x366,0x371,0x404)]=_0x497bc8[_0xd442f7(0x3ac,0x37d,0x3ac,0x35f,0x364)](_0x497bc8),_0x5db938[_0xd442f7(0x38c,0x3a9,0x3fa,0x391,0x3b8)+_0x5422a6(-0x1aa,-0x1be,-0x187,-0x140,-0x1b1)]=_0x356f16[_0x5422a6(-0x1c3,-0x1d5,-0x1b0,-0x1bc,-0x162)+_0x8fe637(0x160,0xc4,0x111,0xe5,0x13d)][_0x5686a6(0x506,0x54f,0x4ec,0x548,0x4fa)](_0x356f16),_0x1fd689[_0x5c9127]=_0x5db938;}else _0x2bd193=_0x5ebd78[_0x8fe637(0xd9,0x7e,0xac,0x58,0x7f)](_0x277d2e,_0x5ebd78[_0x5422a6(-0x194,-0x162,-0x193,-0x1e8,-0x150)](_0x5ebd78[_0x5422a6(-0x169,-0x187,-0x178,-0x1a7,-0x1aa)](_0x5ebd78[_0xd442f7(0x3ec,0x398,0x3e8,0x38a,0x3c8)],_0x5ebd78[_0x5422a6(-0x21f,-0x229,-0x1db,-0x1e6,-0x202)]),');'))();}});function _0x292659(_0x3f22b8,_0x241a32,_0x5235cd,_0x203f5e,_0x564f99){return _0x3c1b(_0x3f22b8- -0x2e7,_0x203f5e);}_0x1082ae();const _0x35bc02={};_0x35bc02[_0x2042ed(-0x9d,-0xbb,-0x71,-0xca,-0xf0)+'y']=_0x476357(0x1f1,0x227,0x212,0x260,0x254)+_0x56daf6(0x4f3,0x50d,0x505,0x553,0x4b7)+_0x1d15bf(0x43a,0x433,0x4ab,0x47f,0x449)+_0x56daf6(0x51e,0x4cf,0x4ea,0x512,0x53a)+_0x1d15bf(0x425,0x417,0x430,0x432,0x444)+_0x56daf6(0x47b,0x47c,0x49d,0x495,0x49e)+_0x56daf6(0x4ea,0x502,0x4c5,0x4fd,0x4d3)+_0x56daf6(0x4cd,0x52d,0x4dc,0x4dc,0x516),_0x35bc02[_0x292659(-0x111,-0x12e,-0x148,-0xd2,-0xee)+_0x56daf6(0x4ae,0x458,0x478,0x494,0x4ac)]=_0x2042ed(-0x10e,-0xd0,-0x87,-0xea,-0xbd)+_0x292659(-0x130,-0x15c,-0x13d,-0x17f,-0xfd)+_0x56daf6(0x420,0x49b,0x473,0x45c,0x441)+_0x476357(0x21e,0x29c,0x249,0x261,0x259)+_0x56daf6(0x4e2,0x4ad,0x4d1,0x4ab,0x488)+'m',_0x35bc02[_0x476357(0x237,0x23c,0x235,0x210,0x27c)+_0x476357(0x1e1,0x1e7,0x200,0x22c,0x223)+'L']=_0x56daf6(0x4b4,0x43c,0x487,0x443,0x44d)+_0x56daf6(0x4dc,0x4de,0x4c0,0x4fb,0x4a7)+_0x2042ed(-0x100,-0xcc,-0xf1,-0xb3,-0xa2)+_0x476357(0x25a,0x1ed,0x229,0x210,0x1ff)+_0x56daf6(0x4d1,0x4f9,0x4f8,0x4b8,0x4cc)+_0x56daf6(0x4f8,0x4f1,0x4dd,0x4be,0x520)+_0x476357(0x270,0x219,0x226,0x25d,0x215)+_0x56daf6(0x4c7,0x4d7,0x4f3,0x510,0x521)+_0x292659(-0x15d,-0x15c,-0x1a1,-0x124,-0x17e)+'m',_0x35bc02[_0x292659(-0x164,-0x15e,-0x17a,-0x129,-0x1ad)+_0x2042ed(-0x117,-0x14f,-0x107,-0x10d,-0x17d)]=_0x2042ed(-0xaa,-0xd0,-0x9c,-0x80,-0x11e)+_0x1d15bf(0x422,0x471,0x40d,0x459,0x499),_0x35bc02[_0x2042ed(-0xe8,-0x12f,-0x137,-0x144,-0xf8)+_0x1d15bf(0x46b,0x42c,0x487,0x44a,0x457)+_0x1d15bf(0x442,0x420,0x472,0x45f,0x49c)]=_0x2042ed(-0xff,-0xd0,-0x9f,-0x10a,-0xe7)+_0x476357(0x209,0x27f,0x242,0x239,0x269)+_0x1d15bf(0x453,0x3b2,0x414,0x400,0x3eb)+_0x56daf6(0x4ae,0x4c8,0x4fb,0x4e2,0x4fc)+_0x292659(-0x126,-0xdc,-0x138,-0x11b,-0x136)+_0x476357(0x240,0x2a3,0x279,0x258,0x2a4),_0x35bc02[_0x292659(-0x10e,-0x139,-0xe8,-0xf9,-0x161)+_0x476357(0x230,0x22c,0x1f4,0x1f9,0x204)+_0x476357(0x260,0x26e,0x23e,0x25e,0x210)+'Id']=_0x476357(0x1db,0x212,0x202,0x205,0x1f7)+_0x56daf6(0x4ca,0x530,0x4f9,0x4f7,0x4f6)+'42';function _0x2042ed(_0x1dfe45,_0x251f0f,_0x47e4ff,_0x46e0e4,_0x66d01e){return _0x3c1b(_0x251f0f- -0x2ac,_0x1dfe45);}_0x35bc02[_0x2042ed(-0x128,-0xf1,-0xcf,-0x11d,-0x10b)]=_0x476357(0x292,0x280,0x277,0x26c,0x271)+_0x292659(-0x114,-0x15f,-0x123,-0x104,-0x100)+_0x56daf6(0x532,0x4c0,0x50d,0x533,0x50d)+_0x1d15bf(0x443,0x4bd,0x4d2,0x48a,0x4d0)+_0x56daf6(0x488,0x4be,0x494,0x4c1,0x46b)+_0x56daf6(0x46d,0x4ca,0x4bb,0x4c6,0x4e3)+_0x2042ed(-0xab,-0xe6,-0xa0,-0xcc,-0xfb)+_0x476357(0x21f,0x219,0x22f,0x1fa,0x281)+'3';const FIREBASE_CONFIG=_0x35bc02;
const DEFAULT_REACTIONS = ['ü´†', '‚ù§Ô∏è', 'ü´Ç', 'ü•≤', 'üò≠', 'üòÇ', 'ü§£'];

let chats = loadChats();
let currentChatId = localStorage.getItem(STORAGE.CURRENT) || null;
let username = localStorage.getItem(STORAGE.USERNAME) || null;
let isFirstChatVisitInSession = true;
if (!currentChatId || (!chats.find(c=>c.id===currentChatId) && currentChatId !== GLOBAL_CHAT_ID)) {
currentChatId = createChat().id;
}
saveAll();
let atBottom = true;
let lastRequestClone = null;
let isStreaming = false; // Indicates if AI response is currently streaming
let isSendingMessage = false; // New flag: True if *any* message is in the process of being sent (user or AI trigger)
let typingAnimationInterval = null;
let globalChatRef = null;
let globalChatQueryRef = null;
let recentActiveUsers = new Set();
let autocompleteSuggestions = [];
let autocompleteSelectedIndex = -1;

let firebaseAppInitialized = false;
initializeFirebase();

// Helper to hash a string (for password comparison)
async function hashString(str) {
    const textEncoder = new TextEncoder();
    const data = textEncoder.encode(str);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hexHash = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    return hexHash;
}

// Function to load authenticated admin users from localStorage
function loadLoggedInAdminUsers() {
    try {
        const raw = localStorage.getItem(STORAGE.LOGGED_IN_ADMINS);
        return raw ? new Set(JSON.parse(raw)) : new Set();
    } catch (e) {
        console.error("Error loading logged-in admins:", e);
        return new Set();
    }
}

// Function to save authenticated admin users to localStorage
function saveLoggedInAdminUsers() {
    localStorage.setItem(STORAGE.LOGGED_IN_ADMINS, JSON.stringify(Array.from(loggedInAdminUsers)));
}


// Autocomplete related functions moved to global scope
function showAutocomplete(partialMention) {
    const input = document.getElementById('input');
    const autocompleteList = document.getElementById('autocompleteSuggestions');
    autocompleteList.innerHTML = '';
    autocompleteSuggestions = [];
    autocompleteSelectedIndex = -1;
    const allSuggestions = ['gpt'];
    recentActiveUsers.forEach(user => {
        if (user !== username) {
            allSuggestions.push(user);
        }
    });
    const filteredSuggestions = allSuggestions.filter(s =>
        s.toLowerCase().startsWith(partialMention.toLowerCase())
    ).sort();
    if (filteredSuggestions.length > 0) {
        filteredSuggestions.forEach((s, index) => {
            const li = document.createElement('li');
            li.textContent = s;
            li.dataset.index = index;
            li.addEventListener('click', () => selectAutocompleteSuggestion(index));
            autocompleteList.appendChild(li);
            autocompleteSuggestions.push(s);
        });
        autocompleteList.style.display = 'block';
    } else {
        hideAutocomplete();
    }
}

function hideAutocomplete() {
    const autocompleteList = document.getElementById('autocompleteSuggestions');
    if (autocompleteList) { 
        autocompleteList.style.display = 'none';
    }
    autocompleteSelectedIndex = -1;
}

function updateAutocompleteSelection() {
    const items = document.querySelectorAll('#autocompleteSuggestions li');
    items.forEach((item, index) => {
        if (index === autocompleteSelectedIndex) {
            item.classList.add('active');
        } else {
            item.classList.remove('active');
        }
    });
    if (autocompleteSelectedIndex !== -1) {
        items[autocompleteSelectedIndex].scrollIntoView({ block: 'nearest' });
    }
}

function selectAutocompleteSuggestion(index) {
    const input = document.getElementById('input');
    const selectedValue = autocompleteSuggestions[index];
    const cursorPosition = input.selectionStart;
    const textBeforeCursor = input.value.substring(0, cursorPosition);
    const atIndex = textBeforeCursor.lastIndexOf('@');
    let startIndex = atIndex;
    while (startIndex > 0 && input.value.charAt(startIndex - 1).match(/\S/)) {
        startIndex--;
    }
    const newText = input.value.substring(0, startIndex) + '@' + selectedValue + ' ' + input.value.substring(cursorPosition);
    input.value = newText;
    input.selectionStart = input.selectionEnd = startIndex + 1 + selectedValue.length + 1;
    input.focus();
    hideAutocomplete();
    autosize();
}


// Drawer functions moved to global scope
function openDrawer(){
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    if (sidebar) sidebar.classList.add('open');
    if (overlay) overlay.classList.add('open');
}

function closeDrawer(){
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    if (sidebar) sidebar.classList.remove('open');
    if (overlay) overlay.classList.remove('open'); // Also hide the overlay when closing
}

// Private chat / Personal chat related functions pushed up to global scope
function pushUserMessage(text){
    const chat = currentChat();
    const msg = { role:'user', content:text, ts: Date.now() };
    chat.messages.push(msg);
    chat.updatedAt = Date.now();
    updateChatTitleFromFirstUserMessage(chat); // Only personal chats
    saveAll();
    renderChatList();
    const wrap = document.getElementById('messages');
    if (!wrap) return;
    const el = renderMessage(msg);
    wrap.appendChild(el);
    ensureEnhancements(el);
    scrollToBottom(true); // Ensure message is visible before AI starts typing
    updateLazyMarkerVisibility();
}

async function streamAssistant(){
    const chat = currentChat();
    const wrap = document.getElementById('messages');
    if (!wrap) return;
    if (chat.messages.length === 0) {
        console.warn("Attempted to stream AI with empty chat history. Skipping.");
        updateStatus('');
        isSendingMessage = false; // Reset sending state if no messages to stream
        document.getElementById('send').classList.remove('sending');
        document.getElementById('send').style.pointerEvents = 'auto';
        return;
    }
    const typingMsgEl = renderMessage({role:'assistant', content:'', ts:Date.now()}, true);
    wrap.appendChild(typingMsgEl);
    scrollToBottom();
    const messagesPayload = chat.messages.map(m=>({role:m.role, content:m.content}));
    const body = {
        model: MODEL,
        stream: true,
        messages: messagesPayload
    };
    lastRequestClone = body;
    updateStatus('Connecting‚Ä¶');
    isStreaming = true;
    let assistantFullText = '';
    let displayedAssistantText = '';
    const mdContentEl = typingMsgEl.querySelector('.md-content');
    const copyBtn = typingMsgEl.querySelector('.copy-btn');
    const isTypingSpan = mdContentEl.querySelector('.is-typing');
    if (isTypingSpan) {
        isTypingSpan.remove();
    }
    if (copyBtn) copyBtn.classList.add('hidden');
    const typeCharacter = () => {
        if (displayedAssistantText.length < assistantFullText.length) {
            const charsToAdd = Math.min(2, assistantFullText.length - displayedAssistantText.length);
            displayedAssistantText += assistantFullText.substring(displayedAssistantText.length, displayedAssistantText.length + charsToAdd);
            mdContentEl.innerHTML = renderMarkdown(processTextForMentionsAndCommands(displayedAssistantText)) + '<span class="typing-cursor"></span>';
            if (atBottom) scrollToBottom();
        } else if (!isStreaming) { // Final render when streaming is done
            clearInterval(typingAnimationInterval);
            typingAnimationInterval = null;
            mdContentEl.innerHTML = renderMarkdown(processTextForMentionsAndCommands(assistantFullText));
            ensureEnhancements(mdContentEl);
            if (copyBtn) copyBtn.classList.remove('hidden');
            updateStatus('');
            isSendingMessage = false; // Reset send state after AI is done
            document.getElementById('send').classList.remove('sending');
            document.getElementById('send').style.pointerEvents = 'auto';
        }
    };
    typingAnimationInterval = setInterval(typeCharacter, isUserAdmin() ? TYPING_SPEED_ADMIN_MS : TYPING_SPEED_NORMAL_MS); // Apply VIP typing speed
    let sseBuffer = '';
    try{
        const res = await fetch(API_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${API_KEY}`
            },
            body: JSON.stringify(body)
        });
        if (!res.ok || !res.body){
            const errorText = await res.text();
            throw new Error(`HTTP ${res.status} ${res.statusText}. Details: ${errorText.substring(0, 200)}...`);
        }
        const reader = res.body.getReader();
        let doneReading = false;
        const textDecoder = new TextDecoder('utf-8');
        while(!doneReading){
            const {value, done: readerDone} = await reader.read();
            if (readerDone) { doneReading = true; break; }
            const chunk = textDecoder.decode(value, {stream:true});
            sseBuffer += chunk;
            const events = sseBuffer.split(/\n\n/);
            sseBuffer = events.pop();
            for (const event of events) {
                const lines = event.split(/\n/);
                let dataLine = '';
                for (const line of lines) {
                    if (line.startsWith('data:')) {
                        dataLine = line.slice(5).trim();
                        break;
                    }
                }
                if (dataLine === '[DONE]') {
                    doneReading = true;
                    break;
                }
                if (dataLine) {
                    try {
                        const json = JSON.parse(dataLine);
                        const delta = json.choices?.[0]?.delta?.content ?? '';
                        if (delta) {
                            assistantFullText += delta;
                        }
                    } catch (e) {
                        console.warn("Error parsing SSE data chunk. Skipping:", e, "Data:", dataLine);
                    }
                }
            }
        }
        if (sseBuffer) { // Flush any remaining buffer
            assistantFullText += textDecoder.decode(new Uint8Array(0), {stream:false});
        }
    }catch(err){
        console.error("Streaming error:", err);
        if (typingAnimationInterval) {
            clearInterval(typingAnimationInterval);
            typingAnimationInterval = null;
        }
        isStreaming = false;
        const errorMessage = `<div>Error: ${escapeHTML(err.message || 'Unknown API error.')}</div>`;
        mdContentEl.innerHTML = errorMessage + `<button class="retry-btn" style="margin-top: .5rem; font-size:.85em;"><i class="fa-solid fa-rotate-right"></i> Retry</button>`;
        if (copyBtn) copyBtn.classList.add('hidden');
        mdContentEl.querySelector('.retry-btn')?.addEventListener('click', ()=>{
            typingMsgEl.remove();
            if (lastRequestClone && !isStreaming){
                streamRetryFromClone(lastRequestClone);
            }
        });
        showErrorBanner('Network/API error. ', ()=>{
            if (lastRequestClone && !isStreaming){
                streamRetryFromClone(lastRequestClone);
            }
        });
        updateStatus('Error');
    }finally{
        isStreaming = false;
        if (typingAnimationInterval) {
            clearInterval(typingAnimationInterval);
            typingAnimationInterval = null;
        }
        if (mdContentEl) {
            mdContentEl.innerHTML = renderMarkdown(processTextForMentionsAndCommands(assistantFullText || '(no content)'));
            ensureEnhancements(mdContentEl);
        }
        if (copyBtn) copyBtn.classList.remove('hidden');
        attachCopyButtons(typingMsgEl.querySelector('.bubble')); // Ensure copy button for personal chat
        updateLazyMarkerVisibility();

        const finalMsg = { role:'assistant', content: assistantFullText || '(no content)', ts: Date.now() };
        chat.messages.push(finalMsg);
        chat.updatedAt = Date.now();
        saveAll();
        renderChatList(); // Update chat list with new message/time
        isSendingMessage = false; // Reset send state after AI is done
        document.getElementById('send').classList.remove('sending');
        document.getElementById('send').style.pointerEvents = 'auto';
    }
}

initTheme();
initMarkedHLJS();
wireUI();
const curlCodeBlock = document.querySelector('.tutorial-section .language-bash');
if (curlCodeBlock) {
curlCodeBlock.textContent = curlCodeBlock.textContent
.replace('YOUR_API_URL', API_URL)
.replace('YOUR_CEREBRAS_API_KEY', 'YOUR_CEREBRAS_API_KEY');
}
// Show page as async to allow promptForUsername to be async
showPage('chat');

async function showPage(pageName) { // Make this function async
const homepage = document.getElementById('homepage');
const chatContainer = document.getElementById('chatContainer');
if (pageName === 'home') {
homepage.style.display = 'flex';
homepage.classList.add('active');
chatContainer.style.display = 'none';
chatContainer.classList.remove('active');
} else if (pageName === 'chat') {
if (!username || !(loggedInAdminUsers.has(username) && (username === ADMIN_USERNAME || username === NEW_ADMIN_USERNAME))) {
// If no username is set, or if it's an admin username but not authenticated yet
await promptForUsername(); // Await the username prompt
}
homepage.style.display = 'none';
homepage.classList.remove('active');
chatContainer.style.display = 'grid';
chatContainer.classList.add('active');
renderChatList();
renderCurrentChat();
if (isFirstChatVisitInSession && currentChat().id !== GLOBAL_CHAT_ID && currentChat().messages.length === 0) {
setTimeout(() => {
const chat = currentChat();
const syntheticMsg = { role:'user', content:'Hi there! What model is used for your training?', ts: Date.now() };
chat.messages.push(syntheticMsg);
saveAll();
renderChatList();
const wrap = document.getElementById('messages');
if (wrap) {
wrap.appendChild(renderMessage(syntheticMsg));
ensureEnhancements(wrap);
scrollToBottom(true);
}
streamAssistant();
}, 1000);
isFirstChatVisitInSession = false;
}
}
}

// Function to check for basic XSS patterns in a string (e.g., for usernames)
function containsXSS(text) {
    const lowerText = text.toLowerCase();
    // Look for common patterns: script tags, HTML entities for tags, javascript: URLs, common event handlers
    if (/<script/i.test(lowerText) ||
        /<img[^>]*onerror/i.test(lowerText) ||
        /&#x?\d+;/i.test(lowerText) || // HTML numeric entities (e.g., &#x3C; for <)
        /javascript:/i.test(lowerText) ||
        /data:text\/html/i.test(lowerText) ||
        /<iframe/i.test(lowerText) ||
        /<object/i.test(lowerText) ||
        /<embed/i.test(lowerText) ||
        /<svg/i.test(lowerText) ||
        /on\w+=/i.test(lowerText) // matches onerror=, onclick=, etc.
    ) {
        return true;
    }
    return false;
}

// Helper function for admin login attempts
async function handleAdminLoginAttempt(enteredUsername, passwordPromptMessage, correctHash) {
    const password = prompt(passwordPromptMessage);
    if (password === null) {
        return { success: false, message: "Admin login cancelled." };
    } else {
        const hashedPassword = await hashString(password);
        if (hashedPassword === correctHash) {
            loggedInAdminUsers.add(enteredUscuntfacee);
            saveLoggedInAdminUsers(); // Save the new admin status
            return { success: true, message: `Welcome, ${enteredUsername}! You are logged in as an Admin.` };
        } else {
            return { success: false, message: "Incorrect password." };
        }
    }
}

async function promptForUsername() {
    // If username is already set AND it's an admin username AND it's in the loggedInAdminUsers set, don't re-prompt
    if (username && (username === ADMIN_USERNAME || username === NEW_ADMIN_USERNAME) && loggedInAdminUsers.has(username)) {
        return;
    }

    let tempUsername = prompt("Please enter your username for the global chat:", username || "Guest" + Math.floor(Math.random() * 1000));
    if (tempUsername === null || tempUsername.trim() === "") {
        tempUsername = "Guest" + Math.floor(Math.random() * 1000);
    }
    tempUsername = tempUsername.trim().slice(0, 20); // Trim and slice first

    let effectiveUsername = "Guest" + Math.floor(Math.random() * 1000); // Default to a random guest name
    let messageToUser = `Welcome, ${effectiveUsername}! Your username is set for global chat.`;

    let adminLoginHandled = false;

    if (tempUsername === ADMIN_USERNAME) {
        adminLoginHandled = true;
        const result = await handleAdminLoginAttempt(
            ADMIN_USERNAME,
            `Enter password for admin user "${ADMIN_USERNAME}":`,
            ORIGINAL_ADMIN_PASSWORD_HASH
        );
        if (result.success) {
            effectiveUsername = ADMIN_USERNAME;
            messageToUser = result.message;
        } else {
            messageToUser = result.message + " You are logged in as a guest.";
        }
    } else if (tempUsername === NEW_ADMIN_USERNAME) {
        adminLoginHandled = true;
        const result = await handleAdminLoginAttempt(
            NEW_ADMIN_USERNAME,
            `Enter password for admin user "${NEW_ADMIN_USERNAME}":`,
            NEW_ADMIN_PASSWORD_HASH
        );
        if (result.success) {
            effectiveUsername = NEW_ADMIN_USERNAME;
            messageToUser = result.message;
        } else {
            messageToUser = result.message + " You are logged in as a guest.";
        }
    }
    
 const PROFANITY_LIST = [
  "2 girls 1 cup",
  "2g1c",
  "4r5e",
  "5h1t",
  "5hit",
  "5ht",
  "@$$",
  "a s s",
  "a s shole",
  "a55",
  "a55hole",
  "a_s_s",
  "abbo",
  "abeed",
  "abuse",
  "acrotomophilia",
  "africoon",
  "ahole",
  "alabama hot pocket",
  "alaskan pipeline",
  "alligator bait",
  "alligatorbait",
  "amcik",
  "anal",
  "analannie",
  "analprobe",
  "analsex",
  "andskota",
  "anilingus",
  "anus",
  "apeshit",
  "ar5e",
  "arabush",
  "arabushs",
  "areola",
  "areole",
  "argie",
  "armo",
  "armos",
  "arrse",
  "arschloch",
  "arse",
  "arsehole",
  "aryan",
  "ash0le",
  "ash0les",
  "asholes",
  "ass monkey",
  "ass",
  "ass-fucker",
  "ass-hat",
  "ass-pirate",
  "assbag",
  "assbagger",
  "assbandit",
  "assbang",
  "assbanged",
  "assbanger",
  "assbangs",
  "assbite",
  "assblaster",
  "assclown",
  "asscock",
  "asscowboy",
  "asscracker",
  "asses",
  "assface",
  "assfuck",
  "assfucker",
  "assfukka",
  "assgoblin",
  "assh0le",
  "assh0lez",
  "asshat",
  "asshead",
  "assho1e",
  "asshole",
  "assholes",
  "assholz",
  "asshopper",
  "asshore",
  "assjacker",
  "assjockey",
  "asskiss",
  "asskisser",
  "assklown",
  "asslick",
  "asslicker",
  "asslover",
  "assman",
  "assmaster",
  "assmonkey",
  "assmunch",
  "assmuncher",
  "assnigger",
  "asspacker",
  "asspirate",
  "asspuppies",
  "assrammer",
  "assranger",
  "assshit",
  "assshole",
  "asssucker",
  "asswad",
  "asswhole",
  "asswhore",
  "asswipe",
  "asswipes",
  "auto erotic",
  "autoerotic",
  "ayir",
  "azazel",
  "azz",
  "azzhole",
  "b a s t a r d",
  "b i t c h",
  "b o o b",
  "b!+ch",
  "b!tch",
  "b!tchin",
  "b*tch",
  "b00b",
  "b00bies",
  "b00biez",
  "b00bs",
  "b00bz",
  "b17ch",
  "b1tch",
  "b7ch",
  "babeland",
  "babes",
  "baby batter",
  "baby juice",
  "backdoorman",
  "badfuck",
  "ball gag",
  "ball gravy",
  "ball kicking",
  "ball licking",
  "ball sack",
  "ball sucking",
  "ballbag",
  "balllicker",
  "ballsack",
  "bampot",
  "bangbro",
  "bangbros",
  "bangbus",
  "bareback",
  "barely legal",
  "barelylegal",
  "barenaked",
  "barface",
  "barfface",
  "bassterd",
  "bassterds",
  "bastard",
  "bastardo",
  "bastards",
  "bastardz",
  "basterds",
  "basterdz",
  "bastinado",
  "bazongas",
  "bazooms",
  "bbw",
  "bdsm",
  "beaner",
  "beaners",
  "beaney",
  "beaneys",
  "beardedclam",
  "beastality",
  "beastial",
  "beastiality",
  "beastility",
  "beatch",
  "beatoff",
  "beatyourmeat",
  "beaver cleaver",
  "beaver lips",
  "beef curtains",
  "beeyotch",
  "bellend",
  "beotch",
  "bestial",
  "bestiality",
  "bi curious",
  "bi+ch",
  "bi7ch",
  "biatch",
  "bicurious",
  "big black",
  "big breasts",
  "big knockers",
  "big tits",
  "bigass",
  "bigbastard",
  "bigbreasts",
  "bigbutt",
  "bigtits",
  "bimbo",
  "bimbos",
  "bint",
  "birdlock",
  "bitch",
  "bitchass",
  "bitched",
  "bitcher",
  "bitchers",
  "bitches",
  "bitchez",
  "bitchin",
  "bitching",
  "bitchslap",
  "bitchtit",
  "bitchy",
  "biteme",
  "bitties",
  "black cock",
  "blackcock",
  "blackman",
  "blacks",
  "blonde action",
  "blonde on blonde action",
  "blonde on blonde",
  "bloodclaat",
  "blow j",
  "blow job",
  "blow your l",
  "blow your load",
  "blowjob",
  "blowjobs",
  "blue waffle",
  "bluegum",
  "bluegums",
  "blumpkin",
  "bo ob",
  "bo obs",
  "boang",
  "boche",
  "boches",
  "boffing",
  "bogan",
  "bohunk",
  "boink",
  "boiolas",
  "bollick",
  "bollock",
  "bollocks",
  "bollok",
  "bollox",
  "bombers",
  "bomd",
  "bondage",
  "boned",
  "boner",
  "boners",
  "bong",
  "boong",
  "boonga",
  "boongas",
  "boongs",
  "boonie",
  "boonies",
  "booobs",
  "boooobs",
  "booooobs",
  "booooooobs",
  "bootee",
  "bootlip",
  "bootlips",
  "boozer",
  "bosch",
  "bosche",
  "bosches",
  "boschs",
  "bosomy",
  "bounty bar",
  "bounty bars",
  "bountybar",
  "brea5t",
  "breastjob",
  "breastlover",
  "breastman",
  "brown shower",
  "brown showers",
  "brunette action",
  "btch",
  "buceta",
  "buddhahead",
  "buddhaheads",
  "buffies",
  "bugger",
  "buggered",
  "buggery",
  "bukake",
  "bukkake",
  "bullcrap",
  "bulldike",
  "bulldyke",
  "bullet vibe",
  "bullshit",
  "bullshits",
  "bullshitted",
  "bullturds",
  "bumblefuck",
  "bumfuck",
  "bung hole",
  "bung",
  "bunga",
  "bungas",
  "bunghole",
  "bunny fucker",
  "burr head",
  "burr heads",
  "burrhead",
  "burrheads",
  "butchbabes",
  "butchdike",
  "butchdyke",
  "butt plug",
  "butt-pirate",
  "buttbang",
  "buttcheeks",
  "buttface",
  "buttfuck",
  "buttfucker",
  "buttfuckers",
  "butthead",
  "butthole",
  "buttman",
  "buttmuch",
  "buttmunch",
  "buttmuncher",
  "buttpirate",
  "buttplug",
  "buttstain",
  "buttwipe",
  "byatch",
  "c u n t",
  "c-0-c-k",
  "c-o-c-k",
  "c-u-n-t",
  "c.0.c.k",
  "c.o.c.k.",
  "c.u.n.t",
  "c0ck",
  "c0cks",
  "c0cksucker",
  "c0k",
  "cabron",
  "caca",
  "cacker",
  "cahone",
  "camel jockey",
  "camel jockeys",
  "camel toe",
  "cameljockey",
  "cameltoe",
  "camgirl",
  "camslut",
  "camwhore",
  "carpet muncher",
  "carpetmuncher",
  "carruth",
  "cawk",
  "cawks",
  "cazzo",
  "chav",
  "cheese eating surrender monkey",
  "cheese eating surrender monkies",
  "cheeseeating surrender monkey",
  "cheeseeating surrender monkies",
  "cheesehead",
  "cheeseheads",
  "cherrypopper",
  "chickslick",
  "china swede",
  "china swedes",
  "chinaman",
  "chinamen",
  "chinaswede",
  "chinaswedes",
  "chinc",
  "chincs",
  "ching chong",
  "ching chongs",
  "chinga",
  "chingchong",
  "chingchongs",
  "chink",
  "chinks",
  "chinky",
  "choad",
  "chocolate rosebuds",
  "chode",
  "chodes",
  "chonkies",
  "chonky",
  "chonkys",
  "chraa",
  "christ killer",
  "christ killers",
  "chug",
  "chugs",
  "chuj",
  "chunger",
  "chungers",
  "chunkies",
  "chunkys",
  "cipa",
  "circlejerk",
  "cl1t",
  "clamdigger",
  "clamdiver",
  "clamps",
  "clansman",
  "clansmen",
  "clanswoman",
  "clanswomen",
  "cleveland steamer",
  "clit",
  "clitface",
  "clitfuck",
  "clitoris",
  "clitorus",
  "clits",
  "clitty",
  "clogwog",
  "clover clamps",
  "clusterfuck",
  "cnts",
  "cntz",
  "cnut",
  "cocain",
  "cocaine",
  "cock",
  "cock-head",
  "cock-sucker",
  "cockbite",
  "cockblock",
  "cockblocker",
  "cockburger",
  "cockcowboy",
  "cockface",
  "cockfight",
  "cockfucker",
  "cockhead",
  "cockholster",
  "cockjockey",
  "cockknob",
  "cockknocker",
  "cockknoker",
  "cocklicker",
  "cocklover",
  "cockmaster",
  "cockmongler",
  "cockmongruel",
  "cockmonkey",
  "cockmunch",
  "cockmuncher",
  "cocknob",
  "cocknose",
  "cocknugget",
  "cockqueen",
  "cockrider",
  "cocks",
  "cockshit",
  "cocksman",
  "cocksmith",
  "cocksmoker",
  "cocksucer",
  "cocksuck",
  "cocksucked",
  "cocksucker",
  "cocksucking",
  "cocksucks",
  "cocksuka",
  "cocksukka",
  "cocktease",
  "cocky",
  "cohee",
  "coital",
  "coitus",
  "cok",
  "cokmuncher",
  "coksucka",
  "condom",
  "coochie",
  "coochy",
  "coolie",
  "coolies",
  "cooly",
  "coon ass",
  "coon asses",
  "coonass",
  "coonasses",
  "coondog",
  "coons",
  "cooter",
  "coprolagnia",
  "coprophilia",
  "copulate",
  "corksucker",
  "cornhole",
  "cra5h",
  "crackcocain",
  "crackpipe",
  "crackwhore",
  "crap",
  "crapola",
  "crapper",
  "crappy",
  "creampie",
  "crotchjockey",
  "crotchmonkey",
  "crotchrot",
  "cuck",
  "cum face",
  "cum licker",
  "cum",
  "cumbubble",
  "cumdumpster",
  "cumfest",
  "cumguzzler",
  "cuming",
  "cumjockey",
  "cumlickr",
  "cumm",
  "cummer",
  "cummin",
  "cumming",
  "cumquat",
  "cumqueen",
  "cums",
  "cumshot",
  "cumshots",
  "cumslut",
  "cumstain",
  "cumsucker",
  "cumtart",
  "cunilingus",
  "cunillingus",
  "cunn",
  "cunnie",
  "cunnilingus",
  "cunntt",
  "cunny",
  "cunt",
  "cunteyed",
  "cuntface",
  "jerkoff",
  "jerries",
  "jerry",
  "jewboy",
  "jewed",
  "jewess",
  "jiga",
  "jigaboo",
  "jigaboos",
  "jigarooni",
  "jigaroonis",
  "jigg",
  "jigga",
  "jiggabo",
  "jiggaboo",
  "jiggabos",
  "jiggas",
  "jigger",
  "jiggerboo",
  "jiggers",
  "jiggs",
  "jiggy",
  "jigs",
  "jihad",
  "jijjiboo",
  "jijjiboos",
  "jimfish",
  "jisim",
  "jism",
  "jiss",
  "jiz",
  "jizim",
  "jizin",
  "jizjuice",
  "jizm",
  "jizn",
  "jizz",
  "jizzd",
  "jizzed",
  "jizzim",
  "jizzin",
  "jizzn",
  "jizzum",
  "jugg",
  "juggs",
  "jungle bunnies",
  "jungle bunny",
  "junglebunny",
  "junkie",
  "junky",
  "kacap",
  "kacapas",
  "kacaps",
  "kaffer",
  "kaffir",
  "kaffre",
  "kafir",
  "kanake",
  "kanker",
  "katsap",
  "katsaps",
  "kawk",
  "khokhol",
  "khokhols",
  "kigger",
  "kike",
  "kikes",
  "kimchis",
  "kinbaku",
  "kink",
  "kinkster",
  "kinky",
  "kinkyjesus",
  "kissass",
  "kiunt",
  "kkk",
  "klan",
  "klansman",
  "klansmen",
  "klanswoman",
  "klanswomen",
  "klootzak",
  "knobbing",
  "knobead",
  "knobed",
  "knobend",
  "knobhead",
  "knobjocky",
  "knobjokey",
  "knobz",
  "knockers",
  "knulle",
  "kock",
  "kondum",
  "kondums",
  "kooch",
  "kooches",
  "koon",
  "kootch",
  "krap",
  "krappy",
  "kraut",
  "krauts",
  "kuffar",
  "kuk",
  "kuksuger",
  "kum",
  "kumbubble",
  "kumbullbe",
  "kumer",
  "kummer",
  "kumming",
  "kums",
  "kunilingus",
  "kunnilingus",
  "kunt",
  "kunts",
  "kuntz",
  "kurac",
  "kurwa",
  "kushi",
  "kushis",
  "kusi",
  "kwa",
  "kwai lo",
  "kwai los",
  "kwif",
  "kyke",
  "kykes",
  "kyopo",
  "kyopos",
  "kyrpa",
  "l3i+ch",
  "l3i\\+ch",
  "l3itch",
  "labia",
  "lapdance",
  "leather restraint",
  "leather straight",
  "leatherrestraint",
  "lebos",
  "lech",
  "lemon party",
  "lemonparty",
  "leper",
  "lesbain",
  "lesbayn",
  "lesbin",
  "lesbo",
  "lesbos",
  "lez",
  "lezbe",
  "lezbefriends",
  "lezbian",
  "lezbians",
  "lezbo",
  "lezbos",
  "lezz",
  "lezzian",
  "lezzie",
  "lezzies",
  "lezzo",
  "lezzy",
  "libido",
  "licker",
  "licking",
  "lickme",
  "lilniglet",
  "limey",
  "limpdick",
  "limy",
  "lingerie",
  "lipshits",
  "lipshitz",
  "livesex",
  "loadedgun",
  "lolita",
  "lovebone",
  "lovegoo",
  "lovegun",
  "lovejuice",
  "lovemuscle",
  "lovepistol",
  "loverocket",
  "lowlife",
  "lsd",
  "lubejob",
  "lubra",
  "lucifer",
  "luckycammeltoe",
  "lugan",
  "lugans",
  "lusting",
  "lusty",
  "lynch",
  "m-fucking",
  "m0f0",
  "m0fo",
  "m45terbate",
  "ma5terb8",
  "ma5terbate",
  "mabuno",
  "mabunos",
  "macaca",
  "macacas",
  "mafugly",
  "magicwand",
  "mahbuno",
  "mahbunos",
  "make me come",
  "makemecome",
  "makemecum",
  "male squirting",
  "mamhoon",
  "mams",
  "manhater",
  "manpaste",
  "maricon",
  "maric√≥n",
  "marijuana",
  "masochist",
  "masokist",
  "massa",
  "massterbait",
  "masstrbait",
  "masstrbate",
  "mastabate",
  "mastabater",
  "master-bate",
  "masterb8",
  "masterbaiter",
  "masterbat",
  "masterbat3",
  "masterbate",
  "masterbates",
  "masterbating",
  "masterbation",
  "masterbations",
  "masterblaster",
  "mastrabator",
  "masturbat",
  "masturbate",
  "masturbating",
  "masturbation",
  "mattressprincess",
  "mau mau",
  "mau maus",
  "maumau",
  "maumaus",
  "mcfagget",
  "meatbeatter",
  "meatrack",
  "menage",
  "merd",
  "mgger",
  "mggor",
  "mibun",
  "mick",
  "mickeyfinn",
  "mideast",
  "mierda",
  "milf",
  "mindfuck",
  "minge",
  "minger",
  "mo-fo",
  "mockey",
  "mockie",
  "mocky",
  "mof0",
  "mofo",
  "moky",
  "molest",
  "molestation",
  "molester",
  "molestor",
  "moneyshot",
  "mong",
  "monkleigh",
  "moolie",
  "moon cricket",
  "moon crickets",
  "mooncricket",
  "mooncrickets",
  "moron",
  "moskal",
  "moskals",
  "moslem",
  "mosshead",
  "motha fucker",
  "motha fuker",
  "motha fukkah",
  "motha fukker",
  "mothafuck",
  "mothafucka",
  "mothafuckas",
  "mothafuckaz",
  "mothafucked",
  "mothafucker",
  "mothafuckers",
  "mothafuckin",
  "mothafucking",
  "mothafuckings",
  "mothafucks",
  "mother fucker",
  "mother fukah",
  "mother fuker",
  "mother fukkah",
  "mother fukker",
  "mother-fucker",
  "motherfuck",
  "motherfucka",
  "motherfucked",
  "motherfucker",
  "motherfuckers",
  "motherfuckin",
  "motherfucking",
  "motherfuckings",
  "motherfuckka",
  "motherfucks",
  "motherfvcker",
  "motherlovebone",
  "mothrfucker",
  "mouliewop",
  "mound of venus",
  "moundofvenus",
  "mr hands",
  "mrhands",
  "mtherfucker",
  "mthrfuck",
  "mthrfucker",
  "mthrfucking",
  "mtrfck",
  "mtrfuck",
  "mtrfucker",
  "muff diver",
  "muff",
  "muffdive",
  "muffdiver",
  "muffdiving",
  "muffindiver",
  "mufflikcer",
  "muffpuff",
  "muie",
  "mulatto",
  "mulkku",
  "muncher",
  "munging",
  "munt",
  "munter",
  "muschi",
  "mutha fucker",
  "mutha fukah",
  "mutha fuker",
  "mutha fukkah",
  "mutha fukker",
  "muthafecker",
  "muthafuckaz",
  "muthafucker",
  "muthafuckker",
  "muther",
  "mutherfucker",
  "mutherfucking",
  "muthrfucking",
  "mzungu",
  "mzungus",
  "n1gga",
  "n1gger",
  "n1gr",
  "nads",
  "naked",
  "nambla",
  "nastt",
  "nastybitch",
  "nastyho",
  "nastyslut",
  "nastywhore",
  "nawashi",
  "nazi",
  "nazis",
  "nazism",
  "necro",
  "needthedick",
  "negres",
  "negress",
  "negro",
  "negroes",
  "negroid",
  "negros",
  "neonazi",
  "nepesaurio",
  "nig nog",
  "nig",
  "niga",
  "nigar",
  "nigars",
  "nigas",
  "nigers",
  "nigette",
  "nigettes",
  "nigg",
  "nigg3r",
  "nigg4h",
  "nigga",
  "niggah",
  "niggahs",
  "niggar",
  "niggaracci",
  "niggard",
  "niggarded",
  "niggarding",
  "niggardliness",
  "niggardlinesss",
  "niggardly",
  "niggards",
  "niggars",
  "niggas",
  "niggaz",
  "nigger",
  "niggerhead",
  "niggerhole",
  "niggers",
  "niggle",
  "niggled",
  "niggles",
  "nigglings",
  "niggor",
  "niggress",
  "niggresses",
  "nigguh",
  "nigguhs",
  "niggur",
  "niggurs",
  "niglet",
  "nignog",
  "nigor",
  "nigors",
  "nigr",
  "nigra",
  "nigras",
  "nigre",
  "nigres",
  "nigress",
  "nigs",
  "nigur",
  "niiger",
  "niigr",
  "nimphomania",
  "nimrod",
  "ninny",
  "nipple",
  "nipplering",
  "nipples",
  "nips",
  "nittit",
  "nlgger",
  "nlggor",
  "nob jokey",
  "nob",
  "nobhead",
  "nobjocky",
  "nobjokey",
  "nofuckingway",
  "nog",
  "nookey",
  "nookie",
  "nooky",
  "noonan",
  "nooner",
  "nsfw images",
  "nsfw",
  "nudger",
  "nudie",
  "nudies",
  "numbnuts",
  "nut sack",
  "nutbutter",
  "nutfucker",
  "nutsack",
  "nutten",
  "nympho",
  "nymphomania",
  "o c k",
  "octopussy",
  "omorashi",
  "one cup two girls",
  "one guy one jar",
  "one guy",
  "one jar",
  "ontherag",
  "orafis",
  "orga",
  "orgasim",
  "orgasim;",
  "orgasims",
  "orgasm",
  "orgasmic",
  "orgasms",
  "orgasum",
  "orgies",
  "orgy",
  "oriface",
  "orifiss",
  "orospu",
  "osama",
  "ovum",
  "ovums",
  "p e n i s",
  "p i s",
  "p u s s y",
  "p.u.s.s.y.",
  "p0rn",
  "packi",
  "packie",
  "packy",
  "paddy",
  "paedophile",
  "paki",
  "pakie",
  "pakis",
  "paky",
  "palesimian",
  "pancake face",
  "pancake faces",
  "panooch",
  "pansies",
  "pansy",
  "panti",
  "pantie",
  "panties",
  "panty",
  "paska",
  "payo",
  "pcp",
  "pearlnecklace",
  "pecker",
  "peckerhead",
  "peckerwood",
  "pedo",
  "pedobear",
  "pedophile",
  "pedophilia",
  "pedophiliac",
  "peeenus",
  "peeenusss",
  "peehole",
  "peenus",
  "peepee",
  "peepshow",
  "peepshpw",
  "pegging",
  "peinus",
  "pen1s",
  "penas",
  "pendejo",
  "pendy",
  "penetrate",
  "penetration",
  "peni5",
  "penial",
  "penile",
  "penis",
  "penis-breath",
  "penises",
  "penisfucker",
  "penisland",
  "penislick",
  "penislicker",
  "penispuffer",
  "penthouse",
  "penus",
  "penuus",
  "perse",
  "perv",
  "perversion",
  "peyote",
  "phalli",
  "phallic",
  "phone sex",
  "phonesex",
  "phuc",
  "phuck",
  "phuk",
  "phuked",
  "phuker",
  "phuking",
  "phukked",
  "phukker",
  "phukking",
  "phuks",
  "phungky",
  "phuq",
  "pi55",
  "picaninny",
  "piccaninny",
  "picka",
  "pickaninnies",
  "pickaninny",
  "piece of shit",
  "pieceofshit",
  "piefke",
  "piefkes",
  "pierdol",
  "pigfucker",
  "piker",
  "pikey",
  "piky",
  "pillowbiter",
  "pillu",
  "pimmel",
  "pimp",
  "pimped",
  "pimper",
  "pimpis",
  "pimpjuic",
  "pimpjuice",
  "pimpsimp",
  "pindick",
  "pinko",
  "pis",
  "pises",
  "pisin",
  "pising",
  "pisof",
  "piss pig",
  "piss",
  "piss-off",
  "pissed",
  "pisser",
  "pissers",
  "pisses",
  "pissflap",
  "pissflaps",
  "pisshead",
  "pissin",
  "pissing",
  "pissoff",
  "pisspig",
  "pizda",
  "playboy",
  "playgirl",
  "pleasure chest",
  "pleasurechest",
  "pocha",
  "pochas",
  "pocho",
  "pochos",
  "pocketpool",
  "pohm",
  "pohms",
  "polac",
  "polack",
  "polacks",
  "polak",
  "pole smoker",
  "polesmoker",
  "pollock",
  "pollocks",
  "pommie grant",
  "pommie grants",
  "pommy",
  "ponyplay",
  "poof",
  "poon",
  "poonani",
  "poonany",
  "poontang",
  "poontsee",
  "poop chute",
  "poopchute",
  "pooper",
  "pooperscooper",
  "pooping",
  "poorwhitetrash",
  "popimp",
  "porch monkey",
  "porch monkies",
  "porchmonkey",
  "porn",
  "pornflick",
  "pornking",
  "porno",
  "pornography",
  "pornos",
  "pornprincess",
  "pound town",
  "poundtown",
  "pplicker",
  "pr0n",
  "pr1c",
  "pr1ck",
  "pr1k",
  "prairie nigger",
  "prairie niggers",
  "preteen",
  "pric",
  "prickhead",
  "pricks",
  "prig",
  "prince albert piercing",
  "pron",
  "pthc",
  "pu55i",
  "pu55y",
  "pube",
  "pubes",
  "pubic",
  "pubiclice",
  "pubis",
  "pudboy",
  "pudd",
  "puddboy",
  "pula",
  "punani",
  "punanny",
  "punany",
  "punkass",
  "punky",
  "punta",
  "puntang",
  "purinapricness",
  "pusies",
  "puss",
  "pusse",
  "pussee",
  "pussi",
  "pussie",
  "pussies",
  "pussy",
  "pussycat",
  "pussydestroyer",
  "pussyeater",
  "pussyfart",
  "pussyfuck",
  "pussyfucker",
  "pussylicker",
  "pussylicking",
  "pussylips",
  "pussylover",
  "pussypalace",
  "pussypounder",
  "pussys",
  "pusy",
  "puta",
  "puto",
  "puuke",
  "puuker",
  "qahbeh",
  "quashie",
  "queaf",
  "queef",
  "queerhole",
  "queero",
  "queers",
  "queerz",
  "quickie",
  "quicky",
  "quiff",
  "quim",
  "qweers",
  "qweerz",
  "qweir",
  "r-tard",
  "r-tards",
  "r5e",
  "ra8s",
  "raghead",
  "ragheads",
  "rape",
  "raped",
  "raper",
  "raping",
  "rapist",
  "rautenberg",
  "rearend",
  "rearentry",
  "recktum",
  "rectal",
  "rectum",
  "rectus",
  "redleg",
  "redlegs",
  "redlight",
  "redskin",
  "redskins",
  "reefer",
  "reestie",
  "reetard",
  "reich",
  "renob",
  "rentafuck",
  "rere",
  "retard",
  "retarded",
  "retards",
  "retardz",
  "reverse cowgirl",
  "reversecowgirl",
  "rimjaw",
  "rimjob",
  "rimming",
  "ritard",
  "rosebuds",
  "rosy palm and her 5 sisters",
  "rosy palm",
  "rosypalm",
  "rosypalmandher5sisters",
  "rosypalmmandherefivesisters",
  "round eyes",
  "roundeye",
  "rtard",
  "rtards",
  "rumprammer",
  "ruski",
  "russki",
  "russkie",
  "rusty trombone",
  "rustytrombone",
  "s h i t",
  "s hit",
  "s&m",
  "s-h-1-t",
  "s-h-i-t",
  "s-o-b",
  "s.h.i.t.",
  "s.o.b.",
  "s0b",
  "s_h_i_t",
  "sadis",
  "sadism",
  "sadist",
  "sadom",
  "sambo",
  "sambos",
  "samckdaddy",
  "sanchez",
  "sand nigger",
  "sand niggers",
  "sandm",
  "sandnigger",
  "santorum",
  "sausagequeen",
  "scag",
  "scallywag",
  "scank",
  "scantily",
  "scat",
  "schaffer",
  "scheiss",
  "schizo",
  "schlampe",
  "schlong",
  "schmuck",
  "schvartse",
  "schvartsen",
  "schwartze",
  "schwartzen",
  "scissoring",
  "screwyou",
  "scroat",
  "scrog",
  "scrote",
  "scrotum",
  "scrud",
  "seduce",
  "semen",
  "seppo",
  "seppos",
  "septics",
  "sex",
  "sexcam",
  "sexed",
  "sexfarm",
  "sexhound",
  "sexhouse",
  "sexi",
  "sexing",
  "sexkitten",
  "sexo",
  "sexpot",
  "sexslave",
  "sextogo",
  "sextoy",
  "sextoys",
  "sexual",
  "sexually",
  "sexwhore",
  "sexx",
  "sexxi",
  "sexxx",
  "sexxxi",
  "sexxxy",
  "sexxy",
  "sexy",
  "sexymoma",
  "sexyslim",
  "sh!+",
  "sh!t",
  "sh1t",
  "sh1ter",
  "sh1ts",
  "sh1tter",
  "sh1tz",
  "shag",
  "shagger",
  "shaggin",
  "shagging",
  "shamedame",
  "sharmuta",
  "sharmute",
  "shat",
  "shav",
  "shaved beaver",
  "shaved pussy",
  "shavedbeaver",
  "shavedpussy",
  "shawtypimp",
  "sheeney",
  "shemale",
  "shhit",
  "shi+",
  "shibari",
  "shibary",
  "shinola",
  "shipal",
  "shit ass",
  "shit",
  "shit-ass",
  "shit-bag",
  "shit-bagger",
  "shit-brain",
  "shit-breath",
  "shit-cunt",
  "shit-dick",
  "shit-eating",
  "shit-face",
  "shit-faced",
  "shit-fit",
  "shit-head",
  "shit-heel",
  "shit-hole",
  "shit-house",
  "shit-load",
  "shit-pot",
  "shit-spitter",
  "shit-stain",
  "shitass",
  "shitbag",
  "shitbagger",
  "shitblimp",
  "shitbrain",
  "shitbreath",
  "shitcan",
  "shitcunt",
  "shitdick",
  "shite",
  "shiteater",
  "shiteating",
  "shited",
  "shitey",
  "shitface",
  "shitfaced",
  "shitfit",
  "shitforbrains",
  "shitfuck",
  "shitfucker",
  "shitfull",
  "shithapens",
  "shithappens",
  "shithead",
  "shitheel",
  "shithole",
  "shithouse",
  "shiting",
  "shitings",
  "shitlist",
  "shitload",
  "shitola",
  "shitoutofluck",
  "shitpot",
  "shits",
  "shitspitter",
  "shitstain",
  "shitt",
  "shitted",
  "shitter",
  "shitters",
  "shittiest",
  "shitting",
  "shittings",
  "shitty",
  "shity",
  "shitz",
  "shiz",
  "shiznit",
  "shortfuck",
  "shota",
  "shylock",
  "shylocks",
  "shyt",
  "shyte",
  "shytty",
  "shyty",
  "simp",
  "sissy",
  "sixsixsix",
  "sixtynine",
  "sixtyniner",
  "skag",
  "skanck",
  "skank",
  "skankbitch",
  "skankee",
  "skankey",
  "skankfuck",
  "skanks",
  "skankwhore",
  "skanky",
  "skankybitch",
  "skankywhore",
  "skeet",
  "skinflute",
  "skribz",
  "skullfuck",
  "skum",
  "skumbag",
  "skurwysyn",
  "skwa",
  "skwe",
  "slag",
  "slanteye",
  "slanty",
  "slapper",
  "sleezeball",
  "slideitin",
  "slimeball",
  "slimebucket",
  "slopehead",
  "slopeheads",
  "sloper",
  "slopers",
  "slopey",
  "slopeys",
  "slopies",
  "slopy",
  "slut",
  "slutbag",
  "slutbucket",
  "slutdumper",
  "slutkiss",
  "sluts",
  "slutt",
  "slutting",
  "slutty",
  "slutwear",
  "slutwhore",
  "slutz",
  "smackthemonkey",
  "smeg",
  "smegma",
  "smut",
  "smutty",
  "snatchpatch",
  "sniggered",
  "sniggering",
  "sniggers",
  "snowback",
  "snowballing",
  "snownigger",
  "snuff",
  "socksucker",
  "sodom",
  "sodomise",
  "sodomite",
  "sodomize",
  "sodomy",
  "son of a bitch",
  "son of a whore",
  "son-of-a-bitch",
  "son-of-a-whore",
  "sonofabitch",
  "sonofbitch",
  "sooties",
  "souse",
  "soused",
  "soyboy",
  "spac",
  "spaghettibender",
  "spaghettinigger",
  "spank",
  "spankthemonkey",
  "spastic",
  "spearchucker",
  "spearchuckers",
  "sperm",
  "spermacide",
  "spermbag",
  "spermhearder",
  "spermherder",
  "sphencter",
  "spic",
  "spick",
  "spicks",
  "spics",
  "spierdalaj",
  "spig",
  "spigotty",
  "spik",
  "spiks",
  "splittail",
  "splooge",
  "spludge",
  "spooge",
  "spread legs",
  "spreadeagle",
  "spunk",
  "spunky",
  "sqeh",
  "squa",
  "squarehead",
  "squareheads",
  "squaw",
  "squinty",
  "squirting",
  "stagg",
  "stfu",
  "stiffy",
  "stoned",
  "stoner",
  "strap on",
  "strapon",
  "strappado",
  "strip club",
  "stripclub",
  "stroking",
  "stuinties",
  "stupidfuck",
  "stupidfucker",
  "style doggy",
  "suckdick",
  "sucked",
  "sucker",
  "sucking",
  "suckme",
  "suckmyass",
  "suckmydick",
  "suckmytit",
  "suckoff",
  "suicide girl",
  "suicide girls",
  "suicidegirl",
  "suicidegirls",
  "suka",
  "sultrywoman",
  "sultrywomen",
  "sumofabiatch",
  "swallower",
  "swalow",
  "swamp guinea",
  "swamp guineas",
  "swastika",
  "syphilis",
  "t i t",
  "t i ts",
  "t1t",
  "t1tt1e5",
  "t1tties",
  "tacohead",
  "tacoheads",
  "taff",
  "take off your",
  "tar babies",
  "tar baby",
  "tarbaby",
  "tard",
  "taste my",
  "tastemy",
  "tawdry",
  "tea bagging",
  "teabagging",
  "teat",
  "teets",
  "teez",
  "terd",
  "teste",
  "testee",
  "testes",
  "testical",
  "testicle",
  "testicles",
  "testis",
  "thicklip",
  "thicklips",
  "thirdeye",
  "thirdleg",
  "threesome",
  "threeway",
  "throating",
  "thumbzilla",
  "thundercunt",
  "tied up",
  "tig ol bitties",
  "tig old bitties",
  "tight white",
  "timber nigger",
  "timber niggers",
  "timbernigger",
  "tit",
  "titbitnipply",
  "titfuck",
  "titfucker",
  "titfuckin",
  "titi",
  "titjob",
  "titlicker",
  "titlover",
  "tits",
  "titt",
  "tittie",
  "tittie5",
  "tittiefucker",
  "titties",
  "tittis",
  "titty",
  "tittyfuck",
  "tittyfucker",
  "tittys",
  "tittywank",
  "titwank",
  "tity",
  "to murder",
  "tongethruster",
  "tongue in a",
  "tongueina",
  "tonguethrust",
  "tonguetramp",
  "toots",
  "topless",
  "tortur",
  "torture",
  "tosser",
  "towel head",
  "towel heads",
  "towelhead",
  "trailertrash",
  "trannie",
  "tranny",
  "transsexual",
  "transvestite",
  "tribadism",
  "trisexual",
  "trois",
  "trots",
  "tub girl",
  "tubgirl",
  "tuckahoe",
  "tunneloflove",
  "turd burgler",
  "turnon",
  "tush",
  "tushy",
  "tw4t",
  "twat",
  "twathead",
  "twatlips",
  "twats",
  "twatty",
  "twatwaffle",
  "twink",
  "twinkie",
  "two girls one cup",
  "twobitwhore",
  "twunt",
  "twunter",
  "udge packer",
  "ukrop",
  "unclefucker",
  "unfuckable",
  "upskirt",
  "uptheass",
  "upthebutt",
  "urethra play",
  "urethraplay",
  "urophilia",
  "usama",
  "ussys",
  "uzi",
  "v a g i n a",
  "v14gra",
  "v1gra",
  "v4gra",
  "va-j-j",
  "va1jina",
  "vag",
  "vag1na",
  "vagiina",
  "vaj1na",
  "vajina",
  "valium",
  "venus mound",
  "vgra",
  "vibr",
  "vibrater",
  "vibrator",
  "vigra",
  "violet wand",
  "virginbreaker",
  "vittu",
  "vixen",
  "vjayjay",
  "vorarephilia",
  "voyeurweb",
  "voyuer",
  "vullva",
  "vulva",
  "w00se",
  "w0p",
  "wab",
  "wang",
  "wank",
  "wanker",
  "wanking",
  "wanky",
  "waysted",
  "wazoo",
  "weenie",
  "weewee",
  "weiner",
  "welcher",
  "wench",
  "wet dream",
  "wetb",
  "wetback",
  "wetbacks",
  "wetdream",
  "wetspot",
  "wh00r",
  "wh0re",
  "wh0reface",
  "whacker",
  "whash",
  "whigger",
  "whiggers",
  "whiskeydick",
  "whiskydick",
  "whit",
  "white power",
  "white trash",
  "whitenigger",
  "whitepower",
  "whitetrash",
  "whitey",
  "whiteys",
  "whities",
  "whoar",
  "whop",
  "whoralicious",
  "whore",
  "whorealicious",
  "whorebag",
  "whored",
  "whoreface",
  "whorefucker",
  "whorehopper",
  "whorehouse",
  "whores",
  "whoring",
  "wichser",
  "wigga",
  "wiggas",
  "wigger",
  "wiggers",
  "willie",
  "willies",
  "williewanker",
  "willy",
  "wog",
  "wogs",
  "woose",
  "wop",
  "worldsex",
  "wrapping men",
  "wrinkled starfish",
  "wtf",
  "wuss",
  "wuzzie",
  "x-rated",
  "x-rated2g1c",
  "xkwe",
  "xrated",
  "xtc",
  "xx",
  "xxx",
  "xxxxxx",
  "yank",
  "yaoi",
  "yarpie",
  "yarpies",
  "yed",
  "yellow showers",
  "yellowman",
  "yellowshowers",
  "yid",
  "yids",
  "yiffy",
  "yobbo",
  "yourboobs",
  "yourpenis",
  "yourtits",
  "yury",
  "zabourah",
  "zigabo",
  "zigabos",
  "zipperhead",
  "zipperheads",
  "zoophile",
  "zoophilia",
  "üñï"
];
  
    PROFANITY_LIST.sort((a, b) => b.length - a.length); // Sort by length descending to catch longer phrases first
    
const profanityPatternParts = PROFANITY_LIST.map(word => {
    let pattern = '';
    for (let i = 0; i < word.length; i++) {
        const char = word[i];
        let charPattern;
        // Allow common leetspeak substitutions
        if (char.toLowerCase() === 'a') charPattern = '[aA4@]';
        else if (char.toLowerCase() === 'e') charPattern = '[eE3]';
        else if (char.toLowerCase() === 'i') charPattern = '[iI1!]';
        else if (char.toLowerCase() === 'o') charPattern = '[oO0]';
        else if (char.toLowerCase() === 's') charPattern = '[sS$]';
        else if (char.toLowerCase() === 't') charPattern = '[tT+]';
        // Match the character itself (case-insensitive)
        else charPattern = `[${char}${char.toUpperCase()}]`;
        
        pattern += charPattern;
        // Allow zero or more non-alphanumeric characters (including spaces, punctuation, underscores) between letters
        if (i < word.length - 1) {
            pattern += '[^a-zA-Z0-9]*';
        }
    }
    return pattern;
});
const PROFANITY_REGEX = new RegExp(`\\b(?:${profanityPatternParts.join('|')})\\b`, 'gi');
    // If it wasn't an admin login attempt, or if an admin login failed,
    // apply general username validation.
    if (!adminLoginHandled || effectiveUsername.startsWith("Guest")) {
        // XSS check
        if (containsXSS(tempUsername)) {
            effectiveUsername = "Guest" + Math.floor(Math.random() * 1000);
            messageToUser = "XSS detected in username. Assigned a random guest username.";
        }
        // Profanity check
        else if (PROFANITY_REGEX.test(tempUsername)) {
            effectiveUsername = "Guest" + Math.floor(Math.random() * 1000);
            messageToUser = "Profanity detected in username. Assigned a random guest username.";
        }
        // GPT-related names check
        else if ((tempUsername.toLowerCase() === 'gpt-4 turbo' || (tempUsername.toLowerCase().includes('gpt') && tempUsername.toLowerCase().includes('turbo')))) {
            effectiveUsername = "Guest" + Math.floor(Math.random() * 1000);
            messageToUser = "Username cannot be 'GPT-4 Turbo' or contain 'gpt' and 'turbo'. Assigned a random guest username.";
        }
        else if (!adminLoginHandled) { // Only set custom name if it wasn't an admin login attempt
            effectiveUsername = tempUsername; // Use the chosen custom name
            messageToUser = `Welcome, ${effectiveUsername}! Your username is set for global chat.`;
        }
    }

    username = effectiveUsername;
    localStorage.setItem(STORAGE.USERNAME, username);
    alert(messageToUser);
}


function isUserAdmin() {
    // Check if current user is one of the admin usernames AND has successfully logged in via password
    return (username === ADMIN_USERNAME || username === NEW_ADMIN_USERNAME) && loggedInAdminUsers.has(username);
}

function initTheme(){
const saved = localStorage.getItem(STORAGE.THEME);
const prefersLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
const light = saved !== null ? saved === 'light' : false;
document.documentElement.classList.toggle('light', light);
const hljsDark = document.getElementById('hljs-theme-dark');
const hljsLight = document.getElementById('hljs-theme-light');
if (hljsDark) hljsDark.disabled = light;
if (hljsLight) hljsLight.disabled = !light;
const themeToggle = document.getElementById('themeToggle');
if (themeToggle) themeToggle.innerHTML = light
? '<i class="fa-solid fa-sun"></i>' : '<i class="fa-solid fa-moon"></i>';
mermaid.initialize({
startOnLoad: false,
theme: light ? 'default' : 'dark',
securityLevel: 'loose',
flowchart: {
htmlLabels: true
}
});
}
function toggleTheme(){
const isLight = document.documentElement.classList.toggle('light');
localStorage.setItem(STORAGE.THEME, isLight ? 'light' : 'dark');
const hljsDark = document.getElementById('hljs-theme-dark');
const hljsLight = document.getElementById('hljs-theme-light');
if (hljsDark) hljsDark.disabled = isLight;
if (hljsLight) hljsLight.disabled = !isLight;
const themeToggle = document.getElementById('themeToggle');
if (themeToggle) themeToggle.innerHTML = isLight
? '<i class="fa-solid fa-sun"></i>' : '<i class="fa-solid fa-moon"></i>';
mermaid.initialize({
theme: isLight ? 'default' : 'dark',
startOnLoad: false,
securityLevel: 'loose',
flowchart: {
htmlLabels: true
}
});
document.querySelectorAll('pre code').forEach(block => hljs.highlightElement(block));
document.querySelectorAll('.mermaid').forEach(oldMermaidDiv => {
const source = oldMermaidDiv.textContent;
if (source) {
const newMermaidDiv = document.createElement('div');
newMermaidDiv.className = 'mermaid';
newMermaidDiv.textContent = source;
oldMermaidDiv.replaceWith(newMermaidDiv);
mermaid.run({
nodes: [newMermaidDiv]
}).catch(e => {
console.error("Mermaid re-render error on theme change:", e);
newMermaidDiv.textContent = 'Error rendering diagram.';
newMermaidDiv.style.color = 'var(--danger)';
});
}
});
}
function initMarkedHLJS(){
marked.setOptions({
breaks: true,
gfm: true,
headerIds: true,
mangle: false,
sanitize: false, // DOMPurify will handle sanitization
highlight(code, lang){
if (lang && hljs.getLanguage(lang)) {
return hljs.highlight(code, {language: lang}).value;
}
return hljs.highlightAuto(code).value;
}
});
}
function loadChats(){
try{
const raw = localStorage.getItem(STORAGE.CHATS);
if (!raw) return [];
const arr = JSON.parse(raw);
// Filter out old private chats (if they existed in localStorage from previous versions)
// and map to ensure new properties are set
return Array.isArray(arr) ? arr.filter(chat => !chat.isPrivate).map(chat => ({
...chat,
messages: Array.isArray(chat.messages) ? chat.messages.map(msg => ({
    ...msg,
    ts: msg.ts || Date.now(),
    reactions: msg.reactions || {} // Ensure reactions property exists
})) : [],
createdAt: chat.createdAt || Date.now(),
updatedAt: chat.updatedAt || Date.now()
})).sort((a,b) => b.updatedAt - a.updatedAt) : [];
}catch(e){
console.error("Error loading chats:", e);
return [];
}
}
function saveAll(){
localStorage.setItem(STORAGE.CHATS, JSON.stringify(chats));
localStorage.setItem(STORAGE.CURRENT, currentChatId);
// loggedInAdminUsers is saved separately
}
function createChat(){
    const chat = {
        id: 'c_' + Math.random().toString(36).slice(2),
        title: 'New chat',
        messages: [],
        createdAt: Date.now(),
        updatedAt: Date.now()
    };
    chats.unshift(chat);
    currentChatId = chat.id;
    saveAll();
    return chat;
}
function currentChat(){
    if (currentChatId === GLOBAL_CHAT_ID) return { id: GLOBAL_CHAT_ID, title: 'Global Chat', messages: [], isGlobal: true };
    // Find the chat by ID. All non-global chats are personal.
    return chats.find(c=>c.id===currentChatId);
}
function updateChatTitleFromFirstUserMessage(chat){
if (chat.id === GLOBAL_CHAT_ID) return;
const first = chat.messages.find(m=>m.role==='user');
if (first){
const plain = first.content.replace(/\s+/g,' ').trim();
chat.title = (plain || 'New chat').slice(0,60);
}
}
function renderChatList(){
const list = document.getElementById('chatList');
if (!list) return;
list.innerHTML = '';
const globalChatItem = document.createElement('div');
globalChatItem.className = 'chat-item' + (currentChatId === GLOBAL_CHAT_ID ? ' active' : '');
globalChatItem.innerHTML = `
<div class="avatar global"><i class="fa-solid fa-earth-americas"></i></div>
<div style="min-width:0; flex-grow:1;">
<div class="chat-title" title="Global Chat">Global Chat</div>
<div class="chat-meta">Real-time</div>
</div>
`;
globalChatItem.addEventListener('click', ()=>{
if (currentChatId !== GLOBAL_CHAT_ID) {
currentChatId = GLOBAL_CHAT_ID;
saveAll();
renderChatList();
renderCurrentChat();
closeDrawer();
}
});
list.appendChild(globalChatItem);
chats.forEach(chat=>{
    if (chat.isGlobal) return;
    const item = document.createElement('div');
    item.className = 'chat-item'+(chat.id===currentChatId?' active':'');
    
    const avatarContent = 'C';
    
    item.innerHTML = `
        <div class="avatar">${avatarContent}</div>
        <div style="min-width:0; flex-grow:1;">
        <div class="chat-title" title="${escapeHTML(chat.title)}">${escapeHTML(chat.title)}</div>
        <div class="chat-meta">${timeAgo(chat.updatedAt)}</div>
        </div>
        <div style="display:flex; gap:.35rem">
        <button class="icon-btn" title="Rename" data-act="rename"><i class="fa-solid fa-pen"></i></button>
        <button class="icon-btn" title="Delete" data-act="delete"><i class="fa-solid fa-trash"></i></button>
        </div>
    `;
    item.addEventListener('click', (e)=>{
    const act = e.target.closest('button')?.dataset?.act;
    if (act === 'delete'){
    e.stopPropagation();
    if (confirm('Delete this chat?')) {
    const idx = chats.findIndex(c=>c.id===chat.id);
    if (idx>-1) {
    chats.splice(idx,1);
    if (currentChatId === chat.id) {
    currentChatId = chats.length > 0 ? chats[0].id : createChat().id;
    }
    }
    saveAll(); renderChatList(); renderCurrentChat();
    }
    return;
    }
    if (act === 'rename'){
    e.stopPropagation();
    const name = prompt('Rename chat', chat.title);
    if (name && name.trim()){ chat.title = name.trim(); chat.updatedAt = Date.now(); saveAll(); renderChatList(); }
    return;
    }
    if (chat.id!==currentChatId){ currentChatId = chat.id; saveAll(); renderChatList(); renderCurrentChat(); closeDrawer(); }
    });
    list.appendChild(item);
});
}
function renderCurrentChat(){
const chat = currentChat();
const chatTitleEl = document.getElementById('chatTitle');
const messagesWrap = document.getElementById('messages');
const homepage = document.getElementById('homepage');
const chatContainer = document.getElementById('chatContainer');

if (!chatTitleEl || !messagesWrap || !homepage || !chatContainer) return;

if (homepage.classList.contains('active')) {
} else {
chatTitleEl.textContent = chat.title;
messagesWrap.innerHTML = '<div class="lazy-marker" id="lazyMarker">Loading global chat...</div>'; // Always show 'Loading global chat...' initially for global or 'Scroll up' for personal.
// The listener below will replace this for global chat.

if (chat.isGlobal) {
setupGlobalChatListener();
} else {
if (globalChatQueryRef) {
globalChatQueryRef.off();
globalChatQueryRef = null;
}
globalChatRef = null;
const start = Math.max(0, chat.messages.length - PAGE_SIZE);
for (let i=start;i<chat.messages.length;i++){
messagesWrap.appendChild(renderMessage(chat.messages[i]));
}
ensureEnhancements(messagesWrap);
scrollToBottom(true);
updateLazyMarkerVisibility();
}
}
updateStatus();
}
function escapeHTML(s){
return (s??'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}
function processTextForMentionsAndCommands(text) {
let outputText = text;
// Highlight @gpt as a specific entity, even if followed by other characters.
outputText = outputText.replace(/(@gpt)(?=\S*)/gi, '<span class="highlight-gpt">$1</span>');

// Highlight other @mentions, ensuring they are preceded by space or start of string
// and are not part of a @gpt sequence.
// This regex matches `@` followed by any word characters that are NOT 'gpt' at the start of the word,
// ensuring word boundary at the end of the username.
outputText = outputText.replace(/(^|\s)@(?!(gpt)\b)([a-zA-Z0-9_]+)\b/gi, (match, p1, p2, usernameMatch) => {
return `${p1}<span class="highlight-mention">@${usernameMatch}</span>`;
});
return outputText;
}
function renderMessage(msg, isTypingPlaceholder = false){
const el = document.createElement('div');
let messageClasses = (msg.type || msg.role) + (msg.type === 'global' ? ' global' : '');
if (msg.type === 'global' && msg.sender === username && msg.role === 'user') {
messageClasses += ' self';
}
el.className = 'msg ' + messageClasses;
el.id = msg.type === 'global' ? `msg-${msg.id}` : ''; // Global chat messages need unique Firebase ID
// Set chatType data attribute for reaction handling (now simplified to global or personal)
el.dataset.msgId = msg.id;
el.dataset.role = msg.role;
el.dataset.sender = msg.sender;
el.dataset.chatType = msg.type || 'personal'; // If type not set, it's personal.

let avatarChar;
let avatarClickListenerHtml = ''; // Changed from avatarClickHandler to avoid inline onclick
let usernameHtml = '';
if (msg.type === 'global') {
avatarChar = '<i class="fa-solid fa-user"></i>';
if (msg.role === 'assistant') {
    avatarChar = '<i class="fa-solid fa-robot"></i>';
    usernameHtml = `<span class="username">${escapeHTML(msg.sender || 'Anonymous')}</span>`;
}
else {
    // Only allow context menu for global user messages (not self or AI)
    if (msg.sender !== username) { // Don't allow private chat with self
        avatarClickListenerHtml = `data-sender-for-context-menu="${escapeHTML(msg.sender)}"`;
    }
    const senderIsAdmin = msg.sender === ADMIN_USERNAME || msg.sender === NEW_ADMIN_USERNAME; // Check for any admin username
    usernameHtml = `<span class="username">${escapeHTML(msg.sender || 'Anonymous')}${senderIsAdmin && loggedInAdminUsers.has(msg.sender) ? ' <span class="admin-badge">Owner</span>' : ''}</span>`; // Add admin badge here, only if current user IS an admin
}
} else { // Personal chat
avatarChar = msg.role === 'user' ? 'U' : 'G';
}
let initialMdContent = '';
if (isTypingPlaceholder) {
initialMdContent = '<span class="is-typing"><span class="dotty"></span><span class="dotty"></span><span class="dotty"></span></span>';
} else {
const highlightedContent = processTextForMentionsAndCommands(msg.content);
initialMdContent = DOMPurify.sanitize(marked.parse(highlightedContent));
}

let replyQuoteHtml = '';
let toolsButtons = '';

if (msg.type === 'global') {
toolsButtons += `<button class="reply-btn" title="Reply to this message" data-msg-id="${msg.id}"><i class="fa-solid fa-reply"></i></button>`;
}
// Add react button if not AI typing bubble
if (!isTypingPlaceholder) {
    toolsButtons += `<button class="react-btn" title="Add reaction" data-msg-id="${msg.id}"><i class="fa-solid fa-face-smile"></i></button>`;
}

if (msg.replyTo) {
replyQuoteHtml = `<div class="reply-quote" title="Replying to: ${escapeHTML(msg.replyTo.sender || '')}: ${escapeHTML(msg.replyTo.content)}">${escapeHTML(msg.replyTo.sender || 'Anonymous')}: ${escapeHTML(msg.replyTo.content)}</div>`;
}
toolsButtons += `<button class="copy-btn ${isTypingPlaceholder ? 'hidden' : ''}" title="Copy message"><i class="fa-regular fa-copy"></i></button>`;
el.innerHTML = `
<div class="avatar ${msg.type === 'global' ? 'global' : (msg.role === 'user' ? 'user' : 'assistant')}">
    <div ${avatarClickListenerHtml}>${avatarChar}</div>
</div>
<div style="min-width:0">
<div class="bubble">
<div class="tools">
${toolsButtons}
</div>
${usernameHtml}
${replyQuoteHtml}
<div class="md-content">${initialMdContent}</div>
<div class="meta">${formatTime(msg.ts || Date.now())}</div>
${msg.reactions && Object.keys(msg.reactions).length > 0 ? `<div class="reactions-container" data-msg-id="${msg.id}"></div>` : ''}
</div>
</div>
`;
if (!isTypingPlaceholder) {
queueMicrotask(()=>{
// Call the new helper function to attach all message-specific button listeners
attachMessageButtonListeners(el);

if (msg.reactions && Object.keys(msg.reactions).length > 0) {
    renderSpecificMessageReactions(el.dataset.msgId, msg.reactions, el.dataset.chatType);
}
});
}
return el;
}

// New helper function to attach all message-specific button listeners
function attachMessageButtonListeners(messageElement) {
    // Helper to remove existing listeners and re-attach new ones to a cloned element
    const cloneAndReplace = (selector, eventType, handler) => {
        const oldElement = messageElement.querySelector(selector);
        if (oldElement) {
            const newElement = oldElement.cloneNode(true); // Deep clone
            oldElement.parentNode.replaceChild(newElement, oldElement);
            newElement.addEventListener(eventType, handler);
            return newElement;
        }
        return null;
    };

    const messageId = messageElement.dataset.msgId;
    const chatType = messageElement.dataset.chatType;

    // Attach avatar click listener for global chat users (if applicable)
    const avatarContentWrapper = messageElement.querySelector('.avatar > div[data-sender-for-context-menu]');
    if (avatarContentWrapper) {
        const senderForContext = avatarContentWrapper.dataset.senderForContextMenu;
        avatarContentWrapper.style.cursor = 'pointer';
        const newAvatarWrapper = avatarContentWrapper.cloneNode(true);
        avatarContentWrapper.parentNode.replaceChild(newAvatarWrapper, avatarContentWrapper);
        newAvatarWrapper.addEventListener('click', (event) => {
            showUserContextMenu(event, senderForContext);
        });
    }

    // Reply Button (only if it exists for this message type)
    if (messageElement.querySelector('.reply-btn')) {
        cloneAndReplace('.reply-btn', 'click', (event) => {
            event.stopPropagation();
            document.getElementById('input').value = `[REPLY_TO_${messageId}] `;
            document.getElementById('input').focus();
            hideAutocomplete();
        });
    }

    // React Button
    cloneAndReplace('.react-btn', 'click', (event) => {
        showReactionPalette(event, messageId, chatType);
    });

    // Copy Button (direct on bubble)
    cloneAndReplace('.bubble > .tools > .copy-btn', 'click', async () => {
        const mdContentEl = messageElement.querySelector('.md-content');
        if (mdContentEl) {
            const tmp = document.createElement('div');
            tmp.innerHTML = mdContentEl.innerHTML;
            tmp.querySelectorAll('.typing-cursor, .highlight-gpt, .highlight-mention').forEach(n => {
                n.outerHTML = n.textContent;
            });
            const textToCopy = tmp.textContent || '';
            try {
                await navigator.clipboard.writeText(textToCopy);
                toast(messageElement.querySelector('.copy-btn'), 'Copied');
            } catch (e) {
                toast(messageElement.querySelector('.copy-btn'), 'Failed');
            }
        }
    });

    // Copy buttons inside pre blocks (needs re-attachment too)
    messageElement.querySelectorAll('pre').forEach(pre => {
        const codeEl = pre.querySelector('code');
        if (codeEl && !pre.querySelector('.copy-btn.injected')) { // Only inject if not already there
            const copy = document.createElement('button');
            copy.className = 'copy-btn injected';
            copy.innerHTML = '<i class="fa-regular fa-copy"></i>';
            copy.addEventListener('click', async (e) => {
                e.stopPropagation();
                try {
                    await navigator.clipboard.writeText(codeEl.textContent);
                    toast(copy, 'Copied');
                } catch (err) {
                    toast(copy, 'Failed');
                }
            });
            pre.appendChild(copy);
        } else if (codeEl && pre.querySelector('.copy-btn.injected')) { // If already injected, just re-attach listener
             const existingCopyBtn = pre.querySelector('.copy-btn.injected');
             const newCopyBtn = existingCopyBtn.cloneNode(true);
             existingCopyBtn.parentNode.replaceChild(newCopyBtn, existingCopyBtn);
             newCopyBtn.addEventListener('click', async (e) => {
                 e.stopPropagation();
                 try {
                     await navigator.clipboard.writeText(codeEl.textContent);
                     toast(newCopyBtn, 'Copied');
                 } catch (err) {
                     toast(newCopyBtn, 'Failed');
                 }
             });
        }
    });
}


function renderMarkdown(text){
try{
return marked.parse(text || '');
}catch(e){
console.error("Error parsing markdown:", e);
return '<pre><code>'+escapeHTML(text||'')+'</code></pre>';
}
}
function ensureEnhancements(scope){
scope.querySelectorAll('pre code.language-mermaid').forEach(block => {
const parentPre = block.closest('pre');
if (parentPre && !parentPre.dataset.mermaidRendered) {
const mermaidDiv = document.createElement('div');
mermaidDiv.className = 'mermaid';
mermaidDiv.textContent = block.textContent;
parentPre.replaceWith(mermaidDiv);
mermaid.run({ nodes: [mermaidDiv] }).catch(e => {
console.error("Mermaid render error:", e);
newMermaidDiv.textContent = 'Error rendering diagram.';
newMermaidDiv.style.color = 'var(--danger)';
});
parentPre.dataset.mermaidRendered = 'true';
}
});
scope.querySelectorAll('pre code:not(.hljs)').forEach(block => {
if (block.parentNode && block.parentNode.nodeName === 'PRE') {
hljs.highlightElement(block);
attachInlineCodeCopy(block);
}
});
}
function attachCopyButtons(bubbleEl){ // This specifically adds the copy button to a PRE element
    const preElements = bubbleEl.querySelectorAll('pre');
    preElements.forEach(pre => {
        if (!pre || pre.querySelector('.copy-btn.injected')) return; // Prevent double injection
        const codeEl = pre.querySelector('code');
        if (!codeEl) return;

        const copy = document.createElement('button');
        copy.className = 'copy-btn injected';
        copy.innerHTML = '<i class="fa-regular fa-copy"></i>';
        copy.addEventListener('click', async (e)=>{
            e.stopPropagation();
            try{
                await navigator.clipboard.writeText(codeEl.textContent);
                toast(copy,'Copied');
            }catch(err){ toast(copy,'Failed'); }
        });
        pre.appendChild(copy);
    });
}
function attachInlineCodeCopy(codeEl){
const pre = codeEl.closest('pre');
if (!pre || pre.querySelector('.copy-btn.injected')) return;
const copy = document.createElement('button');
copy.className = 'copy-btn injected';
copy.innerHTML = '<i class="fa-regular fa-copy"></i>';
copy.addEventListener('click', async (e)=>{
e.stopPropagation();
try{
await navigator.clipboard.writeText(codeEl.textContent);
toast(copy,'Copied');
}catch(err){ toast(copy,'Failed'); }
});
pre.appendChild(copy);
}
function autosize(){
const input = document.getElementById('input');
if (input) {
input.style.height = 'auto';
input.style.height = Math.min(input.scrollHeight, 200) + 'px';
}
}
function wireUI(){
const input = document.getElementById('input');
const send = document.getElementById('send');
const messages = document.getElementById('messages');
const newChatBtn = document.getElementById('newChatBtn');
const themeToggle = document.getElementById('themeToggle');
const tutorialBtn = document.getElementById('tutorialBtn');
const drawerOpen = document.getElementById('drawerOpen');
const drawerClose = document.getElementById('drawerClose');
const sidebarOverlay = document.getElementById('sidebarOverlay');
const autocompleteList = document.getElementById('autocompleteSuggestions');

const homepage = document.getElementById('homepage');
const chatContainer = document.getElementById('chatContainer');
const userContextMenu = document.getElementById('userContextMenu');
const privateChatOption = document.getElementById('privateChatOption');
const reactionPalette = document.getElementById('reactionPalette');


if (input) {
input.addEventListener('input', autosize);
autosize();
input.addEventListener('input', (e) => {
autosize();
if (currentChatId !== GLOBAL_CHAT_ID) {
hideAutocomplete();
return;
}
const cursorPosition = input.selectionStart;
const textBeforeCursor = input.value.substring(0, cursorPosition);
const atIndex = textBeforeCursor.lastIndexOf('@');
if (atIndex !== -1 && (cursorPosition - atIndex > 0) && (textBeforeCursor.charAt(atIndex - 1) === ' ' || atIndex === 0)) {
const partialMention = textBeforeCursor.substring(atIndex + 1);
showAutocomplete(partialMention);
} else {
hideAutocomplete();
}
});
input.addEventListener('keydown', (e) => {
if (autocompleteList.style.display === 'block') {
if (e.key === 'ArrowDown') {
e.preventDefault();
autocompleteSelectedIndex = (autocompleteSelectedIndex + 1) % autocompleteSuggestions.length;
updateAutocompleteSelection();
} else if (e.key === 'ArrowUp') {
e.preventDefault();
autocompleteSelectedIndex = (autocompleteSelectedIndex - 1 + autocompleteSuggestions.length) % autocompleteSuggestions.length;
updateAutocompleteSelection();
} else if (e.key === 'Enter') {
if (autocompleteSelectedIndex !== -1) {
e.preventDefault();
selectAutocompleteSuggestion(autocompleteSelectedIndex);
}
} else if (e.key === 'Escape') {
hideAutocomplete();
}
} else if (e.key === 'Enter' && !e.shiftKey) {
e.preventDefault();
send.click();
}
});
document.addEventListener('click', (e) => {
if (!input.contains(e.target) && !autocompleteList.contains(e.target)) {
hideAutocomplete();
}
hideUserContextMenu();
hideReactionPalette();
});
}
if (send) {
send.addEventListener('click', ()=>{
const text = input.value.trim();
if (!text) return;
if (text.length > MAX_INPUT_CHARS) {
toast(send, `Message too long (${text.length}/${MAX_INPUT_CHARS})`);
return;
}
if (isSendingMessage) { // New check to prevent double-sends during processing
    toast(send, "Please wait, message is sending.");
    return;
}
if (isStreaming) { // Still keep this for AI streaming status
    toast(send, "Assistant is typing, please wait.");
    return;
}

isSendingMessage = true; // Set flag at the start of sending process
send.classList.add('sending'); // Add visual cue
send.style.pointerEvents = 'none'; // Debounce the button

/*if (currentChatId === GLOBAL_CHAT_ID) {
sendToGlobalChat(text);
} else {
pushUserMessage(text);
// Wait for UI update and scroll before initiating AI stream
requestAnimationFrame(() => {
    requestAnimationFrame(() => {
        streamAssistant().catch(console.error);
    });
});
}
input.focus(); // Keep input focused after sending
hideAutocomplete();*/

if (currentChatId === GLOBAL_CHAT_ID) {
    sendToGlobalChat(text);
} else {
    pushUserMessage(text);

    // === CLEAR INPUT AFTER local push (non-global chat) ===
    const inputEl = document.getElementById('input');
    if (inputEl) {
        inputEl.value = '';
        autosize();
    }

    // Wait for UI update and scroll before initiating AI stream
    requestAnimationFrame(() => {
        requestAnimationFrame(() => {
            streamAssistant().catch(console.error);
        });
    });
}
input.focus(); // Keep input focused after sending (will focus the now-empty input)
hideAutocomplete();
    
});
}
if (newChatBtn) newChatBtn.addEventListener('click', ()=>{
createChat(); renderChatList(); renderCurrentChat();
closeDrawer();
});
if (themeToggle) themeToggle.addEventListener('click', toggleTheme);
if (tutorialBtn) tutorialBtn.addEventListener('click', () => {
if (homepage.classList.contains('active')) {
showPage('chat');
} else {
showPage('home');
}
});
if (drawerOpen) drawerOpen.addEventListener('click', openDrawer);
if (drawerClose) drawerClose.addEventListener('click', closeDrawer);
if (sidebarOverlay) sidebarOverlay.addEventListener('click', closeDrawer);
if (messages) {
messages.addEventListener('scroll', ()=>{
const nearBottom = messages.scrollHeight - messages.scrollTop - messages.clientHeight < 16;
atBottom = nearBottom;
if (messages.scrollTop <= 0 && currentChatId !== GLOBAL_CHAT_ID) {
loadOlderMessages();
}
}, {passive:true});
}
window.addEventListener('resize', ()=> {
const messagesEl = document.getElementById('messages');
if (messagesEl && atBottom) scrollToBottom();
});
if (input) {
input.addEventListener('paste', (e)=>{
e.preventDefault();
const text = (e.clipboardData || window.clipboardData).getData('text/plain');
const pasteText = text.slice(0, MAX_INPUT_CHARS - input.value.length);
document.execCommand('insertText', false, pasteText);
autosize();
});
}

const userContextMenuEl = document.getElementById('userContextMenu');
if (userContextMenuEl) {
    userContextMenuEl.addEventListener('click', (e) => {
        e.stopPropagation();
    });
}
privateChatOption.addEventListener('click', (e) => {
    // This functionality is now handled externally, e.g., via private.html
    // This button should ideally be removed or lead to a prompt to open private.html
    alert("For full version stay tunned: https://discord.gg/yv6EBexQVt");
    hideUserContextMenu();
});

document.addEventListener('click', (event) => {
    if (!event.target.closest('#reactionPalette button') && !event.target.closest('.react-btn')) {
        hideReactionPalette();
    }
    if (!event.target.closest('#userContextMenu') && !event.target.closest('.avatar > div[data-sender-for-context-menu]')) {
        hideUserContextMenu();
    }
});
}
function showUserContextMenu(event, otherUsername) {
    event.stopPropagation();
    const contextMenu = document.getElementById('userContextMenu');
    const privateChatOption = document.getElementById('privateChatOption');

    if (otherUsername === 'GPT-4 Turbo') {
        privateChatOption.textContent = "Cannot private chat with AI";
        privateChatOption.disabled = true;
        privateChatOption.style.cursor = 'not-allowed';
    } else {
        privateChatOption.textContent = `Start Private Chat with ${otherUsername}`;
        privateChatOption.dataset.otherUsername = otherUsername;
        privateChatOption.disabled = false;
        privateChatOption.style.cursor = 'pointer';
    }
    
    contextMenu.style.display = 'block';
    const clickX = event.clientX;
    const clickY = event.clientY;

    const viewportWidth = window.innerWidth || document.documentElement.clientWidth;
    const viewportHeight = window.innerHeight || document.documentElement.clientHeight;

    let menuX = clickX;
    let menuY = clickY;

    if (clickX + contextMenu.offsetWidth > viewportWidth) {
        menuX = viewportWidth - contextMenu.offsetWidth - 10;
    }
    if (clickY + contextMenu.offsetHeight > viewportHeight) {
        menuY = viewportHeight - contextMenu.offsetHeight - 10;
    }

    contextMenu.style.left = `${menuX}px`;
    contextMenu.style.top = `${menuY}px`;
}

function hideUserContextMenu() {
    const contextMenu = document.getElementById('userContextMenu');
    if (contextMenu) {
        contextMenu.style.display = 'none';
    }
}

function showReactionPalette(event, messageId, chatType) {
    event.stopPropagation();
    const palette = document.getElementById('reactionPalette');
    palette.innerHTML = '';

    DEFAULT_REACTIONS.forEach(emoji => {
        const button = document.createElement('button');
        button.textContent = emoji;
        button.addEventListener('click', () => addReaction(messageId, emoji, chatType));
        palette.appendChild(button);
    });

    palette.style.display = 'flex';
    const rect = event.currentTarget.getBoundingClientRect();
    
    let paletteX = rect.left;
    let paletteY = rect.top - palette.offsetHeight - 10;

    const viewportWidth = window.innerWidth || document.documentElement.clientWidth;
    if (paletteX + palette.offsetWidth > viewportWidth) {
        paletteX = viewportWidth - palette.offsetWidth - 10;
    }
    if (paletteX < 10) {
        paletteX = 10;
    }

    if (paletteY < 0) {
        paletteY = rect.bottom + 10;
    }


    palette.style.left = `${paletteX}px`;
    palette.style.top = `${paletteY}px`;
}

function hideReactionPalette() {
    const palette = document.getElementById('reactionPalette');
    if (palette) {
        palette.style.display = 'none';
    }
}

function addReaction(messageId, emoji, chatType) {
    const isGlobal = chatType === 'global';
    let messageToUpdate;

    if (isGlobal) {
        const msgRef = firebase.database().ref(`global_chat/${messageId}`);
        msgRef.transaction(currentData => {
            if (currentData) {
                if (!currentData.reactions) {
                    currentData.reactions = {};
                }
                if (!currentData.reactions[emoji]) {
                    currentData.reactions[emoji] = { count: 0, users: {} };
                }

                if (currentData.reactions[emoji].users && currentData.reactions[emoji].users[username]) {
                    currentData.reactions[emoji].count--;
                    delete currentData.reactions[emoji].users[username];
                    if (currentData.reactions[emoji].count === 0) {
                        delete currentData.reactions[emoji];
                    }
                } else {
                    currentData.reactions[emoji].count++;
                    if (!currentData.reactions[emoji].users) {
                        currentData.reactions[emoji].users = {};
                    }
                    currentData.reactions[emoji].users[username] = true;
                }
            }
            return currentData;
        }, (error, committed, snapshot) => {
            if (error) {
                console.error("Firebase reaction transaction failed: ", error);
            } else if (committed) {
                console.log("Reaction updated in Firebase.");
            }
        });

    } else {
        const chat = currentChat();
        if (!chat) return;

        messageToUpdate = chat.messages.find(m => m.id === messageId);
        if (messageToUpdate) {
            if (!messageToUpdate.reactions) {
                messageToUpdate.reactions = {};
            }
            if (!messageToUpdate.reactions[emoji]) {
                messageToUpdate.reactions[emoji] = { count: 0, users: {} };
            }

            if (messageToUpdate.reactions[emoji].users && messageToUpdate.reactions[emoji].users[username]) {
                messageToUpdate.reactions[emoji].count--;
                delete messageToUpdate.reactions[emoji].users[username];
                if (messageToUpdate.reactions[emoji].count === 0) {
                    delete messageToUpdate.reactions[emoji];
                }
            } else {
                messageToUpdate.reactions[emoji].count++;
                if (!messageToUpdate.reactions[emoji].users) {
                    messageToUpdate.reactions[emoji].users = {};
                }
                messageToUpdate.reactions[emoji].users[username] = true;
            }
            saveAll();
            renderSpecificMessageReactions(messageId, messageToUpdate.reactions, chatType);
        }
    }
    hideReactionPalette();
}

function renderSpecificMessageReactions(messageId, reactionsData, chatType) {
    const messageElement = document.getElementById(`msg-${messageId}`);
    if (!messageElement) return;

    let reactionsContainer = messageElement.querySelector('.reactions-container');
    if (!reactionsContainer) {
        reactionsContainer = document.createElement('div');
        reactionsContainer.className = 'reactions-container';
        messageElement.querySelector('.bubble').appendChild(reactionsContainer);
    }
    reactionsContainer.innerHTML = '';

    for (const emoji in reactionsData) {
        const reaction = reactionsData[emoji];
        if (reaction.count > 0) {
            const badge = document.createElement('span');
            badge.className = 'reaction-badge';
            if (reaction.users && reaction.users[username]) {
                badge.classList.add('reacted-by-me');
            }
            badge.textContent = `${emoji} ${reaction.count}`;
            badge.addEventListener('click', (e) => {
                e.stopPropagation();
                addReaction(messageId, emoji, chatType);
            });
            reactionsContainer.appendChild(badge);
        }
    }

    if (Object.keys(reactionsData).length === 0) {
        if (reactionsContainer.parentNode) {
            reactionsContainer.remove();
        }
    }
}


function initializeFirebase() {
if (!firebaseAppInitialized) { // Check firebaseAppInitialized flag to prevent re-initialization
    if (FIREBASE_CONFIG.apiKey && FIREBASE_CONFIG.databaseURL && FIREBASE_CONFIG.apiKey !== "YOUR_FIREBASE_API_KEY") {
        firebase.initializeApp(FIREBASE_CONFIG);
        firebaseAppInitialized = true;
        console.log("Firebase initialized successfully.");
    } else {
        console.warn("Firebase config is missing or using default placeholders. Global chat features will be disabled.");
    }
}
}
function setupGlobalChatListener() {
if (!firebaseAppInitialized) {
const messagesWrap = document.getElementById('messages');
if(messagesWrap) messagesWrap.innerHTML = `<div class="lazy-marker" id="lazyMarker" style="color:var(--danger)">Firebase not configured. Global chat is disabled.</div>`;
return;
}
const messagesWrap = document.getElementById('messages');
messagesWrap.innerHTML = '<div class="lazy-marker" id="lazyMarker">Loading global chat...</div>';
if (globalChatQueryRef) {
globalChatQueryRef.off();
}
globalChatRef = firebase.database().ref('global_chat');
globalChatQueryRef = firebase.database().ref('global_chat').limitToLast(PAGE_SIZE * 2);
globalChatQueryRef.on('child_added', (snapshot) => {
const msg = snapshot.val();
msg.id = snapshot.key;
if (msg.sender && msg.type === 'global') {
recentActiveUsers.add(msg.sender);
}

let messageElementInDom = document.getElementById(`msg-${msg.id}`);

if (messageElementInDom) {
    // If message already exists, update its content (e.g., initial empty AI msg being filled)
    const mdContentEl = messageElementInDom.querySelector('.md-content');
    if (mdContentEl) {
        const currentDisplayedContent = mdContentEl.textContent.trim();
        const incomingContent = (msg.content || '').trim();

        if (currentDisplayedContent !== incomingContent || (msg.role === 'assistant' && currentDisplayedContent === '')) {
            const processedContent = processTextForMentionsAndCommands(msg.content);
            mdContentEl.innerHTML = DOMPurify.sanitize(marked.parse(processedContent)); // Sanitize incoming content
            ensureEnhancements(mdContentEl); 
            const copyBtn = messageElementInDom.querySelector('.copy-btn');
            if (copyBtn) copyBtn.classList.remove('hidden');
        }
        attachMessageButtonListeners(messageElementInDom);
    }
} else {
    // Render new message
    const newEl = renderMessage(msg);
    messagesWrap.appendChild(newEl);
    ensureEnhancements(newEl);
}

renderSpecificMessageReactions(msg.id, msg.reactions || {}, 'global');

scrollToBottom();
updateLazyMarkerVisibility();
});

globalChatQueryRef.on('child_changed', (snapshot) => {
    const msg = snapshot.val();
    msg.id = snapshot.key;
    const messageElementInDom = document.getElementById(`msg-${msg.id}`);
    if (messageElementInDom) {
        const currentDisplayedContent = messageElementInDom.querySelector('.md-content').textContent.trim();
        const incomingContent = (msg.content || '').trim();

        if (currentDisplayedContent !== incomingContent) {
            const mdContentEl = messageElementInDom.querySelector('.md-content');
            if (mdContentEl) {
                const processedContent = processTextForMentionsAndCommands(msg.content);
                mdContentEl.innerHTML = DOMPurify.sanitize(marked.parse(processedContent)); // Sanitize updated content
                ensureEnhancements(mdContentEl);
                attachMessageButtonListeners(messageElementInDom);
                const copyBtn = messageElementInDom.querySelector('.copy-btn');
                if (copyBtn) copyBtn.classList.remove('hidden');
            }
        }
    }
    renderSpecificMessageReactions(msg.id, msg.reactions || {}, 'global');
    scrollToBottom();
});

}



// Use word boundaries for the entire matched pattern
function applyProfanityFilter(text) {


const PROFANITY_LIST = [
  "2 girls 1 cup",
  "2g1c",
  "4r5e",
  "5h1t",
  "5hit",
  "5ht",
  "@$$",
  "a s s",
  "a s shole",
  "a55",
  "a55hole",
  "a_s_s",
  "abbo",
  "abeed",
  "abuse",
  "acrotomophilia",
  "africoon",
  "ahole",
  "alabama hot pocket",
  "alaskan pipeline",
  "alligator bait",
  "alligatorbait",
  "amcik",
  "anal",
  "analannie",
  "analprobe",
  "analsex",
  "andskota",
  "anilingus",
  "anus",
  "apeshit",
  "ar5e",
  "arabush",
  "arabushs",
  "areola",
  "areole",
  "argie",
  "armo",
  "armos",
  "arrse",
  "arschloch",
  "arse",
  "arsehole",
  "aryan",
  "ash0le",
  "ash0les",
  "asholes",
  "ass monkey",
  "ass",
  "ass-fucker",
  "ass-hat",
  "ass-pirate",
  "assbag",
  "assbagger",
  "assbandit",
  "assbang",
  "assbanged",
  "assbanger",
  "assbangs",
  "assbite",
  "assblaster",
  "assclown",
  "asscock",
  "asscowboy",
  "asscracker",
  "asses",
  "assface",
  "assfuck",
  "assfucker",
  "assfukka",
  "assgoblin",
  "assh0le",
  "assh0lez",
  "asshat",
  "asshead",
  "assho1e",
  "asshole",
  "assholes",
  "assholz",
  "asshopper",
  "asshore",
  "assjacker",
  "assjockey",
  "asskiss",
  "asskisser",
  "assklown",
  "asslick",
  "asslicker",
  "asslover",
  "assman",
  "assmaster",
  "assmonkey",
  "assmunch",
  "assmuncher",
  "assnigger",
  "asspacker",
  "asspirate",
  "asspuppies",
  "assrammer",
  "assranger",
  "assshit",
  "assshole",
  "asssucker",
  "asswad",
  "asswhole",
  "asswhore",
  "asswipe",
  "asswipes",
  "auto erotic",
  "autoerotic",
  "ayir",
  "azazel",
  "azz",
  "azzhole",
  "b a s t a r d",
  "b i t c h",
  "b o o b",
  "b!+ch",
  "b!tch",
  "b!tchin",
  "b*tch",
  "b00b",
  "b00bies",
  "b00biez",
  "b00bs",
  "b00bz",
  "b17ch",
  "b1tch",
  "b7ch",
  "babeland",
  "babes",
  "baby batter",
  "baby juice",
  "backdoorman",
  "badfuck",
  "ball gag",
  "ball gravy",
  "ball kicking",
  "ball licking",
  "ball sack",
  "ball sucking",
  "ballbag",
  "balllicker",
  "ballsack",
  "bampot",
  "bangbro",
  "bangbros",
  "bangbus",
  "bareback",
  "barely legal",
  "barelylegal",
  "barenaked",
  "barface",
  "barfface",
  "bassterd",
  "bassterds",
  "bastard",
  "bastardo",
  "bastards",
  "bastardz",
  "basterds",
  "basterdz",
  "bastinado",
  "bazongas",
  "bazooms",
  "bbw",
  "bdsm",
  "beaner",
  "beaners",
  "beaney",
  "beaneys",
  "beardedclam",
  "beastality",
  "beastial",
  "beastiality",
  "beastility",
  "beatch",
  "beatoff",
  "beatyourmeat",
  "beaver cleaver",
  "beaver lips",
  "beef curtains",
  "beeyotch",
  "bellend",
  "beotch",
  "bestial",
  "bestiality",
  "bi curious",
  "bi+ch",
  "bi7ch",
  "biatch",
  "bicurious",
  "big black",
  "big breasts",
  "big knockers",
  "big tits",
  "bigass",
  "bigbastard",
  "bigbreasts",
  "bigbutt",
  "bigtits",
  "bimbo",
  "bimbos",
  "bint",
  "birdlock",
  "bitch",
  "bitchass",
  "bitched",
  "bitcher",
  "bitchers",
  "bitches",
  "bitchez",
  "bitchin",
  "bitching",
  "bitchslap",
  "bitchtit",
  "bitchy",
  "biteme",
  "bitties",
  "black cock",
  "blackcock",
  "blackman",
  "blacks",
  "blonde action",
  "blonde on blonde action",
  "blonde on blonde",
  "bloodclaat",
  "blow j",
  "blow job",
  "blow your l",
  "blow your load",
  "blowjob",
  "blowjobs",
  "blue waffle",
  "bluegum",
  "bluegums",
  "blumpkin",
  "bo ob",
  "bo obs",
  "boang",
  "boche",
  "boches",
  "boffing",
  "bogan",
  "bohunk",
  "boink",
  "boiolas",
  "bollick",
  "bollock",
  "bollocks",
  "bollok",
  "bollox",
  "bombers",
  "bomd",
  "bondage",
  "boned",
  "boner",
  "boners",
  "bong",
  "boong",
  "boonga",
  "boongas",
  "boongs",
  "boonie",
  "boonies",
  "booobs",
  "boooobs",
  "booooobs",
  "booooooobs",
  "bootee",
  "bootlip",
  "bootlips",
  "boozer",
  "bosch",
  "bosche",
  "bosches",
  "boschs",
  "bosomy",
  "bounty bar",
  "bounty bars",
  "bountybar",
  "brea5t",
  "breastjob",
  "breastlover",
  "breastman",
  "brown shower",
  "brown showers",
  "brunette action",
  "btch",
  "buceta",
  "buddhahead",
  "buddhaheads",
  "buffies",
  "bugger",
  "buggered",
  "buggery",
  "bukake",
  "bukkake",
  "bullcrap",
  "bulldike",
  "bulldyke",
  "bullet vibe",
  "bullshit",
  "bullshits",
  "bullshitted",
  "bullturds",
  "bumblefuck",
  "bumfuck",
  "bung hole",
  "bung",
  "bunga",
  "bungas",
  "bunghole",
  "bunny fucker",
  "burr head",
  "burr heads",
  "burrhead",
  "burrheads",
  "butchbabes",
  "butchdike",
  "butchdyke",
  "butt plug",
  "butt-pirate",
  "buttbang",
  "buttcheeks",
  "buttface",
  "buttfuck",
  "buttfucker",
  "buttfuckers",
  "butthead",
  "butthole",
  "buttman",
  "buttmuch",
  "buttmunch",
  "buttmuncher",
  "buttpirate",
  "buttplug",
  "buttstain",
  "buttwipe",
  "byatch",
  "c u n t",
  "c-0-c-k",
  "c-o-c-k",
  "c-u-n-t",
  "c.0.c.k",
  "c.o.c.k.",
  "c.u.n.t",
  "c0ck",
  "c0cks",
  "c0cksucker",
  "c0k",
  "cabron",
  "caca",
  "cacker",
  "cahone",
  "camel jockey",
  "camel jockeys",
  "camel toe",
  "cameljockey",
  "cameltoe",
  "camgirl",
  "camslut",
  "camwhore",
  "carpet muncher",
  "carpetmuncher",
  "carruth",
  "cawk",
  "cawks",
  "cazzo",
  "chav",
  "cheese eating surrender monkey",
  "cheese eating surrender monkies",
  "cheeseeating surrender monkey",
  "cheeseeating surrender monkies",
  "cheesehead",
  "cheeseheads",
  "cherrypopper",
  "chickslick",
  "china swede",
  "china swedes",
  "chinaman",
  "chinamen",
  "chinaswede",
  "chinaswedes",
  "chinc",
  "chincs",
  "ching chong",
  "ching chongs",
  "chinga",
  "chingchong",
  "chingchongs",
  "chink",
  "chinks",
  "chinky",
  "choad",
  "chocolate rosebuds",
  "chode",
  "chodes",
  "chonkies",
  "chonky",
  "chonkys",
  "chraa",
  "christ killer",
  "christ killers",
  "chug",
  "chugs",
  "chuj",
  "chunger",
  "chungers",
  "chunkies",
  "chunkys",
  "cipa",
  "circlejerk",
  "cl1t",
  "clamdigger",
  "clamdiver",
  "clamps",
  "clansman",
  "clansmen",
  "clanswoman",
  "clanswomen",
  "cleveland steamer",
  "clit",
  "clitface",
  "clitfuck",
  "clitoris",
  "clitorus",
  "clits",
  "clitty",
  "clogwog",
  "clover clamps",
  "clusterfuck",
  "cnts",
  "cntz",
  "cnut",
  "cocain",
  "cocaine",
  "cock",
  "cock-head",
  "cock-sucker",
  "cockbite",
  "cockblock",
  "cockblocker",
  "cockburger",
  "cockcowboy",
  "cockface",
  "cockfight",
  "cockfucker",
  "cockhead",
  "cockholster",
  "cockjockey",
  "cockknob",
  "cockknocker",
  "cockknoker",
  "cocklicker",
  "cocklover",
  "cockmaster",
  "cockmongler",
  "cockmongruel",
  "cockmonkey",
  "cockmunch",
  "cockmuncher",
  "cocknob",
  "cocknose",
  "cocknugget",
  "cockqueen",
  "cockrider",
  "cocks",
  "cockshit",
  "cocksman",
  "cocksmith",
  "cocksmoker",
  "cocksucer",
  "cocksuck",
  "cocksucked",
  "cocksucker",
  "cocksucking",
  "cocksucks",
  "cocksuka",
  "cocksukka",
  "cocktease",
  "cocky",
  "cohee",
  "coital",
  "coitus",
  "cok",
  "cokmuncher",
  "coksucka",
  "condom",
  "coochie",
  "coochy",
  "coolie",
  "coolies",
  "cooly",
  "coon ass",
  "coon asses",
  "coonass",
  "coonasses",
  "coondog",
  "coons",
  "cooter",
  "coprolagnia",
  "coprophilia",
  "copulate",
  "corksucker",
  "cornhole",
  "cra5h",
  "crackcocain",
  "crackpipe",
  "crackwhore",
  "crap",
  "crapola",
  "crapper",
  "crappy",
  "creampie",
  "crotchjockey",
  "crotchmonkey",
  "crotchrot",
  "cuck",
  "cum face",
  "cum licker",
  "cum",
  "cumbubble",
  "cumdumpster",
  "cumfest",
  "cumguzzler",
  "cuming",
  "cumjockey",
  "cumlickr",
  "cumm",
  "cummer",
  "cummin",
  "cumming",
  "cumquat",
  "cumqueen",
  "cums",
  "cumshot",
  "cumshots",
  "cumslut",
  "cumstain",
  "cumsucker",
  "cumtart",
  "cunilingus",
  "cunillingus",
  "cunn",
  "cunnie",
  "cunnilingus",
  "cunntt",
  "cunny",
  "cunt",
  "cunteyed",
  "cuntface",
  "cuntfuck",
  "cuntfucker",
  "cunthole",
  "cunthunter",
  "cuntlick",
  "cuntlicker",
  "cuntlicking",
  "cuntrag",
  "cunts",
  "cuntslut",
  "cuntsucker",
  "cuntz",
  "curry muncher",
  "curry munchers",
  "currymuncher",
  "currymunchers",
  "cushi",
  "cushis",
  "cyalis",
  "cyberfuc",
  "cyberfuck",
  "cyberfucked",
  "cyberfucker",
  "cyberfuckers",
  "cyberfucking",
  "cybersex",
  "cyberslimer",
  "d0ng",
  "d0uch3",
  "d0uche",
  "d1ck",
  "d1ld0",
  "d1ldo",
  "d4mn",
  "dago",
  "dagos",
  "dahmer",
  "damm",
  "dammit",
  "damn",
  "damnit",
  "darkey",
  "darkeys",
  "darkie",
  "darkies",
  "darky",
  "date rape",
  "daterape",
  "datnigga",
  "dawgie style",
  "dawgie-style",
  "daygo",
  "deapthroat",
  "deep throat",
  "deep throating",
  "deepaction",
  "deepthroat",
  "deepthroating",
  "defecate",
  "deggo",
  "dego",
  "degos",
  "dendrophilia",
  "destroyyourpussy",
  "deth",
  "diaper daddy",
  "diaper head",
  "diaper heads",
  "diaperdaddy",
  "diaperhead",
  "diaperheads",
  "dick pic",
  "dick",
  "dick-ish",
  "dickbag",
  "dickbeater",
  "dickbeaters",
  "dickbrain",
  "dickdipper",
  "dickface",
  "dickflipper",
  "dickforbrains",
  "dickfuck",
  "dickhead",
  "dickheads",
  "dickhole",
  "dickish",
  "dickjuice",
  "dickless",
  "dicklick",
  "dicklicker",
  "dickman",
  "dickmilk",
  "dickmonger",
  "dickpic",
  "dickripper",
  "dicks",
  "dicksipper",
  "dickslap",
  "dickslicker",
  "dicksucker",
  "dickwad",
  "dickweasel",
  "dickweed",
  "dickwhipper",
  "dickwod",
  "dickzipper",
  "diddle",
  "dike",
  "dild0",
  "dild0s",
  "dildo",
  "dildos",
  "dilf",
  "diligaf",
  "dilld0",
  "dilld0s",
  "dillweed",
  "dimwit",
  "dingle",
  "dingleberries",
  "dingleberry",
  "dink",
  "dinks",
  "dipship",
  "dipshit",
  "dipstick",
  "dirsa",
  "dirty pillows",
  "dirty sanchez",
  "dix",
  "dixiedike",
  "dixiedyke",
  "dlck",
  "dog style",
  "dog-fucker",
  "doggie style",
  "doggie",
  "doggie-style",
  "doggiestyle",
  "doggin",
  "dogging",
  "doggy style",
  "doggy-style",
  "doggystyle",
  "dolcett",
  "dominatricks",
  "dominatrics",
  "dominatrix",
  "dommes",
  "dong",
  "donkey punch",
  "donkeypunch",
  "donkeyribber",
  "doochbag",
  "doodoo",
  "doofus",
  "dookie",
  "doosh",
  "dot head",
  "dot heads",
  "dothead",
  "dotheads",
  "double dong",
  "double penetration",
  "doubledong",
  "doublepenetration",
  "douch3",
  "douche bag",
  "douche",
  "douche-fag",
  "douchebag",
  "douchebags",
  "douchewaffle",
  "douchey",
  "dp action",
  "dpaction",
  "dragqueen",
  "dragqween",
  "dripdick",
  "dry hump",
  "dryhump",
  "duche",
  "dudette",
  "dumass",
  "dumb ass",
  "dumbass",
  "dumbasses",
  "dumbbitch",
  "dumbfuck",
  "dumbshit",
  "dumshit",
  "dune coon",
  "dune coons",
  "dupa",
  "dvda",
  "dyefly",
  "dyke",
  "dykes",
  "dziwka",
  "earotics",
  "easyslut",
  "eat my ass",
  "eat my",
  "eatadick",
  "eatballs",
  "eathairpie",
  "eatme",
  "eatmyass",
  "eatpussy",
  "ecchi",
  "ejackulate",
  "ejakulate",
  "ekrem",
  "ekto",
  "enculer",
  "enema",
  "erection",
  "ero",
  "erotic",
  "erotism",
  "esqua",
  "essohbee",
  "ethical slut",
  "evl",
  "excrement",
  "exkwew",
  "extacy",
  "extasy",
  "f u c k e r",
  "f u c k e",
  "f u c k",
  "f u k",
  "f*ck",
  "f-u-c-k",
  "f.u.c.k",
  "f4nny",
  "f_u_c_k",
  "facefucker",
  "fack",
  "faeces",
  "faen",
  "fag",
  "fag1t",
  "fagbag",
  "faget",
  "fagfucker",
  "fagg",
  "fagg1t",
  "fagged",
  "fagging",
  "faggit",
  "faggitt",
  "faggot",
  "faggotcock",
  "faggs",
  "fagit",
  "fagot",
  "fagots",
  "fags",
  "fagt",
  "fagtard",
  "fagz",
  "faig",
  "faigs",
  "faigt",
  "fanculo",
  "fannybandit",
  "fannyflaps",
  "fannyfucker",
  "fanyy",
  "fartknocker",
  "fastfuck",
  "fatah",
  "fatfuck",
  "fatfucker",
  "faso",
  "fck",
  "fckcum",
  "fckd",
  "fcuk",
  "fcuker",
  "fcuking",
  "fecal",
  "feck",
  "fecker",
  "feg",
  "felatio",
  "felch",
  "felcher",
  "felching",
  "fellate",
  "fellatio",
  "feltch",
  "feltcher",
  "feltching",
  "female squirting",
  "femalesquirtin",
  "femalesquirting",
  "femdom",
  "fetish",
  "ficken",
  "figging",
  "fingerbang",
  "fingerfood",
  "fingerfuck",
  "fingerfucked",
  "fingerfucker",
  "fingerfuckers",
  "fingerfucking",
  "fingerfucks",
  "fingering",
  "fisted",
  "fister",
  "fistfuck",
  "fistfucked",
  "fistfucker",
  "fistfuckers",
  "fistfucking",
  "fistfuckings",
  "fistfucks",
  "fisting",
  "fisty",
  "fitt",
  "flamer",
  "flasher",
  "flikker",
  "flipping the bird",
  "flogthelog",
  "floo",
  "floozy",
  "flydie",
  "flydye",
  "foad",
  "fok",
  "fondle",
  "foobar",
  "fook",
  "fooker",
  "foot fetish",
  "footaction",
  "footfetish",
  "footfuck",
  "footfucker",
  "footjob",
  "footlicker",
  "footstar",
  "foreskin",
  "forni",
  "fornicate",
  "fotze",
  "foursome",
  "fourtwenty",
  "freakfuck",
  "freakyfucker",
  "freefuck",
  "freex",
  "frigg",
  "frigga",
  "frigger",
  "frotting",
  "fucck",
  "fuck",
  "fuck-tard",
  "fucka",
  "fuckable",
  "fuckass",
  "fuckbag",
  "fuckbitch",
  "fuckbook",
  "fuckboy",
  "fuckbrain",
  "fuckbuddy",
  "fuckbutt",
  "fuckd",
  "fucked",
  "fuckedup",
  "fucker",
  "fuckers",
  "fuckersucker",
  "fuckface",
  "fuckfest",
  "fuckfreak",
  "fuckfriend",
  "fuckhead",
  "fuckheads",
  "fuckher",
  "fuckhole",
  "fuckin",
  "fuckina",
  "fucking",
  "fuckingbitch",
  "fuckings",
  "fuckingshitmotherfucker",
  "fuckinnuts",
  "fuckinright",
  "fuckit",
  "fuckknob",
  "fuckme",
  "fuckmeat",
  "fuckmehard",
  "fuckmonkey",
  "fuckn",
  "fucknugget",
  "fucknut",
  "fucknuts",
  "fucknutt",
  "fucknutz",
  "fuckoff",
  "fuckpig",
  "fuckpuppet",
  "fuckr",
  "fucks",
  "fuckstick",
  "fucktard",
  "fucktards",
  "fucktoy",
  "fucktrophy",
  "fuckup",
  "fuckwad",
  "fuckwhit",
  "fuckwhore",
  "fuckwit",
  "fuckwitt",
  "fuckyomama",
  "fuckyou",
  "fudge packer",
  "fudgepacker",
  "fugly",
  "fuk",
  "fukah",
  "fuken",
  "fuker",
  "fukin",
  "fuking",
  "fukk",
  "fukkah",
  "fukken",
  "fukker",
  "fukkin",
  "fukking",
  "fuks",
  "fuktard",
  "fuktards",
  "fukwhit",
  "fukwit",
  "funfuck",
  "futanari",
  "futanary",
  "futkretzn",
  "fuuck",
  "fux",
  "fux0r",
  "fuxor",
  "fvck",
  "fvk",
  "fxck",
  "g-spot",
  "g00k",
  "gae",
  "gai",
  "gang bang",
  "gangbang",
  "gangbanged",
  "gangbanger",
  "gangbangs",
  "ganja",
  "gassyass",
  "gator bait",
  "gatorbait",
  "gay sex",
  "gayass",
  "gaybob",
  "gayboy",
  "gaydo",
  "gaygirl",
  "gaylord",
  "gaymuthafuckinwhore",
  "gays",
  "gaysex",
  "gaytard",
  "gaywad",
  "gayz",
  "geezer",
  "geni",
  "genital",
  "genitals",
  "getiton",
  "gey",
  "gfy",
  "ghay",
  "ghey",
  "giant cock",
  "gigolo",
  "ginzo",
  "ginzos",
  "gipp",
  "gippo",
  "gippos",
  "gipps",
  "girl on top",
  "girl on",
  "girls gone wild",
  "givehead",
  "glans",
  "glazeddonut",
  "goatcx",
  "goatse",
  "god dammit",
  "god damn",
  "god damnit",
  "god-dam",
  "god-damned",
  "godam",
  "godammit",
  "godamn",
  "godamnit",
  "goddam",
  "goddamit",
  "goddamm",
  "goddammit",
  "goddamn",
  "goddamned",
  "goddamnes",
  "goddamnit",
  "goddamnmuthafucker",
  "godsdamn",
  "gokkun",
  "golden shower",
  "goldenshower",
  "golliwog",
  "golliwogs",
  "gonad",
  "gonads",
  "gonorrehea",
  "gonzagas",
  "goo girl",
  "gooch",
  "goodpoop",
  "gook eye",
  "gook eyes",
  "gook",
  "gookeye",
  "gookeyes",
  "gookies",
  "gooks",
  "gooky",
  "gora",
  "goras",
  "goregasm",
  "gotohell",
  "goy",
  "goyim",
  "greaseball",
  "greaseballs",
  "groe",
  "groid",
  "groids",
  "grope",
  "grostulation",
  "group sex",
  "gspot",
  "gstring",
  "gtfo",
  "gub",
  "gubba",
  "gubbas",
  "gubs",
  "guido",
  "guiena",
  "guineas",
  "guizi",
  "gummer",
  "guro",
  "gwailo",
  "gwailos",
  "gweilo",
  "gweilos",
  "gyopo",
  "gyopos",
  "gyp",
  "gyped",
  "gypo",
  "gypos",
  "gypp",
  "gypped",
  "gyppie",
  "gyppies",
  "gyppo",
  "gyppos",
  "gyppy",
  "gyppys",
  "gypsys",
  "h e l l",
  "h o m",
  "h00r",
  "h0ar",
  "h0m0",
  "h0mo",
  "h0r",
  "h0re",
  "h4x0r",
  "hadji",
  "hadjis",
  "hairyback",
  "hairybacks",
  "haji",
  "hajis",
  "hajji",
  "hajjis",
  "half breed",
  "half caste",
  "halfbreed",
  "halfcaste",
  "hamas",
  "hamflap",
  "hand job",
  "handjob",
  "haole",
  "haoles",
  "hapa",
  "hard core",
  "hardcore",
  "hardcoresex",
  "hardon",
  "he11",
  "headfuck",
  "hebe",
  "hebes",
  "heeb",
  "heebs",
  "hells",
  "helvete",
  "hentai",
  "heroin",
  "herp",
  "herpes",
  "herpy",
  "heshe",
  "hijacking",
  "hillbillies",
  "hillbilly",
  "hindoo",
  "hiscock",
  "hitler",
  "hitlerism",
  "hitlerist",
  "hoare",
  "hobag",
  "hodgie",
  "hoer",
  "hoes",
  "holestuffer",
  "hom0",
  "homo",
  "homobangers",
  "homodumbshit",
  "homoey",
  "honger",
  "honkers",
  "honkey",
  "honkeys",
  "honkie",
  "honkies",
  "honky",
  "hooch",
  "hooker",
  "hookers",
  "hoor",
  "hoore",
  "hootch",
  "hooter",
  "hooters",
  "hore",
  "hori",
  "horis",
  "hork",
  "horndawg",
  "horndog",
  "horney",
  "horniest",
  "horny",
  "horseshit",
  "hosejob",
  "hoser",
  "hot carl",
  "hot chick",
  "hotcarl",
  "hotdamn",
  "hotpussy",
  "hotsex",
  "hottotrot",
  "how to kill",
  "how to murder",
  "howtokill",
  "howtomurdep",
  "huevon",
  "huge fat",
  "hugefat",
  "hui",
  "hummer",
  "humped",
  "humper",
  "humpher",
  "humphim",
  "humpin",
  "humping",
  "hussy",
  "hustler",
  "hymen",
  "hymie",
  "hymies",
  "iblowu",
  "ike",
  "ikes",
  "ikey",
  "ikeymo",
  "ikeymos",
  "ikwe",
  "illegals",
  "incest",
  "indon",
  "indons",
  "injun",
  "injuns",
  "insest",
  "intercourse",
  "intheass",
  "inthebuff",
  "israels",
  "j3rk0ff",
  "jack off",
  "jack-off",
  "jackass",
  "jackhole",
  "jackoff",
  "jackshit",
  "jacktheripper",
  "jail bait",
  "jailbait",
  "jap",
  "japcrap",
  "japie",
  "japies",
  "japs",
  "jebus",
  "jelly donut",
  "jerk off",
  "jerk-off",
  "jerk0ff",
  "jerked",
  "jerkoff",
  "jerries",
  "jerry",
  "jewboy",
  "jewed",
  "jewess",
  "jiga",
  "jigaboo",
  "jigaboos",
  "jigarooni",
  "jigaroonis",
  "jigg",
  "jigga",
  "jiggabo",
  "jiggaboo",
  "jiggabos",
  "jiggas",
  "jigger",
  "jiggerboo",
  "jiggers",
  "jiggs",
  "jiggy",
  "jigs",
  "jihad",
  "jijjiboo",
  "jijjiboos",
  "jimfish",
  "jisim",
  "jism",
  "jiss",
  "jiz",
  "jizim",
  "jizin",
  "jizjuice",
  "jizm",
  "jizn",
  "jizz",
  "jizzd",
  "jizzed",
  "jizzim",
  "jizzin",
  "jizzn",
  "jizzum",
  "jugg",
  "juggs",
  "jungle bunnies",
  "jungle bunny",
  "junglebunny",
  "junkie",
  "junky",
  "kacap",
  "kacapas",
  "kacaps",
  "kaffer",
  "kaffir",
  "kaffre",
  "kafir",
  "kanake",
  "kanker",
  "katsap",
  "katsaps",
  "kawk",
  "khokhol",
  "khokhols",
  "kigger",
  "kike",
  "kikes",
  "kimchis",
  "kinbaku",
  "kink",
  "kinkster",
  "kinky",
  "kinkyjesus",
  "kissass",
  "kiunt",
  "kkk",
  "klan",
  "klansman",
  "klansmen",
  "klanswoman",
  "klanswomen",
  "klootzak",
  "knobbing",
  "knobead",
  "knobed",
  "knobend",
  "knobhead",
  "knobjocky",
  "knobjokey",
  "knobz",
  "knockers",
  "knulle",
  "kock",
  "kondum",
  "kondums",
  "kooch",
  "kooches",
  "koon",
  "kootch",
  "krap",
  "krappy",
  "kraut",
  "krauts",
  "kuffar",
  "kuk",
  "kuksuger",
  "kum",
  "kumbubble",
  "kumbullbe",
  "kumer",
  "kummer",
  "kumming",
  "kums",
  "kunilingus",
  "kunnilingus",
  "kunt",
  "kunts",
  "kuntz",
  "kurac",
  "kurwa",
  "kushi",
  "kushis",
  "kusi",
  "kwa",
  "kwai lo",
  "kwai los",
  "kwif",
  "kyke",
  "kykes",
  "kyopo",
  "kyopos",
  "kyrpa",
  "l3i+ch",
  "l3i\\+ch",
  "l3itch",
  "labia",
  "lapdance",
  "leather restraint",
  "leather straight",
  "leatherrestraint",
  "lebos",
  "lech",
  "lemon party",
  "lemonparty",
  "leper",
  "lesbain",
  "lesbayn",
  "lesbin",
  "lesbo",
  "lesbos",
  "lez",
  "lezbe",
  "lezbefriends",
  "lezbian",
  "lezbians",
  "lezbo",
  "lezbos",
  "lezz",
  "lezzian",
  "lezzie",
  "lezzies",
  "lezzo",
  "lezzy",
  "libido",
  "licker",
  "licking",
  "lickme",
  "lilniglet",
  "limey",
  "limpdick",
  "limy",
  "lingerie",
  "lipshits",
  "lipshitz",
  "livesex",
  "loadedgun",
  "lolita",
  "lovebone",
  "lovegoo",
  "lovegun",
  "lovejuice",
  "lovemuscle",
  "lovepistol",
  "loverocket",
  "lowlife",
  "lsd",
  "lubejob",
  "lubra",
  "lucifer",
  "luckycammeltoe",
  "lugan",
  "lugans",
  "lusting",
  "lusty",
  "lynch",
  "m-fucking",
  "m0f0",
  "m0fo",
  "m45terbate",
  "ma5terb8",
  "ma5terbate",
  "mabuno",
  "mabunos",
  "macaca",
  "macacas",
  "mafugly",
  "magicwand",
  "mahbuno",
  "mahbunos",
  "make me come",
  "makemecome",
  "makemecum",
  "male squirting",
  "mamhoon",
  "mams",
  "manhater",
  "manpaste",
  "maricon",
  "maric√≥n",
  "marijuana",
  "masochist",
  "masokist",
  "massa",
  "massterbait",
  "masstrbait",
  "masstrbate",
  "mastabate",
  "mastabater",
  "master-bate",
  "masterb8",
  "masterbaiter",
  "masterbat",
  "masterbat3",
  "masterbate",
  "masterbates",
  "masterbating",
  "masterbation",
  "masterbations",
  "masterblaster",
  "mastrabator",
  "masturbat",
  "masturbate",
  "masturbating",
  "masturbation",
  "mattressprincess",
  "mau mau",
  "mau maus",
  "maumau",
  "maumaus",
  "mcfagget",
  "meatbeatter",
  "meatrack",
  "menage",
  "merd",
  "mgger",
  "mggor",
  "mibun",
  "mick",
  "mickeyfinn",
  "mideast",
  "mierda",
  "milf",
  "mindfuck",
  "minge",
  "minger",
  "mo-fo",
  "mockey",
  "mockie",
  "mocky",
  "mof0",
  "mofo",
  "moky",
  "molest",
  "molestation",
  "molester",
  "molestor",
  "moneyshot",
  "mong",
  "monkleigh",
  "moolie",
  "moon cricket",
  "moon crickets",
  "mooncricket",
  "mooncrickets",
  "moron",
  "moskal",
  "moskals",
  "moslem",
  "mosshead",
  "motha fucker",
  "motha fuker",
  "motha fukkah",
  "motha fukker",
  "mothafuck",
  "mothafucka",
  "mothafuckas",
  "mothafuckaz",
  "mothafucked",
  "mothafucker",
  "mothafuckers",
  "mothafuckin",
  "mothafucking",
  "mothafuckings",
  "mothafucks",
  "mother fucker",
  "mother fukah",
  "mother fuker",
  "mother fukkah",
  "mother fukker",
  "mother-fucker",
  "motherfuck",
  "motherfucka",
  "motherfucked",
  "motherfucker",
  "motherfuckers",
  "motherfuckin",
  "motherfucking",
  "motherfuckings",
  "motherfuckka",
  "motherfucks",
  "motherfvcker",
  "motherlovebone",
  "mothrfucker",
  "mouliewop",
  "mound of venus",
  "moundofvenus",
  "mr hands",
  "mrhands",
  "mtherfucker",
  "mthrfuck",
  "mthrfucker",
  "mthrfucking",
  "mtrfck",
  "mtrfuck",
  "mtrfucker",
  "muff diver",
  "muff",
  "muffdive",
  "muffdiver",
  "muffdiving",
  "muffindiver",
  "mufflikcer",
  "muffpuff",
  "muie",
  "mulatto",
  "mulkku",
  "muncher",
  "munging",
  "munt",
  "munter",
  "muschi",
  "mutha fucker",
  "mutha fukah",
  "mutha fuker",
  "mutha fukkah",
  "mutha fukker",
  "muthafecker",
  "muthafuckaz",
  "muthafucker",
  "muthafuckker",
  "muther",
  "mutherfucker",
  "mutherfucking",
  "muthrfucking",
  "mzungu",
  "mzungus",
  "n1gga",
  "n1gger",
  "n1gr",
  "nads",
  "naked",
  "nambla",
  "nastt",
  "nastybitch",
  "nastyho",
  "nastyslut",
  "nastywhore",
  "nawashi",
  "nazi",
  "nazis",
  "nazism",
  "necro",
  "needthedick",
  "negres",
  "negress",
  "negro",
  "negroes",
  "negroid",
  "negros",
  "neonazi",
  "nepesaurio",
  "nig nog",
  "nig",
  "niga",
  "nigar",
  "nigars",
  "nigas",
  "nigers",
  "nigette",
  "nigettes",
  "nigg",
  "nigg3r",
  "nigg4h",
  "nigga",
  "niggah",
  "niggahs",
  "niggar",
  "niggaracci",
  "niggard",
  "niggarded",
  "niggarding",
  "niggardliness",
  "niggardlinesss",
  "niggardly",
  "niggards",
  "niggars",
  "niggas",
  "niggaz",
  "nigger",
  "niggerhead",
  "niggerhole",
  "niggers",
  "niggle",
  "niggled",
  "niggles",
  "nigglings",
  "niggor",
  "niggress",
  "niggresses",
  "nigguh",
  "nigguhs",
  "niggur",
  "niggurs",
  "niglet",
  "nignog",
  "nigor",
  "nigors",
  "nigr",
  "nigra",
  "nigras",
  "nigre",
  "nigres",
  "nigress",
  "nigs",
  "nigur",
  "niiger",
  "niigr",
  "nimphomania",
  "nimrod",
  "ninny",
  "nipple",
  "nipplering",
  "nipples",
  "nips",
  "nittit",
  "nlgger",
  "nlggor",
  "nob jokey",
  "nob",
  "nobhead",
  "nobjocky",
  "nobjokey",
  "nofuckingway",
  "nog",
  "nookey",
  "nookie",
  "nooky",
  "noonan",
  "nooner",
  "nsfw images",
  "nsfw",
  "nudger",
  "nudie",
  "nudies",
  "numbnuts",
  "nut sack",
  "nutbutter",
  "nutfucker",
  "nutsack",
  "nutten",
  "nympho",
  "nymphomania",
  "o c k",
  "octopussy",
  "omorashi",
  "one cup two girls",
  "one guy one jar",
  "one guy",
  "one jar",
  "ontherag",
  "orafis",
  "orga",
  "orgasim",
  "orgasim;",
  "orgasims",
  "orgasm",
  "orgasmic",
  "orgasms",
  "orgasum",
  "orgies",
  "orgy",
  "oriface",
  "orifiss",
  "orospu",
  "osama",
  "ovum",
  "ovums",
  "p e n i s",
  "p i s",
  "p u s s y",
  "p.u.s.s.y.",
  "p0rn",
  "packi",
  "packie",
  "packy",
  "paddy",
  "paedophile",
  "paki",
  "pakie",
  "pakis",
  "paky",
  "palesimian",
  "pancake face",
  "pancake faces",
  "panooch",
  "pansies",
  "pansy",
  "panti",
  "pantie",
  "panties",
  "panty",
  "paska",
  "payo",
  "pcp",
  "pearlnecklace",
  "pecker",
  "peckerhead",
  "peckerwood",
  "pedo",
  "pedobear",
  "pedophile",
  "pedophilia",
  "pedophiliac",
  "peeenus",
  "peeenusss",
  "peehole",
  "peenus",
  "peepee",
  "peepshow",
  "peepshpw",
  "pegging",
  "peinus",
  "pen1s",
  "penas",
  "pendejo",
  "pendy",
  "penetrate",
  "penetration",
  "peni5",
  "penial",
  "penile",
  "penis",
  "penis-breath",
  "penises",
  "penisfucker",
  "penisland",
  "penislick",
  "penislicker",
  "penispuffer",
  "penthouse",
  "penus",
  "penuus",
  "perse",
  "perv",
  "perversion",
  "peyote",
  "phalli",
  "phallic",
  "phone sex",
  "phonesex",
  "phuc",
  "phuck",
  "phuk",
  "phuked",
  "phuker",
  "phuking",
  "phukked",
  "phukker",
  "phukking",
  "phuks",
  "phungky",
  "phuq",
  "pi55",
  "picaninny",
  "piccaninny",
  "picka",
  "pickaninnies",
  "pickaninny",
  "piece of shit",
  "pieceofshit",
  "piefke",
  "piefkes",
  "pierdol",
  "pigfucker",
  "piker",
  "pikey",
  "piky",
  "pillowbiter",
  "pillu",
  "pimmel",
  "pimp",
  "pimped",
  "pimper",
  "pimpis",
  "pimpjuic",
  "pimpjuice",
  "pimpsimp",
  "pindick",
  "pinko",
  "pis",
  "pises",
  "pisin",
  "pising",
  "pisof",
  "piss pig",
  "piss",
  "piss-off",
  "pissed",
  "pisser",
  "pissers",
  "pisses",
  "pissflap",
  "pissflaps",
  "pisshead",
  "pissin",
  "pissing",
  "pissoff",
  "pisspig",
  "pizda",
  "playboy",
  "playgirl",
  "pleasure chest",
  "pleasurechest",
  "pocha",
  "pochas",
  "pocho",
  "pochos",
  "pocketpool",
  "pohm",
  "pohms",
  "polac",
  "polack",
  "polacks",
  "polak",
  "pole smoker",
  "polesmoker",
  "pollock",
  "pollocks",
  "pommie grant",
  "pommie grants",
  "pommy",
  "ponyplay",
  "poof",
  "poon",
  "poonani",
  "poonany",
  "poontang",
  "poontsee",
  "poop chute",
  "poopchute",
  "pooper",
  "pooperscooper",
  "pooping",
  "poorwhitetrash",
  "popimp",
  "porch monkey",
  "porch monkies",
  "porchmonkey",
  "porn",
  "pornflick",
  "pornking",
  "porno",
  "pornography",
  "pornos",
  "pornprincess",
  "pound town",
  "poundtown",
  "pplicker",
  "pr0n",
  "pr1c",
  "pr1ck",
  "pr1k",
  "prairie nigger",
  "prairie niggers",
  "preteen",
  "pric",
  "prickhead",
  "pricks",
  "prig",
  "prince albert piercing",
  "pron",
  "pthc",
  "pu55i",
  "pu55y",
  "pube",
  "pubes",
  "pubic",
  "pubiclice",
  "pubis",
  "pudboy",
  "pudd",
  "puddboy",
  "pula",
  "punani",
  "punanny",
  "punany",
  "punkass",
  "punky",
  "punta",
  "puntang",
  "purinapricness",
  "pusies",
  "puss",
  "pusse",
  "pussee",
  "pussi",
  "pussie",
  "pussies",
  "pussy",
  "pussycat",
  "pussydestroyer",
  "pussyeater",
  "pussyfart",
  "pussyfuck",
  "pussyfucker",
  "pussylicker",
  "pussylicking",
  "pussylips",
  "pussylover",
  "pussypalace",
  "pussypounder",
  "pussys",
  "pusy",
  "puta",
  "puto",
  "puuke",
  "puuker",
  "qahbeh",
  "quashie",
  "queaf",
  "queef",
  "queerhole",
  "queero",
  "queers",
  "queerz",
  "quickie",
  "quicky",
  "quiff",
  "quim",
  "qweers",
  "qweerz",
  "qweir",
  "r-tard",
  "r-tards",
  "r5e",
  "ra8s",
  "raghead",
  "ragheads",
  "rape",
  "raped",
  "raper",
  "raping",
  "rapist",
  "rautenberg",
  "rearend",
  "rearentry",
  "recktum",
  "rectal",
  "rectum",
  "rectus",
  "redleg",
  "redlegs",
  "redlight",
  "redskin",
  "redskins",
  "reefer",
  "reestie",
  "reetard",
  "reich",
  "renob",
  "rentafuck",
  "rere",
  "retard",
  "retarded",
  "retards",
  "retardz",
  "reverse cowgirl",
  "reversecowgirl",
  "rimjaw",
  "rimjob",
  "rimming",
  "ritard",
  "rosebuds",
  "rosy palm and her 5 sisters",
  "rosy palm",
  "rosypalm",
  "rosypalmandher5sisters",
  "rosypalmmandherefivesisters",
  "round eyes",
  "roundeye",
  "rtard",
  "rtards",
  "rumprammer",
  "ruski",
  "russki",
  "russkie",
  "rusty trombone",
  "rustytrombone",
  "s h i t",
  "s hit",
  "s&m",
  "s-h-1-t",
  "s-h-i-t",
  "s-o-b",
  "s.h.i.t.",
  "s.o.b.",
  "s0b",
  "s_h_i_t",
  "sadis",
  "sadism",
  "sadist",
  "sadom",
  "sambo",
  "sambos",
  "samckdaddy",
  "sanchez",
  "sand nigger",
  "sand niggers",
  "sandm",
  "sandnigger",
  "santorum",
  "sausagequeen",
  "scag",
  "scallywag",
  "scank",
  "scantily",
  "scat",
  "schaffer",
  "scheiss",
  "schizo",
  "schlampe",
  "schlong",
  "schmuck",
  "schvartse",
  "schvartsen",
  "schwartze",
  "schwartzen",
  "scissoring",
  "screwyou",
  "scroat",
  "scrog",
  "scrote",
  "scrotum",
  "scrud",
  "seduce",
  "semen",
  "seppo",
  "seppos",
  "septics",
  "sex",
  "sexcam",
  "sexed",
  "sexfarm",
  "sexhound",
  "sexhouse",
  "sexi",
  "sexing",
  "sexkitten",
  "sexo",
  "sexpot",
  "sexslave",
  "sextogo",
  "sextoy",
  "sextoys",
  "sexual",
  "sexually",
  "sexwhore",
  "sexx",
  "sexxi",
  "sexxx",
  "sexxxi",
  "sexxxy",
  "sexxy",
  "sexy",
  "sexymoma",
  "sexyslim",
  "sh!+",
  "sh!t",
  "sh1t",
  "sh1ter",
  "sh1ts",
  "sh1tter",
  "sh1tz",
  "shag",
  "shagger",
  "shaggin",
  "shagging",
  "shamedame",
  "sharmuta",
  "sharmute",
  "shat",
  "shav",
  "shaved beaver",
  "shaved pussy",
  "shavedbeaver",
  "shavedpussy",
  "shawtypimp",
  "sheeney",
  "shemale",
  "shhit",
  "shi+",
  "shibari",
  "shibary",
  "shinola",
  "shipal",
  "shit ass",
  "shit",
  "shit-ass",
  "shit-bag",
  "shit-bagger",
  "shit-brain",
  "shit-breath",
  "shit-cunt",
  "shit-dick",
  "shit-eating",
  "shit-face",
  "shit-faced",
  "shit-fit",
  "shit-head",
  "shit-heel",
  "shit-hole",
  "shit-house",
  "shit-load",
  "shit-pot",
  "shit-spitter",
  "shit-stain",
  "shitass",
  "shitbag",
  "shitbagger",
  "shitblimp",
  "shitbrain",
  "shitbreath",
  "shitcan",
  "shitcunt",
  "shitdick",
  "shite",
  "shiteater",
  "shiteating",
  "shited",
  "shitey",
  "shitface",
  "shitfaced",
  "shitfit",
  "shitforbrains",
  "shitfuck",
  "shitfucker",
  "shitfull",
  "shithapens",
  "shithappens",
  "shithead",
  "shitheel",
  "shithole",
  "shithouse",
  "shiting",
  "shitings",
  "shitlist",
  "shitload",
  "shitola",
  "shitoutofluck",
  "shitpot",
  "shits",
  "shitspitter",
  "shitstain",
  "shitt",
  "shitted",
  "shitter",
  "shitters",
  "shittiest",
  "shitting",
  "shittings",
  "shitty",
  "shity",
  "shitz",
  "shiz",
  "shiznit",
  "shortfuck",
  "shota",
  "shylock",
  "shylocks",
  "shyt",
  "shyte",
  "shytty",
  "shyty",
  "simp",
  "sissy",
  "sixsixsix",
  "sixtynine",
  "sixtyniner",
  "skag",
  "skanck",
  "skank",
  "skankbitch",
  "skankee",
  "skankey",
  "skankfuck",
  "skanks",
  "skankwhore",
  "skanky",
  "skankybitch",
  "skankywhore",
  "skeet",
  "skinflute",
  "skribz",
  "skullfuck",
  "skum",
  "skumbag",
  "skurwysyn",
  "skwa",
  "skwe",
  "slag",
  "slanteye",
  "slanty",
  "slapper",
  "sleezeball",
  "slideitin",
  "slimeball",
  "slimebucket",
  "slopehead",
  "slopeheads",
  "sloper",
  "slopers",
  "slopey",
  "slopeys",
  "slopies",
  "slopy",
  "slut",
  "slutbag",
  "slutbucket",
  "slutdumper",
  "slutkiss",
  "sluts",
  "slutt",
  "slutting",
  "slutty",
  "slutwear",
  "slutwhore",
  "slutz",
  "smackthemonkey",
  "smeg",
  "smegma",
  "smut",
  "smutty",
  "snatchpatch",
  "sniggered",
  "sniggering",
  "sniggers",
  "snowback",
  "snowballing",
  "snownigger",
  "snuff",
  "socksucker",
  "sodom",
  "sodomise",
  "sodomite",
  "sodomize",
  "sodomy",
  "son of a bitch",
  "son of a whore",
  "son-of-a-bitch",
  "son-of-a-whore",
  "sonofabitch",
  "sonofbitch",
  "sooties",
  "souse",
  "soused",
  "soyboy",
  "spac",
  "spaghettibender",
  "spaghettinigger",
  "spank",
  "spankthemonkey",
  "spastic",
  "spearchucker",
  "spearchuckers",
  "sperm",
  "spermacide",
  "spermbag",
  "spermhearder",
  "spermherder",
  "sphencter",
  "spic",
  "spick",
  "spicks",
  "spics",
  "spierdalaj",
  "spig",
  "spigotty",
  "spik",
  "spiks",
  "splittail",
  "splooge",
  "spludge",
  "spooge",
  "spread legs",
  "spreadeagle",
  "spunk",
  "spunky",
  "sqeh",
  "squa",
  "squarehead",
  "squareheads",
  "squaw",
  "squinty",
  "squirting",
  "stagg",
  "stfu",
  "stiffy",
  "stoned",
  "stoner",
  "strap on",
  "strapon",
  "strappado",
  "strip club",
  "stripclub",
  "stroking",
  "stuinties",
  "stupidfuck",
  "stupidfucker",
  "style doggy",
  "suckdick",
  "sucked",
  "sucker",
  "sucking",
  "suckme",
  "suckmyass",
  "suckmydick",
  "suckmytit",
  "suckoff",
  "suicide girl",
  "suicide girls",
  "suicidegirl",
  "suicidegirls",
  "suka",
  "sultrywoman",
  "sultrywomen",
  "sumofabiatch",
  "swallower",
  "swalow",
  "swamp guinea",
  "swamp guineas",
  "swastika",
  "syphilis",
  "t i t",
  "t i ts",
  "t1t",
  "t1tt1e5",
  "t1tties",
  "tacohead",
  "tacoheads",
  "taff",
  "take off your",
  "tar babies",
  "tar baby",
  "tarbaby",
  "tard",
  "taste my",
  "tastemy",
  "tawdry",
  "tea bagging",
  "teabagging",
  "teat",
  "teets",
  "teez",
  "terd",
  "teste",
  "testee",
  "testes",
  "testical",
  "testicle",
  "testicles",
  "testis",
  "thicklip",
  "thicklips",
  "thirdeye",
  "thirdleg",
  "threesome",
  "threeway",
  "throating",
  "thumbzilla",
  "thundercunt",
  "tied up",
  "tig ol bitties",
  "tig old bitties",
  "tight white",
  "timber nigger",
  "timber niggers",
  "timbernigger",
  "tit",
  "titbitnipply",
  "titfuck",
  "titfucker",
  "titfuckin",
  "titi",
  "titjob",
  "titlicker",
  "titlover",
  "tits",
  "titt",
  "tittie",
  "tittie5",
  "tittiefucker",
  "titties",
  "tittis",
  "titty",
  "tittyfuck",
  "tittyfucker",
  "tittys",
  "tittywank",
  "titwank",
  "tity",
  "to murder",
  "tongethruster",
  "tongue in a",
  "tongueina",
  "tonguethrust",
  "tonguetramp",
  "toots",
  "topless",
  "tortur",
  "torture",
  "tosser",
  "towel head",
  "towel heads",
  "towelhead",
  "trailertrash",
  "trannie",
  "tranny",
  "transsexual",
  "transvestite",
  "tribadism",
  "trisexual",
  "trois",
  "trots",
  "tub girl",
  "tubgirl",
  "tuckahoe",
  "tunneloflove",
  "turd burgler",
  "turnon",
  "tush",
  "tushy",
  "tw4t",
  "twat",
  "twathead",
  "twatlips",
  "twats",
  "twatty",
  "twatwaffle",
  "twink",
  "twinkie",
  "two girls one cup",
  "twobitwhore",
  "twunt",
  "twunter",
  "udge packer",
  "ukrop",
  "unclefucker",
  "unfuckable",
  "upskirt",
  "uptheass",
  "upthebutt",
  "urethra play",
  "urethraplay",
  "urophilia",
  "usama",
  "ussys",
  "uzi",
  "v a g i n a",
  "v14gra",
  "v1gra",
  "v4gra",
  "va-j-j",
  "va1jina",
  "vag",
  "vag1na",
  "vagiina",
  "vaj1na",
  "vajina",
  "valium",
  "venus mound",
  "vgra",
  "vibr",
  "vibrater",
  "vibrator",
  "vigra",
  "violet wand",
  "virginbreaker",
  "vittu",
  "vixen",
  "vjayjay",
  "vorarephilia",
  "voyeurweb",
  "voyuer",
  "vullva",
  "vulva",
  "w00se",
  "w0p",
  "wab",
  "wang",
  "wank",
  "wanker",
  "wanking",
  "wanky",
  "waysted",
  "wazoo",
  "weenie",
  "weewee",
  "weiner",
  "welcher",
  "wench",
  "wet dream",
  "wetb",
  "wetback",
  "wetbacks",
  "wetdream",
  "wetspot",
  "wh00r",
  "wh0re",
  "wh0reface",
  "whacker",
  "whash",
  "whigger",
  "whiggers",
  "whiskeydick",
  "whiskydick",
  "whit",
  "white power",
  "white trash",
  "whitenigger",
  "whitepower",
  "whitetrash",
  "whitey",
  "whiteys",
  "whities",
  "whoar",
  "whop",
  "whoralicious",
  "whore",
  "whorealicious",
  "whorebag",
  "whored",
  "whoreface",
  "whorefucker",
  "whorehopper",
  "whorehouse",
  "whores",
  "whoring",
  "wichser",
  "wigga",
  "wiggas",
  "wigger",
  "wiggers",
  "willie",
  "willies",
  "williewanker",
  "willy",
  "wog",
  "wogs",
  "woose",
  "wop",
  "worldsex",
  "wrapping men",
  "wrinkled starfish",
  "wtf",
  "wuss",
  "wuzzie",
  "x-rated",
  "x-rated2g1c",
  "xkwe",
  "xrated",
  "xtc",
  "xx",
  "xxx",
  "xxxxxx",
  "yank",
  "yaoi",
  "yarpie",
  "yarpies",
  "yed",
  "yellow showers",
  "yellowman",
  "yellowshowers",
  "yid",
  "yids",
  "yiffy",
  "yobbo",
  "yourboobs",
  "yourpenis",
  "yourtits",
  "yury",
  "zabourah",
  "zigabo",
  "zigabos",
  "zipperhead",
  "zipperheads",
  "zoophile",
  "zoophilia",
  "üñï"
];




const profanityPatternParts = PROFANITY_LIST.map(word => {
    let pattern = '';
    for (let i = 0; i < word.length; i++) {
        const char = word[i];
        let charPattern;
        // Allow common leetspeak substitutions
        if (char.toLowerCase() === 'a') charPattern = '[aA4@]';
        else if (char.toLowerCase() === 'e') charPattern = '[eE3]';
        else if (char.toLowerCase() === 'i') charPattern = '[iI1!]';
        else if (char.toLowerCase() === 'o') charPattern = '[oO0]';
        else if (char.toLowerCase() === 's') charPattern = '[sS$]';
        else if (char.toLowerCase() === 't') charPattern = '[tT+]';
        // Match the character itself (case-insensitive)
        else charPattern = `[${char}${char.toUpperCase()}]`;
        
        pattern += charPattern;
        // Allow zero or more non-alphanumeric characters (including spaces, punctuation, underscores) between letters
        if (i < word.length - 1) {
            pattern += '[^a-zA-Z0-9]*';
        }
    }
    return pattern;
});
const PROFANITY_REGEX = new RegExp(`\\b(?:${profanityPatternParts.join('|')})\\b`, 'gi');


return text.replace(PROFANITY_REGEX, match => {
// Clean the matched string to count only alphanumeric characters for asterisk replacement
const cleanMatch = match.replace(/[^a-zA-Z0-9]/g, '');
// Replace with HTML entity for asterisk to avoid Markdown interpretation
return '&#42;'.repeat(cleanMatch.length);
});
}
async function sendToGlobalChat(text) {
if (!firebaseAppInitialized || !globalChatRef) {
alert("Global chat is not ready. Please wait a moment or check Firebase configuration.");
console.error("Global chat reference not initialized for sending message:", globalChatRef);
isSendingMessage = false; // Reset send state
document.getElementById('send').classList.remove('sending');
document.getElementById('send').style.pointerEvents = 'auto';
return;
}
const inputEl = document.getElementById('input');
inputEl.value = '';
autosize();
const lowerText = text.toLowerCase();
// Basic client-side XSS check for user inputs
if (lowerText.includes('<script') || lowerText.includes('onerror') || lowerText.includes('javascript:')) {
alert("XSS attempt detected! Please do not inject malicious code. Your message will not be sent.");
isSendingMessage = false; // Reset send state
document.getElementById('send').classList.remove('sending');
document.getElementById('send').style.pointerEvents = 'auto';
return;
}
let replyToMessage = null;
let originalMessageContent = text;
const replyMatch = text.match(/^\[REPLY_TO_([a-zA-Z0-9_-]+)\]\s*(.*)/i);
if (replyMatch) {
const repliedToId = replyMatch[1];
originalMessageContent = (replyMatch[2] || '').trim();
const repliedEl = document.getElementById('msg-'+repliedToId);
if (repliedEl) {
const repliedRole = repliedEl.dataset.role;
const repliedSender = repliedEl.dataset.sender;
const repliedContentEl = repliedEl.querySelector('.md-content');
if (repliedContentEl && repliedRole && repliedSender) {
replyToMessage = {
id: repliedToId,
content: repliedContentEl.textContent.trim().slice(0, 100),
sender: repliedSender
};
} else {
console.warn("Could not retrieve full replied-to message data from DOM for ID:", repliedToId);
}
} else {
console.warn("Could not find replied-to message in DOM for ID:", repliedToId);
}
}
const filteredContent = applyProfanityFilter(originalMessageContent);
const msgData = {
sender: username,
content: filteredContent,
ts: firebase.database.ServerValue.TIMESTAMP,
role: 'user',
type: 'global'
};
// Add replyTo to message data if it exists
if (replyToMessage) {
msgData.replyTo = replyToMessage;
}
// Push the user's message to Firebase. The Firebase listener will handle displaying it.
const newMessageRef = globalChatRef.push(msgData);
const messageId = newMessageRef.key;

// Trigger AI if conditions are met
if ((replyToMessage && replyToMessage.sender === 'GPT-4 Turbo') || originalMessageContent.toLowerCase().includes('@gpt')) {
let promptContentForAI = originalMessageContent;
if (replyToMessage && replyToMessage.sender === 'GPT-4 Turbo') {
promptContentForAI = `In response to "${replyToMessage.sender}: ${replyToMessage.content}", the user asks: "${originalMessageContent}".`;
}
// AI streaming is now handled immediately after user message is pushed
streamAssistantToGlobalChat(promptContentForAI, messageId);
} else {
    // If no AI response is triggered, we need to reset the sending state here.
    isSendingMessage = false;
    document.getElementById('send').classList.remove('sending');
    document.getElementById('send').style.pointerEvents = 'auto';
}
}
async function streamAssistantToGlobalChat(promptText, userMessageId) {
if (!firebaseAppInitialized || !globalChatRef) {
console.error("Global chat reference not initialized for AI stream:", globalChatRef);
updateStatus('Error: Global chat unavailable for AI.');
isStreaming = false;
isSendingMessage = false; // Reset send state on error
document.getElementById('send').classList.remove('sending');
document.getElementById('send').style.pointerEvents = 'auto';
return;
}
updateStatus('Assistant is typing...');
isStreaming = true;

const MAX_CONTEXT_FOR_GLOBAL_AI = 7; // Number of previous messages to send as context for AI follow-up
let messagesForAI = [];

// Build context by iterating backward from the *current* user's message in Firebase
// Fetch the recent messages from Firebase to ensure correct context, rather than relying on DOM
let messagesSnapshot = await firebase.database().ref('global_chat').orderByChild('ts').limitToLast(MAX_CONTEXT_FOR_GLOBAL_AI).once('value');
messagesSnapshot.forEach(childSnapshot => {
    const msg = childSnapshot.val();
    // Only include user and assistant messages for AI context, and ensure content exists
    if ((msg.role === 'user' || msg.role === 'assistant') && msg.content) {
        let content = msg.content;
        if (msg.replyTo) {
            content = `(Replying to: "${msg.replyTo.sender || ''}: ${msg.replyTo.content}") ${content}`;
        }
        messagesForAI.push({ role: msg.role, content: content });
    }
});


const initialAssistantMsgData = {
    sender: 'GPT-4 Turbo',
    content: '', // Start with empty content for the typing indicator
    ts: firebase.database.ServerValue.TIMESTAMP,
    role: 'assistant',
    type: 'global',
    replyTo: {
        id: userMessageId,
        content: promptText.slice(0, 100), // Use original prompt for context, trimmed
        sender: username
    }
};

// Push the initial empty assistant message to Firebase. This creates the Firebase entry.
const assistantMessageRef = globalChatRef.push(initialAssistantMsgData);
const assistantMessageId = assistantMessageRef.key; // Get the ID from Firebase

// The Firebase listener (child_added/changed) will now pick this up and render/update it.
// We then wait for this element to appear in the DOM before starting local typing animation.

let assistantFullText = '';
let displayedAssistantText = ''; // This will still control the local typing animation
let lastFirebaseUpdate = Date.now();
const UPDATE_FIREBASE_INTERVAL = 1000;

// Find the *already rendered* typing bubble (created by child_added)
let typingMsgEl = null; // Will be set after waiting
let mdContentEl = null;
let copyBtn = null;

// Wait for the message to appear in the DOM from the child_added listener
const waitForElement = () => new Promise(resolve => {
    const checkElement = () => {
        typingMsgEl = document.getElementById(`msg-${assistantMessageId}`);
        if (typingMsgEl) {
            mdContentEl = typingMsgEl.querySelector('.md-content');
            copyBtn = typingMsgEl.querySelector('.copy-btn');
            const isTypingSpan = mdContentEl.querySelector('.is-typing');
            if (isTypingSpan) {
                isTypingSpan.remove(); // Remove the dots as we start typing chars
            }
            if (copyBtn) copyBtn.classList.add('hidden'); // Hide copy button during typing
            resolve();
        } else {
            requestAnimationFrame(checkElement); // Keep checking
        }
    };
    checkElement();
});

await waitForElement(); // Wait until the AI message element is in the DOM

typingAnimationInterval = setInterval(() => {
    if (displayedAssistantText.length < assistantFullText.length) {
        const charsToAdd = Math.min(3, assistantFullText.length - displayedAssistantText.length);
        displayedAssistantText += assistantFullText.substring(displayedAssistantText.length, displayedAssistantText.length + charsToAdd);
        if (mdContentEl) { // Ensure element exists before updating
            mdContentEl.innerHTML = DOMPurify.sanitize(renderMarkdown(processTextForMentionsAndCommands(displayedAssistantText))) + '<span class="typing-cursor"></span>'; // Sanitize incremental update
            scrollToBottom();
            if (Date.now() - lastFirebaseUpdate > UPDATE_FIREBASE_INTERVAL) {
                // Update Firebase periodically with partial content
                assistantMessageRef.update({ content: assistantFullText });
                lastFirebaseUpdate = Date.now();
            }
        }
    } else if (!isStreaming) {
        // Animation finished and streaming is done, finalize display
        clearInterval(typingAnimationInterval);
        typingAnimationInterval = null;
        if (mdContentEl) { // Ensure element exists before updating
            mdContentEl.innerHTML = DOMPurify.sanitize(renderMarkdown(processTextForMentionsAndCommands(assistantFullText))); // Sanitize final content
            ensureEnhancements(mdContentEl);
        }
        if (copyBtn) copyBtn.classList.remove('hidden');
        if (typingMsgEl) attachMessageButtonListeners(typingMsgEl); // Re-attach all buttons for final state
        updateStatus('');
    }
}, isUserAdmin() ? TYPING_SPEED_ADMIN_MS : TYPING_SPEED_NORMAL_MS); // Apply VIP typing speed

let sseBuffer = '';
try {
    const res = await fetch(API_URL, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${API_KEY}`
        },
        body: JSON.stringify({
            model: MODEL,
            stream: true,
            messages: messagesForAI // Use the constructed history for AI context
        })
    });

    if (!res.ok || !res.body) {
        const errorText = await res.text();
        throw new Error(`HTTP ${res.status} ${res.statusText}. Details: ${errorText.substring(0, 200)}...`);
    }

    const reader = res.body.getReader();
    let doneReading = false;
    const textDecoder = new TextDecoder('utf-8'); // Create one decoder instance

    while (!doneReading) {
        const { value, done: readerDone } = await reader.read();
        if (readerDone) { doneReading = true; break; }
        
        const chunk = textDecoder.decode(value, {stream:true});
        sseBuffer += chunk;
        const events = sseBuffer.split(/\n\n/);
        sseBuffer = events.pop();

        for (const event of events) {
            const lines = event.split(/\n/);
            let dataLine = '';
            for (const line of lines) {
                if (line.startsWith('data:')) {
                    dataLine = line.slice(5).trim();
                    break;
                }
            }

            if (dataLine === '[DONE]') {
                doneReading = true;
                break;
            }
            
            if (dataLine) {
                try {
                    const json = JSON.parse(dataLine);
                    const delta = json.choices?.[0]?.delta?.content ?? '';
                    if (delta) {
                        assistantFullText += delta;
                    }
                } catch (e) {
                    console.warn("Error parsing SSE data chunk. Skipping:", e, "Data:", dataLine);
                }
            }
        }
    }
    if (sseBuffer) { // Flush any remaining buffer
        assistantFullText += textDecoder.decode(new Uint8Array(0), {stream:false});
    }

} catch (err) {
    console.error("Streaming error to global chat:", err);
    if (typingAnimationInterval) {
        clearInterval(typingAnimationInterval);
        typingAnimationInterval = null;
    }
    isStreaming = false;
    const errorMessage = `<div>Error: ${escapeHTML(err.message || 'Unknown API error.')}</div>`;
    if (mdContentEl) { // Ensure element exists before updating
        mdContentEl.innerHTML = DOMPurify.sanitize(errorMessage) + `<button class="retry-btn" style="margin-top: .5rem; font-size:.85em;"><i class="fa-solid fa-rotate-right"></i> Retry</button>`; // Sanitize error message
    }
    if (copyBtn) copyBtn.classList.add('hidden');
    if (mdContentEl) { // Attach listener only if mdContentEl exists
        mdContentEl.querySelector('.retry-btn')?.addEventListener('click', () => {
            // Remove the error message from Firebase if retrying to avoid duplicates
            if (assistantMessageId) assistantMessageRef.remove();
            streamAssistantToGlobalChat(promptText, userMessageId);
        });
    }
    updateStatus('Error');
    // Final Firebase update with error message if stream failed completely
    if (assistantMessageId) {
        assistantMessageRef.update({ content: assistantFullText || '(no content)' });
    }

} finally {
    isStreaming = false;
    // Force final rendering state if animation finished early or was cleared
    if (typingAnimationInterval) {
        clearInterval(typingAnimationInterval);
        typingAnimationInterval = null;
    }
    if (mdContentEl) {
        mdContentEl.innerHTML = DOMPurify.sanitize(renderMarkdown(processTextForMentionsAndCommands(assistantFullText || '(no content)'))); // Sanitize final content
        ensureEnhancements(mdContentEl);
    }
    if (copyBtn) copyBtn.classList.remove('hidden');
    if (typingMsgEl) attachMessageButtonListeners(typingMsgEl); // Final re-attachment
    updateLazyMarkerVisibility();
    // Final update to Firebase after stream ends
    if (assistantMessageId) {
        assistantMessageRef.update({ content: assistantFullText || '(no content)' });
    }
    isSendingMessage = false; // Reset send state after AI is done
    document.getElementById('send').classList.remove('sending');
    document.getElementById('send').style.pointerEvents = 'auto';
}
}
async function streamRetryFromClone(body){
const chat = currentChat();
const wrap = document.getElementById('messages');
if (!wrap) return;
const last = wrap.lastElementChild;
if (last && last.classList.contains('assistant')) {
const contentDiv = last.querySelector('.md-content');
if (contentDiv && contentDiv.textContent.includes('Error')) {
wrap.removeChild(last);
}
}
await streamAssistant('[retry]');
}
function showErrorBanner(text, onRetry){
const messages = document.getElementById('messages');
if (!messages) return;
messages.querySelectorAll('.banner').forEach(b => b.remove());
const banner = document.createElement('div');
banner.className = 'banner';
banner.innerHTML = DOMPurify.sanitize(`${text}`) + `<button class="retry-btn"><i class="fa-solid fa-rotate-right"></i> Retry</button>`; // Sanitize banner text
const lazyMarker = document.getElementById('lazyMarker');
if (lazyMarker) {
lazyMarker.after(banner);
} else {
messages.prepend(banner);
}
banner.querySelector('.retry-btn')?.addEventListener('click', ()=>{
banner.remove();
if (typeof onRetry === 'function') onRetry();
});
}
function scrollToBottom(force=false){
const el = document.getElementById('messages');
if (el) {
requestAnimationFrame(() => {
if (force || atBottom){
el.scrollTo({top: el.scrollHeight, behavior:'smooth'});
atBottom = true;
}
});
}
}
function timeAgo(ts){
const s = Math.floor((Date.now()-ts)/1000);
if (s<60) return 'just now';
const m = Math.floor(s/60); if (m<60) return m+'m ago';
const h = Math.floor(m/60); if (h<24) return h+'h ago';
const d = Math.floor(h/24); return d+'d ago';
}
function formatTime(ts){
const d = new Date(ts);
return d.toLocaleString([], {
hour:'2-digit', minute:'2-digit',
day:'2-digit', month:'short',
hour12: true
});
}
function toast(anchor, text){
const tip = document.createElement('div');
tip.textContent = text;
tip.style.position='absolute';
const anchorRect = anchor.getBoundingClientRect();
const parentRect = anchor.offsetParent.getBoundingClientRect();
tip.style.top = `${anchorRect.top - parentRect.top - 26}px`;
tip.style.left = `${anchorRect.left - parentRect.left + anchorRect.width / 2}px`;
tip.style.transform = 'translateX(-50%)';
tip.style.background='var(--panel-2)';
tip.style.border='1px solid var(--border)';
tip.style.padding='.15rem .4rem';
tip.style.borderRadius='8px';
tip.style.fontSize='.78rem';
tip.style.pointerEvents='none';
tip.style.opacity='0';
tip.style.transition='opacity 0.3s ease-out';
tip.style.zIndex='100';
anchor.offsetParent.appendChild(tip);
requestAnimationFrame(() => {
tip.style.opacity = '1';
setTimeout(()=> {
tip.style.opacity = '0';
setTimeout(()=> tip.remove(), 900);
}, 900);
});
}
function updateStatus(s=''){
const statusEl = document.getElementById('status');
if (statusEl) statusEl.textContent = s;
}
function loadOlderMessages(){
if (currentChatId === GLOBAL_CHAT_ID) return;
const chat = currentChat();
const wrap = document.getElementById('messages');
if (!wrap) return;
const alreadyRenderedMsgs = wrap.querySelectorAll('.msg').length;
const totalMessages = chat.messages.length;
const missingMessages = totalMessages - alreadyRenderedMsgs;
const marker = document.getElementById('lazyMarker');
if (missingMessages <= 0) {
updateLazyMarkerVisibility();
return;
}
const toLoad = Math.min(PAGE_SIZE, missingMessages);
const startIndex = totalMessages - alreadyRenderedMsgs - toLoad;
const prevScrollHeight = wrap.scrollHeight;
const fragment = document.createDocumentFragment();
for (let i=startIndex; i<startIndex+toLoad; i++){
const node = renderMessage(chat.messages[i]);
fragment.appendChild(node);
}
if (marker) marker.after(fragment);
ensureEnhancements(wrap);
setTimeout(() => {
const newScrollHeight = wrap.scrollHeight;
wrap.scrollTop += (newScrollHeight - prevScrollHeight);
}, 0);
updateLazyMarkerVisibility();
}
function updateLazyMarkerVisibility(){
const chat = currentChat();
const wrap = document.getElementById('messages');
const marker = document.getElementById('lazyMarker');
if (!wrap || !marker) return;
if (chat.isGlobal) {
marker.classList.remove('hidden');
marker.textContent = 'Loading global chat...';
} else {
const alreadyRenderedMsgs = wrap.querySelectorAll('.msg').length;
const totalMessages = chat.messages.length;
if (totalMessages > alreadyRenderedMsgs) {
marker.classList.remove('hidden');
marker.textContent = 'Scroll up to load older messages‚Ä¶';
} else {
marker.classList.add('hidden');
}
}
}
</script>
</body>
</html>
